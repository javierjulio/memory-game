var Oi=Object.defineProperty;var Bi=(t,e,n)=>e in t?Oi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var sr=(t,e,n)=>(Bi(t,typeof e!="symbol"?e+"":e,n),n);const Fi=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};Fi();function Q(){}const Nr=t=>t;function $i(t,e){for(const n in e)t[n]=e[n];return t}function jr(t){return t()}function lr(){return Object.create(null)}function Le(t){t.forEach(jr)}function Ur(t){return typeof t=="function"}function Te(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function zi(t){return Object.keys(t).length===0}function Li(t,...e){if(t==null)return Q;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Ni(t,e,n){t.$$.on_destroy.push(Li(e,n))}function Lt(t,e,n,r){if(t){const i=Vr(t,e,n,r);return t[0](i)}}function Vr(t,e,n,r){return t[1]&&r?$i(n.ctx.slice(),t[1](r(e))):n.ctx}function Nt(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],a=Math.max(e.dirty.length,i.length);for(let u=0;u<a;u+=1)o[u]=e.dirty[u]|i[u];return o}return e.dirty|i}return e.dirty}function jt(t,e,n,r,i,o){if(i){const a=Vr(e,n,r,o);t.p(a,i)}}function Ut(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}const Wr=typeof window!="undefined";let ji=Wr?()=>window.performance.now():()=>Date.now(),jn=Wr?t=>requestAnimationFrame(t):Q;const We=new Set;function Hr(t){We.forEach(e=>{e.c(t)||(We.delete(e),e.f())}),We.size!==0&&jn(Hr)}function Ui(t){let e;return We.size===0&&jn(Hr),{promise:new Promise(n=>{We.add(e={c:t,f:n})}),abort(){We.delete(e)}}}function R(t,e){t.appendChild(e)}function Yr(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Vi(t){const e=$("style");return Wi(Yr(t),e),e.sheet}function Wi(t,e){R(t.head||t,e)}function V(t,e,n){t.insertBefore(e,n||null)}function j(t){t.parentNode.removeChild(t)}function $(t){return document.createElement(t)}function xe(t){return document.createTextNode(t)}function ee(){return xe(" ")}function Un(){return xe("")}function lt(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function F(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Hi(t){return Array.from(t.childNodes)}function He(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function cr(t,e,n){t.classList[n?"add":"remove"](e)}function Gr(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}const Vt=new Map;let Wt=0;function Yi(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Gi(t,e){const n={stylesheet:Vi(e),rules:{}};return Vt.set(t,n),n}function fr(t,e,n,r,i,o,a,u=0){const s=16.666/r;let l=`{
`;for(let y=0;y<=1;y+=s){const b=e+(n-e)*o(y);l+=y*100+`%{${a(b,1-b)}}
`}const h=l+`100% {${a(n,1-n)}}
}`,f=`__svelte_${Yi(h)}_${u}`,c=Yr(t),{stylesheet:v,rules:d}=Vt.get(c)||Gi(c,t);d[f]||(d[f]=!0,v.insertRule(`@keyframes ${f} ${h}`,v.cssRules.length));const p=t.style.animation||"";return t.style.animation=`${p?`${p}, `:""}${f} ${r}ms linear ${i}ms 1 both`,Wt+=1,f}function Qi(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),Wt-=i,Wt||Xi())}function Xi(){jn(()=>{Wt||(Vt.forEach(t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}}),Vt.clear())})}let ct;function ot(t){ct=t}function Qr(){if(!ct)throw new Error("Function called outside component initialization");return ct}function qi(t){Qr().$$.on_destroy.push(t)}function Vn(){const t=Qr();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=Gr(e,n,{cancelable:r});return i.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function Xr(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const nt=[],yn=[],Pt=[],hr=[],Ji=Promise.resolve();let mn=!1;function Zi(){mn||(mn=!0,Ji.then(qr))}function Ge(t){Pt.push(t)}const an=new Set;let Ct=0;function qr(){const t=ct;do{for(;Ct<nt.length;){const e=nt[Ct];Ct++,ot(e),eo(e.$$)}for(ot(null),nt.length=0,Ct=0;yn.length;)yn.pop()();for(let e=0;e<Pt.length;e+=1){const n=Pt[e];an.has(n)||(an.add(n),n())}Pt.length=0}while(nt.length);for(;hr.length;)hr.pop()();mn=!1,an.clear(),ot(t)}function eo(t){if(t.fragment!==null){t.update(),Le(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ge)}}let tt;function to(){return tt||(tt=Promise.resolve(),tt.then(()=>{tt=null})),tt}function un(t,e,n){t.dispatchEvent(Gr(`${e?"intro":"outro"}${n}`))}const Rt=new Set;let pe;function Jr(){pe={r:0,c:[],p:pe}}function Zr(){pe.r||Le(pe.c),pe=pe.p}function W(t,e){t&&t.i&&(Rt.delete(t),t.i(e))}function q(t,e,n,r){if(t&&t.o){if(Rt.has(t))return;Rt.add(t),pe.c.push(()=>{Rt.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}const no={duration:0};function At(t,e,n,r){let i=e(t,n),o=r?0:1,a=null,u=null,s=null;function l(){s&&Qi(t,s)}function h(c,v){const d=c.b-o;return v*=Math.abs(d),{a:o,b:c.b,d,duration:v,start:c.start,end:c.start+v,group:c.group}}function f(c){const{delay:v=0,duration:d=300,easing:p=Nr,tick:y=Q,css:b}=i||no,E={start:ji()+v,b:c};c||(E.group=pe,pe.r+=1),a||u?u=E:(b&&(l(),s=fr(t,o,c,d,v,p,b)),c&&y(0,1),a=h(E,d),Ge(()=>un(t,c,"start")),Ui(_=>{if(u&&_>u.start&&(a=h(u,d),u=null,un(t,a.b,"start"),b&&(l(),s=fr(t,o,a.b,a.duration,0,p,i.css))),a){if(_>=a.end)y(o=a.b,1-o),un(t,a.b,"end"),u||(a.b?l():--a.group.r||Le(a.group.c)),a=null;else if(_>=a.start){const w=_-a.start;o=a.a+a.d*p(w/a.duration),y(o,1-o)}}return!!(a||u)}))}return{run(c){Ur(i)?to().then(()=>{i=i(),f(c)}):f(c)},end(){l(),a=u=null}}}function ro(t,e){t.d(1),e.delete(t.key)}function io(t,e){q(t,1,1,()=>{e.delete(t.key)})}function ei(t,e,n,r,i,o,a,u,s,l,h,f){let c=t.length,v=o.length,d=c;const p={};for(;d--;)p[t[d].key]=d;const y=[],b=new Map,E=new Map;for(d=v;d--;){const g=f(i,o,d),C=n(g);let k=a.get(C);k?r&&k.p(g,e):(k=l(C,g),k.c()),b.set(C,y[d]=k),C in p&&E.set(C,Math.abs(d-p[C]))}const _=new Set,w=new Set;function m(g){W(g,1),g.m(u,h),a.set(g.key,g),h=g.first,v--}for(;c&&v;){const g=y[v-1],C=t[c-1],k=g.key,A=C.key;g===C?(h=g.first,c--,v--):b.has(A)?!a.has(k)||_.has(k)?m(g):w.has(A)?c--:E.get(k)>E.get(A)?(w.add(k),m(g)):(_.add(A),c--):(s(C,a),c--)}for(;c--;){const g=t[c];b.has(g.key)||s(g,a)}for(;v;)m(y[v-1]);return y}function Fe(t){t&&t.c()}function Ce(t,e,n,r){const{fragment:i,on_mount:o,on_destroy:a,after_update:u}=t.$$;i&&i.m(e,n),r||Ge(()=>{const s=o.map(jr).filter(Ur);a?a.push(...s):Le(s),t.$$.on_mount=[]}),u.forEach(Ge)}function Ae(t,e){const n=t.$$;n.fragment!==null&&(Le(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function oo(t,e){t.$$.dirty[0]===-1&&(nt.push(t),Zi(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ie(t,e,n,r,i,o,a,u=[-1]){const s=ct;ot(t);const l=t.$$={fragment:null,ctx:null,props:o,update:Q,not_equal:i,bound:lr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:lr(),dirty:u,skip_bound:!1,root:e.target||s.$$.root};a&&a(l.root);let h=!1;if(l.ctx=n?n(t,e.props||{},(f,c,...v)=>{const d=v.length?v[0]:c;return l.ctx&&i(l.ctx[f],l.ctx[f]=d)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](d),h&&oo(t,f)),c}):[],l.update(),h=!0,Le(l.before_update),l.fragment=r?r(l.ctx):!1,e.target){if(e.hydrate){const f=Hi(e.target);l.fragment&&l.fragment.l(f),f.forEach(j)}else l.fragment&&l.fragment.c();e.intro&&W(t.$$.fragment),Ce(t,e.target,e.anchor,e.customElement),qr()}ot(s)}class Pe{$destroy(){Ae(this,1),this.$destroy=Q}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!zi(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ao(t){let e,n,r,i,o,a,u;const s=t[5].default,l=Lt(s,t,t[4],null);return{c(){e=$("div"),n=$("div"),r=ee(),i=$("div"),l&&l.c(),F(n,"class","card-front svelte-8x7le"),F(i,"class","card-back svelte-8x7le"),F(e,"class","card svelte-8x7le"),cr(e,"toggled",t[0])},m(h,f){V(h,e,f),R(e,n),R(e,r),R(e,i),l&&l.m(i,null),o=!0,a||(u=lt(e,"click",t[1]),a=!0)},p(h,[f]){l&&l.p&&(!o||f&16)&&jt(l,s,h,h[4],o?Nt(s,h[4],f,null):Ut(h[4]),null),f&1&&cr(e,"toggled",h[0])},i(h){o||(W(l,h),o=!0)},o(h){q(l,h),o=!1},d(h){h&&j(e),l&&l.d(h),a=!1,u()}}}function uo(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Vn();let{item:a={index:0,type:0,backfaceIsUp:!1}}=e,{flippable:u=!0}=e,{flipped:s=!1}=e;function l(){u&&!s&&o("flip",a)}return t.$$set=h=>{"item"in h&&n(2,a=h.item),"flippable"in h&&n(3,u=h.flippable),"flipped"in h&&n(0,s=h.flipped),"$$scope"in h&&n(4,i=h.$$scope)},[s,l,a,u,i,r]}class so extends Pe{constructor(e){super(),Ie(this,e,uo,ao,Te,{item:2,flippable:3,flipped:0})}}const lo=t=>({moveCount:t&2}),dr=t=>({moveCount:t[1]});function pr(t,e,n){const r=t.slice();return r[11]=e[n],r[13]=n,r}function co(t){let e=t[11].type.toString()+"",n,r;return{c(){n=xe(e),r=ee()},m(i,o){V(i,n,o),V(i,r,o)},p(i,o){o&1&&e!==(e=i[11].type.toString()+"")&&He(n,e)},d(i){i&&j(n),i&&j(r)}}}function vr(t,e){let n,r,i;return r=new so({props:{item:e[11],flipped:e[11].backfaceIsUp,flippable:e[2].length<2,$$slots:{default:[co]},$$scope:{ctx:e}}}),r.$on("flip",e[3]),{key:t,first:null,c(){n=Un(),Fe(r.$$.fragment),this.first=n},m(o,a){V(o,n,a),Ce(r,o,a),i=!0},p(o,a){e=o;const u={};a&1&&(u.item=e[11]),a&1&&(u.flipped=e[11].backfaceIsUp),a&4&&(u.flippable=e[2].length<2),a&65&&(u.$$scope={dirty:a,ctx:e}),r.$set(u)},i(o){i||(W(r.$$.fragment,o),i=!0)},o(o){q(r.$$.fragment,o),i=!1},d(o){o&&j(n),Ae(r,o)}}}function fo(t){let e,n,r=[],i=new Map,o,a,u,s=t[0];const l=c=>c[13];for(let c=0;c<s.length;c+=1){let v=pr(t,s,c),d=l(v);i.set(d,r[c]=vr(d,v))}const h=t[5].default,f=Lt(h,t,t[6],dr);return{c(){e=$("div"),n=$("div");for(let c=0;c<r.length;c+=1)r[c].c();o=ee(),a=$("div"),f&&f.c(),F(n,"class","full-grid disable-text-selection svelte-1zhk37"),F(a,"class","footer-bar svelte-1zhk37")},m(c,v){V(c,e,v),R(e,n);for(let d=0;d<r.length;d+=1)r[d].m(n,null);R(e,o),R(e,a),f&&f.m(a,null),u=!0},p(c,[v]){v&13&&(s=c[0],Jr(),r=ei(r,v,l,1,c,s,i,n,io,vr,null,pr),Zr()),f&&f.p&&(!u||v&66)&&jt(f,h,c,c[6],u?Nt(h,c[6],v,lo):Ut(c[6]),dr)},i(c){if(!u){for(let v=0;v<s.length;v+=1)W(r[v]);W(f,c),u=!0}},o(c){for(let v=0;v<r.length;v+=1)q(r[v]);q(f,c),u=!1},d(c){c&&j(e);for(let v=0;v<r.length;v+=1)r[v].d();f&&f.d(c)}}}function sn(t,...e){return new Promise(n=>setTimeout(n,t,...e))}function ho(t,e,n){let{$$slots:r={},$$scope:i}=e,{puzzle:o=[]}=e,{onCompleted:a}=e,{moveCount:u=0}=e,s=[];function l(d){d.backfaceIsUp=!1,n(0,o)}function h(){o.length===o.filter(p=>p.backfaceIsUp).length&&sn(300,u).then(()=>{a(u),n(1,u=0)})}function f(){const d=[sn(600,s[1]).then(l),sn(800,s[0]).then(l)];Promise.all(d).then(()=>n(2,s=[]))}function c(){return s[0].type===s[1].type}function v(d){const p=d.detail;n(0,o[p.index].backfaceIsUp=!o[p.index].backfaceIsUp,o),n(2,s=[...s,p]),s.length>=2&&(n(1,u++,u),c()?(n(2,s=[]),h()):f())}return t.$$set=d=>{"puzzle"in d&&n(0,o=d.puzzle),"onCompleted"in d&&n(4,a=d.onCompleted),"moveCount"in d&&n(1,u=d.moveCount),"$$scope"in d&&n(6,i=d.$$scope)},[o,u,s,v,a,r,i]}class po extends Pe{constructor(e){super(),Ie(this,e,ho,fo,Te,{puzzle:0,onCompleted:4,moveCount:1})}}function vo(t){let e,n,r;return{c(){e=$("button"),e.innerHTML=`<span class="icon svelte-glkhk4"><svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline></svg></span>
  Records`,F(e,"class","button")},m(i,o){V(i,e,o),n||(r=lt(e,"click",t[0]),n=!0)},p:Q,i:Q,o:Q,d(i){i&&j(e),n=!1,r()}}}function yo(t){function e(n){Xr.call(this,t,n)}return[e]}class mo extends Pe{constructor(e){super(),Ie(this,e,yo,vo,Te,{})}}function go(t){const e=t-1;return e*e*e+1}function yr(t){return--t*t*t*t*t+1}function mr(t){return-.5*(Math.cos(Math.PI*t)-1)}function gr(t,{delay:e=0,duration:n=400,easing:r=Nr}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:o=>`opacity: ${o*i}`}}function _r(t,{delay:e=0,duration:n=400,easing:r=go}={}){const i=getComputedStyle(t),o=+i.opacity,a=parseFloat(i.height),u=parseFloat(i.paddingTop),s=parseFloat(i.paddingBottom),l=parseFloat(i.marginTop),h=parseFloat(i.marginBottom),f=parseFloat(i.borderTopWidth),c=parseFloat(i.borderBottomWidth);return{delay:e,duration:n,easing:r,css:v=>`overflow: hidden;opacity: ${Math.min(v*20,1)*o};height: ${v*a}px;padding-top: ${v*u}px;padding-bottom: ${v*s}px;margin-top: ${v*l}px;margin-bottom: ${v*h}px;border-top-width: ${v*f}px;border-bottom-width: ${v*c}px;`}}const _o=t=>({}),br=t=>({}),bo=t=>({}),wr=t=>({});function wo(t){let e,n,r,i,o,a,u,s,l,h;const f=t[4].header,c=Lt(f,t,t[3],wr),v=t[4].content,d=Lt(v,t,t[3],br);return{c(){e=$("div"),n=$("div"),i=ee(),o=$("div"),c&&c.c(),a=ee(),d&&d.c(),F(n,"class","modal-backdrop svelte-1hm6iu8"),F(o,"class","modal svelte-1hm6iu8"),F(o,"role","dialog"),F(o,"aria-modal","true"),F(e,"class","modal-overlay svelte-1hm6iu8")},m(p,y){V(p,e,y),R(e,n),R(e,i),R(e,o),c&&c.m(o,null),R(o,a),d&&d.m(o,null),t[5](o),s=!0,l||(h=[lt(window,"keydown",t[2]),lt(n,"click",t[1])],l=!0)},p(p,[y]){t=p,c&&c.p&&(!s||y&8)&&jt(c,f,t,t[3],s?Nt(f,t[3],y,bo):Ut(t[3]),wr),d&&d.p&&(!s||y&8)&&jt(d,v,t,t[3],s?Nt(v,t[3],y,_o):Ut(t[3]),br)},i(p){s||(Ge(()=>{r||(r=At(n,gr,{duration:600,easing:mr},!0)),r.run(1)}),W(c,p),W(d,p),Ge(()=>{u||(u=At(o,_r,{duration:600,easing:yr},!0)),u.run(1)}),s=!0)},o(p){r||(r=At(n,gr,{duration:600,easing:mr},!1)),r.run(0),q(c,p),q(d,p),u||(u=At(o,_r,{duration:600,easing:yr},!1)),u.run(0),s=!1},d(p){p&&j(e),p&&r&&r.end(),c&&c.d(p),d&&d.d(p),t[5](null),p&&u&&u.end(),l=!1,Le(h)}}}function Eo(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Vn(),a=()=>o("close");let u;const s=f=>{if(f.key==="Escape"){a();return}if(f.key==="Tab"){const c=u.querySelectorAll("*"),v=Array.from(c).filter(p=>p.tabIndex>=0);let d=v.indexOf(document.activeElement);d===-1&&f.shiftKey&&(d=0),d+=v.length+(f.shiftKey?-1:1),d%=v.length,v[d].focus(),f.preventDefault()}},l=typeof document!="undefined"&&document.activeElement;l&&qi(()=>{l.focus()});function h(f){yn[f?"unshift":"push"](()=>{u=f,n(0,u)})}return t.$$set=f=>{"$$scope"in f&&n(3,i=f.$$scope)},[u,a,s,i,r,h]}class ko extends Pe{constructor(e){super(),Ie(this,e,Eo,wo,Te,{})}}const xo=(t,e)=>t.reduce(function(n,r){var i=typeof e=="function"?e(r):r[e];return n.hasOwnProperty(i)||(n[i]=[]),n[i].push(r),n},{});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var I=function(){return I=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},I.apply(this,arguments)};function gn(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var z=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,N=Object.keys,G=Array.isArray;typeof Promise!="undefined"&&!z.Promise&&(z.Promise=Promise);function J(t,e){return typeof e!="object"||N(e).forEach(function(n){t[n]=e[n]}),t}var ft=Object.getPrototypeOf,Co={}.hasOwnProperty;function te(t,e){return Co.call(t,e)}function Qe(t,e){typeof e=="function"&&(e=e(ft(t))),(typeof Reflect=="undefined"?N:Reflect.ownKeys)(e).forEach(function(n){me(t,n,e[n])})}var ti=Object.defineProperty;function me(t,e,n,r){ti(t,e,J(n&&te(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Xe(t){return{from:function(e){return t.prototype=Object.create(e.prototype),me(t.prototype,"constructor",t),{extend:Qe.bind(null,t.prototype)}}}}var Ao=Object.getOwnPropertyDescriptor;function Wn(t,e){var n=Ao(t,e),r;return n||(r=ft(t))&&Wn(r,e)}var So=[].slice;function tn(t,e,n){return So.call(t,e,n)}function ni(t,e){return e(t)}function rt(t){if(!t)throw new Error("Assertion Failed")}function ri(t){z.setImmediate?setImmediate(t):setTimeout(t,0)}function ii(t,e){return t.reduce(function(n,r,i){var o=e(r,i);return o&&(n[o[0]]=o[1]),n},{})}function Ko(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function ye(t,e){if(te(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,i=e.length;r<i;++r){var o=ye(t,e[r]);n.push(o)}return n}var a=e.indexOf(".");if(a!==-1){var u=t[e.substr(0,a)];return u===void 0?void 0:ye(u,e.substr(a+1))}}function ae(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){rt(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)ae(t,e[r],n[r])}else{var o=e.indexOf(".");if(o!==-1){var a=e.substr(0,o),u=e.substr(o+1);if(u==="")n===void 0?G(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var s=t[a];(!s||!te(t,a))&&(s=t[a]={}),ae(s,u,n)}}else n===void 0?G(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Do(t,e){typeof e=="string"?ae(t,e,void 0):"length"in e&&[].map.call(e,function(n){ae(t,n,void 0)})}function oi(t){var e={};for(var n in t)te(t,n)&&(e[n]=t[n]);return e}var To=[].concat;function ai(t){return To.apply([],t)}var ui="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ai([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return z[t]}),Io=ui.map(function(t){return z[t]});ii(ui,function(t){return[t,!0]});var Ee=null;function gt(t){Ee=typeof WeakMap!="undefined"&&new WeakMap;var e=_n(t);return Ee=null,e}function _n(t){if(!t||typeof t!="object")return t;var e=Ee&&Ee.get(t);if(e)return e;if(G(t)){e=[],Ee&&Ee.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(_n(t[n]))}else if(Io.indexOf(t.constructor)>=0)e=t;else{var i=ft(t);e=i===Object.prototype?{}:Object.create(i),Ee&&Ee.set(t,e);for(var o in t)te(t,o)&&(e[o]=_n(t[o]))}return e}var Po={}.toString;function bn(t){return Po.call(t).slice(8,-1)}var wn=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",Ro=typeof wn=="symbol"?function(t){var e;return t!=null&&(e=t[wn])&&e.apply(t)}:function(){return null},Ve={};function de(t){var e,n,r,i;if(arguments.length===1){if(G(t))return t.slice();if(this===Ve&&typeof t=="string")return[t];if(i=Ro(t)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var Hn=typeof Symbol!="undefined"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ce=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function si(t,e){ce=t,li=e}var li=function(){return!0},Mo=!new Error("").stack;function Ne(){if(Mo)try{throw Ne.arguments,new Error}catch(t){return t}return new Error}function En(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(li).map(function(r){return`
`+r}).join("")):""}var Oo=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],ci=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Yn=Oo.concat(ci),Bo={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function qe(t,e){this._e=Ne(),this.name=t,this.message=e}Xe(qe).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+En(this._e,2))}},toString:function(){return this.name+": "+this.message}});function fi(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function Ht(t,e,n,r){this._e=Ne(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=fi(t,e)}Xe(Ht).from(qe);function at(t,e){this._e=Ne(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=fi(t,e)}Xe(at).from(qe);var Gn=Yn.reduce(function(t,e){return t[e]=e+"Error",t},{}),Fo=qe,K=Yn.reduce(function(t,e){var n=e+"Error";function r(i,o){this._e=Ne(),this.name=n,i?typeof i=="string"?(this.message=""+i+(o?`
 `+o:""),this.inner=o||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Bo[e]||n,this.inner=null)}return Xe(r).from(Fo),t[e]=r,t},{});K.Syntax=SyntaxError;K.Type=TypeError;K.Range=RangeError;var Er=ci.reduce(function(t,e){return t[e+"Error"]=K[e],t},{});function $o(t,e){if(!t||t instanceof qe||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Er[t.name])return t;var n=new Er[t.name](e||t.message,t);return"stack"in t&&me(n,"stack",{get:function(){return this.inner.stack}}),n}var nn=Yn.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=K[e]),t},{});nn.ModifyError=Ht;nn.DexieError=qe;nn.BulkError=at;function B(){}function _t(t){return t}function zo(t,e){return t==null||t===_t?e:function(n){return e(t(n))}}function $e(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Lo(t,e){return t===B?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?$e(r,this.onsuccess):r),i&&(this.onerror=this.onerror?$e(i,this.onerror):i),o!==void 0?o:n}}function No(t,e){return t===B?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?$e(n,this.onsuccess):n),r&&(this.onerror=this.onerror?$e(r,this.onerror):r)}}function jo(t,e){return t===B?e:function(n){var r=t.apply(this,arguments);J(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?$e(i,this.onsuccess):i),o&&(this.onerror=this.onerror?$e(o,this.onerror):o),r===void 0?a===void 0?void 0:a:J(r,a)}}function Uo(t,e){return t===B?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function Qn(t,e){return t===B?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return e.apply(r,o)})}return e.apply(this,arguments)}}var ht={},Vo=100,Wo=20,hi=100,Xn=typeof Promise=="undefined"?[]:function(){var t=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[t,ft(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,ft(e),t]}(),kn=Xn[0],Yt=Xn[1],xn=Xn[2],di=Yt&&Yt.then,Mt=kn&&kn.constructor,qn=!!xn,Cn=!1,Ho=xn?function(){xn.then(St)}:z.setImmediate?setImmediate.bind(null,St):z.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){St(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(St,0)},dt=function(t,e){it.push([t,e]),Gt&&(Ho(),Gt=!1)},An=!0,Gt=!0,Oe=[],Ot=[],Sn=null,Kn=_t,Ye={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Cr,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{Cr(t[0],t[1])}catch{}})}},S=Ye,it=[],Be=0,Bt=[];function x(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=B,this._lib=!1;var e=this._PSD=S;if(ce&&(this._stackHolder=Ne(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==ht)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Tn(this,this._value);return}this._state=null,this._value=null,++e.ref,vi(this,t)}var Dn={get:function(){var t=S,e=Qt;function n(r,i){var o=this,a=!t.global&&(t!==S||e!==Qt),u=a&&!ge(),s=new x(function(l,h){Jn(o,new pi(qt(r,t,a,u),qt(i,t,a,u),l,h,t))});return ce&&gi(s,this),s}return n.prototype=ht,n},set:function(t){me(this,"then",t&&t.prototype===ht?Dn:{get:function(){return t},set:Dn.set})}};Qe(x.prototype,{then:Dn,_then:function(t,e){Jn(this,new pi(null,null,t,e,S))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,function(r){return r instanceof e?n(r):Ft(r)}):this.then(null,function(r){return r&&r.name===e?n(r):Ft(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),Ft(e)})},stack:{get:function(){if(this._stack)return this._stack;try{Cn=!0;var t=mi(this,[],Wo),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Cn=!1}}},timeout:function(t,e){var n=this;return t<1/0?new x(function(r,i){var o=setTimeout(function(){return i(new K.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&me(x.prototype,Symbol.toStringTag,"Dexie.Promise");Ye.env=_i();function pi(t,e,n,r,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=i}Qe(x,{all:function(){var t=de.apply(null,arguments).map(Xt);return new x(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(i,o){return x.resolve(i).then(function(a){t[o]=a,--r||e(t)},n)})})},resolve:function(t){if(t instanceof x)return t;if(t&&typeof t.then=="function")return new x(function(n,r){t.then(n,r)});var e=new x(ht,!0,t);return gi(e,Sn),e},reject:Ft,race:function(){var t=de.apply(null,arguments).map(Xt);return new x(function(e,n){t.map(function(r){return x.resolve(r).then(e,n)})})},PSD:{get:function(){return S},set:function(t){return S=t}},totalEchoes:{get:function(){return Qt}},newPSD:Se,usePSD:Ze,scheduler:{get:function(){return dt},set:function(t){dt=t}},rejectionMapper:{get:function(){return Kn},set:function(t){Kn=t}},follow:function(t,e){return new x(function(n,r){return Se(function(i,o){var a=S;a.unhandleds=[],a.onunhandled=o,a.finalize=$e(function(){var u=this;Go(function(){u.unhandleds.length===0?i():o(u.unhandleds[0])})},a.finalize),t()},e,n,r)})}});Mt&&(Mt.allSettled&&me(x,"allSettled",function(){var t=de.apply(null,arguments).map(Xt);return new x(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(i,o){return x.resolve(i).then(function(a){return r[o]={status:"fulfilled",value:a}},function(a){return r[o]={status:"rejected",reason:a}}).then(function(){return--n||e(r)})})})}),Mt.any&&typeof AggregateError!="undefined"&&me(x,"any",function(){var t=de.apply(null,arguments).map(Xt);return new x(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,i=new Array(r);t.forEach(function(o,a){return x.resolve(o).then(function(u){return e(u)},function(u){i[a]=u,--r||n(new AggregateError(i))})})})}));function vi(t,e){try{e(function(n){if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&bt();n&&typeof n.then=="function"?vi(t,function(i,o){n instanceof x?n._then(i,o):n.then(i,o)}):(t._state=!0,t._value=n,yi(t)),r&&wt()}},Tn.bind(null,t))}catch(n){Tn(t,n)}}function Tn(t,e){if(Ot.push(e),t._state===null){var n=t._lib&&bt();e=Kn(e),t._state=!1,t._value=e,ce&&e!==null&&typeof e=="object"&&!e._promise&&Ko(function(){var r=Wn(e,"stack");e._promise=t,me(e,"stack",{get:function(){return Cn?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),Qo(t),yi(t),n&&wt()}}function yi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Jn(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),Be===0&&(++Be,dt(function(){--Be===0&&Zn()},[]))}function Jn(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Be,dt(Yo,[n,t,e])}function Yo(t,e,n){try{Sn=e;var r,i=e._value;e._state?r=t(i):(Ot.length&&(Ot=[]),r=t(i),Ot.indexOf(i)===-1&&Xo(e)),n.resolve(r)}catch(o){n.reject(o)}finally{Sn=null,--Be===0&&Zn(),--n.psd.ref||n.psd.finalize()}}function mi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var i=t._value,o,a;i!=null?(o=i.name||"Error",a=i.message||i,r=En(i,0)):(o=i,a=""),e.push(o+(a?": "+a:"")+r)}return ce&&(r=En(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&mi(t._prev,e,n)),e}function gi(t,e){var n=e?e._numPrev+1:0;n<Vo&&(t._prev=e,t._numPrev=n)}function St(){bt()&&wt()}function bt(){var t=An;return An=!1,Gt=!1,t}function wt(){var t,e,n;do for(;it.length>0;)for(t=it,it=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(it.length>0);An=!0,Gt=!0}function Zn(){var t=Oe;Oe=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=Bt.slice(0),n=e.length;n;)e[--n]()}function Go(t){function e(){t(),Bt.splice(Bt.indexOf(e),1)}Bt.push(e),++Be,dt(function(){--Be===0&&Zn()},[])}function Qo(t){Oe.some(function(e){return e._value===t._value})||Oe.push(t)}function Xo(t){for(var e=Oe.length;e;)if(Oe[--e]._value===t._value){Oe.splice(e,1);return}}function Ft(t){return new x(ht,!1,t)}function L(t,e){var n=S;return function(){var r=bt(),i=S;try{return Ke(n,!0),t.apply(this,arguments)}catch(o){e&&e(o)}finally{Ke(i,!1),r&&wt()}}}var Y={awaits:0,echoes:0,id:0},qo=0,$t=[],ln=0,Qt=0,Jo=0;function Se(t,e,n,r){var i=S,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Jo;var a=Ye.env;o.env=qn?{Promise:x,PromiseProp:{value:x,configurable:!0,writable:!0},all:x.all,race:x.race,allSettled:x.allSettled,any:x.any,resolve:x.resolve,reject:x.reject,nthen:kr(a.nthen,o),gthen:kr(a.gthen,o)}:{},e&&J(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Ze(o,t,n,r);return o.ref===0&&o.finalize(),u}function Je(){return Y.id||(Y.id=++qo),++Y.awaits,Y.echoes+=hi,Y.id}function ge(){return Y.awaits?(--Y.awaits===0&&(Y.id=0),Y.echoes=Y.awaits*hi,!0):!1}(""+di).indexOf("[native code]")===-1&&(Je=ge=B);function Xt(t){return Y.echoes&&t&&t.constructor===Mt?(Je(),t.then(function(e){return ge(),e},function(e){return ge(),U(e)})):t}function Zo(t){++Qt,(!Y.echoes||--Y.echoes===0)&&(Y.echoes=Y.id=0),$t.push(S),Ke(t,!0)}function ea(){var t=$t[$t.length-1];$t.pop(),Ke(t,!1)}function Ke(t,e){var n=S;if((e?Y.echoes&&(!ln++||t!==S):ln&&(!--ln||t!==S))&&bi(e?Zo.bind(null,t):ea),t!==S&&(S=t,n===Ye&&(Ye.env=_i()),qn)){var r=Ye.env.Promise,i=t.env;Yt.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(z,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function _i(){var t=z.Promise;return qn?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(z,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Yt.then,gthen:t.prototype.then}:{}}function Ze(t,e,n,r,i){var o=S;try{return Ke(t,!0),e(n,r,i)}finally{Ke(o,!1)}}function bi(t){di.call(kn,t)}function qt(t,e,n,r){return typeof t!="function"?t:function(){var i=S;n&&Je(),Ke(e,!0);try{return t.apply(this,arguments)}finally{Ke(i,!1),r&&bi(ge)}}}function kr(t,e){return function(n,r){return t.call(this,qt(n,e),qt(r,e))}}var xr="unhandledrejection";function Cr(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,i={promise:e,reason:t};if(z.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(xr,!0,!0),J(r,i)):z.CustomEvent&&(r=new CustomEvent(xr,{detail:i}),J(r,i)),r&&z.dispatchEvent&&(dispatchEvent(r),!z.PromiseRejectionEvent&&z.onunhandledrejection))try{z.onunhandledrejection(r)}catch{}ce&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var U=x.reject;function In(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!S.letThrough&&!t._vip){if(t._state.openComplete)return U(new K.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return U(new K.DatabaseClosed);t.open().catch(B)}return t._state.dbReadyPromise.then(function(){return In(t,e,n,r)})}else{var i=t._createTransaction(e,n,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(o){return o.name===Gn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return In(t,e,n,r)})):U(o)}return i._promise(e,function(o,a){return Se(function(){return S.trans=i,r(o,a,i)})}).then(function(o){return i._completion.then(function(){return o})})}}var Ar="3.2.2",Me=String.fromCharCode(65535),Pn=-1/0,fe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",wi="String expected.",ut=[],rn=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ta=rn,na=rn,Ei=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},on="__dbnames",cn="readonly",fn="readwrite";function ze(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var ki={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Kt(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=gt(e),delete e[t]),e}:function(e){return e}}var ra=function(){function t(){}return t.prototype._trans=function(e,n,r){var i=this._tx||S.trans,o=this.name;function a(s,l,h){if(!h.schema[o])throw new K.NotFound("Table "+o+" not part of transaction");return n(h.idbtrans,h)}var u=bt();try{return i&&i.db===this.db?i===S.trans?i._promise(e,a,r):Se(function(){return i._promise(e,a,r)},{trans:i,transless:S.transless||S}):In(this.db,e,[this.name],a)}finally{u&&wt()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(o){return r.hook.reading.fire(o)})}).then(n)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(G(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=N(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(h){return h.compound&&n.every(function(f){return h.keyPath.indexOf(f)>=0})&&h.keyPath.every(function(f){return n.indexOf(f)>=0})})[0];if(r&&this.db._maxKey!==Me)return this.where(r.name).equals(r.keyPath.map(function(h){return e[h]}));!r&&ce&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,o=this.db._deps.indexedDB;function a(h,f){try{return o.cmp(h,f)===0}catch{return!1}}var u=n.reduce(function(h,f){var c=h[0],v=h[1],d=i[f],p=e[f];return[c||d,c||!d?ze(v,d&&d.multi?function(y){var b=ye(y,f);return G(b)&&b.some(function(E){return a(p,E)})}:function(y){return a(p,ye(y,f))}):v]},[null,null]),s=u[0],l=u[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,G(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var i=Object.create(e.prototype);for(var o in r)if(te(r,o))try{i[o]=r[o]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){function e(n){J(this,n)}return this.mapToClass(e)},t.prototype.add=function(e,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,u=e;return a&&o&&(u=Kt(a)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(a)try{ae(e,a,s)}catch{}return s})},t.prototype.update=function(e,n){if(typeof e=="object"&&!G(e)){var r=ye(e,this.schema.primKey.keyPath);if(r===void 0)return U(new K.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?N(n).forEach(function(i){ae(e,i,n[i])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)},t.prototype.put=function(e,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,u=e;return a&&o&&(u=Kt(a)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(a)try{ae(e,a,s)}catch{}return s})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?x.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:ki})}).then(function(n){return n.numFailures?x.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(o){return n.hook.reading.fire(o)})})})},t.prototype.bulkAdd=function(e,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var a=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,h=s.keyPath;if(h&&o)throw new K.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var f=e.length,c=h&&l?e.map(Kt(h)):e;return i.core.mutate({trans:u,type:"add",keys:o,values:c,wantResults:a}).then(function(v){var d=v.numFailures,p=v.results,y=v.lastResult,b=v.failures,E=a?p:y;if(d===0)return E;throw new at(i.name+".bulkAdd(): "+d+" of "+f+" operations failed",b)})})},t.prototype.bulkPut=function(e,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var a=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,h=s.keyPath;if(h&&o)throw new K.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var f=e.length,c=h&&l?e.map(Kt(h)):e;return i.core.mutate({trans:u,type:"put",keys:o,values:c,wantResults:a}).then(function(v){var d=v.numFailures,p=v.results,y=v.lastResult,b=v.failures,E=a?p:y;if(d===0)return E;throw new at(i.name+".bulkPut(): "+d+" of "+f+" operations failed",b)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var o=i.numFailures,a=i.lastResult,u=i.failures;if(o===0)return a;throw new at(n.name+".bulkDelete(): "+o+" of "+r+" operations failed",u)})},t}();function Et(t){var e={},n=function(u,s){if(s){for(var l=arguments.length,h=new Array(l-1);--l;)h[l-1]=arguments[l];return e[u].subscribe.apply(null,h),t}else if(typeof u=="string")return e[u]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(u,s,l){if(typeof u=="object")return a(u);s||(s=Uo),l||(l=B);var h={subscribers:[],fire:l,subscribe:function(f){h.subscribers.indexOf(f)===-1&&(h.subscribers.push(f),h.fire=s(h.fire,f))},unsubscribe:function(f){h.subscribers=h.subscribers.filter(function(c){return c!==f}),h.fire=h.subscribers.reduce(s,l)}};return e[u]=n[u]=h,h}function a(u){N(u).forEach(function(s){var l=u[s];if(G(l))o(s,u[s][0],u[s][1]);else if(l==="asap")var h=o(s,_t,function(){for(var c=arguments.length,v=new Array(c);c--;)v[c]=arguments[c];h.subscribers.forEach(function(d){ri(function(){d.apply(null,v)})})});else throw new K.InvalidArgument("Invalid event config")})}}function kt(t,e){return Xe(e).from({prototype:t}),e}function ia(t){return kt(ra.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:Et(null,{creating:[Lo,B],reading:[zo,_t],updating:[jo,B],deleting:[No,B]})})}function je(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function hn(t,e){t.filter=ze(t.filter,e)}function dn(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return ze(r(),e())}:e,t.justLimit=n&&!r}function oa(t,e){t.isMatch=ze(t.isMatch,e)}function zt(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new K.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Sr(t,e,n){var r=zt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Dt(t,e,n,r){var i=t.replayFilter?ze(t.filter,t.replayFilter()):t.filter;if(t.or){var o={},a=function(u,s,l){if(!i||i(s,l,function(c){return s.stop(c)},function(c){return s.fail(c)})){var h=s.primaryKey,f=""+h;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(h)),te(o,f)||(o[f]=!0,e(u,s,l))}};return Promise.all([t.or._iterate(a,n),Kr(Sr(t,r,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}else return Kr(Sr(t,r,n),ze(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function Kr(t,e,n,r){var i=r?function(a,u,s){return n(r(a),u,s)}:n,o=L(i);return t.then(function(a){if(a)return a.start(function(){var u=function(){return a.continue()};(!e||e(a,function(s){return u=s},function(s){a.stop(s),u=B},function(s){a.fail(s),u=B}))&&o(a.value,a,function(s){return u=s}),u()})})}function X(t,e){try{var n=Dr(t),r=Dr(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return ua(Tr(t),Tr(e));case"Array":return aa(t,e)}}catch{}return NaN}function aa(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,o=0;o<i;++o){var a=X(t[o],e[o]);if(a!==0)return a}return n===r?0:n<r?-1:1}function ua(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,o=0;o<i;++o)if(t[o]!==e[o])return t[o]<e[o]?-1:1;return n===r?0:n<r?-1:1}function Dr(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var n=bn(t);return n==="ArrayBuffer"?"binary":n}function Tr(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var sa=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,U.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,U.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=ze(n.algorithm,e)},t.prototype._iterate=function(e,n){return Dt(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&J(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return Dt(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var i=n._ctx,o=i.table.core;if(je(i,!0))return o.count({trans:r,query:{index:zt(i,o.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var a=0;return Dt(i,function(){return++a,!1},r,o).then(function(){return a})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),i=r[0],o=r.length-1;function a(l,h){return h?a(l[r[h]],h-1):l[i]}var u=this._ctx.dir==="next"?1:-1;function s(l,h){var f=a(l,o),c=a(h,o);return f<c?-u:f>c?u:0}return this.toArray(function(l){return l.sort(s)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&je(i,!0)&&i.limit>0){var o=i.valueMapper,a=zt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:a,range:i.range}}).then(function(s){var l=s.result;return o?l.map(o):l})}else{var u=[];return Dt(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,je(n)?dn(n,function(){var r=e;return function(i,o){return r===0?!0:r===1?(--r,!1):(o(function(){i.advance(r),r=0}),!1)}}):dn(n,function(){var r=e;return function(){return--r<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),dn(this._ctx,function(){var n=e;return function(r,i,o){return--n<=0&&i(o),n>=0}},!0),this},t.prototype.until=function(e,n){return hn(this._ctx,function(r,i,o){return e(r.value)?(i(o),n):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return hn(this._ctx,function(n){return e(n.value)}),oa(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&je(n,!0)&&n.limit>0)return this._read(function(i){var o=zt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:o,range:n.range}})}).then(function(i){var o=i.result;return o}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return hn(this._ctx,function(i){var o=i.primaryKey.toString(),a=te(r,o);return r[o]=!0,!a}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(i){var o;if(typeof e=="function")o=e;else{var a=N(e),u=a.length;o=function(b){for(var E=!1,_=0;_<u;++_){var w=a[_],m=e[w];ye(b,w)!==m&&(ae(b,w,m),E=!0)}return E}}var s=r.table.core,l=s.schema.primaryKey,h=l.outbound,f=l.extractKey,c=n.db._options.modifyChunkSize||200,v=[],d=0,p=[],y=function(b,E){var _=E.failures,w=E.numFailures;d+=b-w;for(var m=0,g=N(_);m<g.length;m++){var C=g[m];v.push(_[C])}};return n.clone().primaryKeys().then(function(b){var E=function(_){var w=Math.min(c,b.length-_);return s.getMany({trans:i,keys:b.slice(_,_+w),cache:"immutable"}).then(function(m){for(var g=[],C=[],k=h?[]:null,A=[],D=0;D<w;++D){var M=m[D],O={value:gt(M),primKey:b[_+D]};o.call(O,O.value,O)!==!1&&(O.value==null?A.push(b[_+D]):!h&&X(f(M),f(O.value))!==0?(A.push(b[_+D]),g.push(O.value)):(C.push(O.value),h&&k.push(b[_+D])))}var P=je(r)&&r.limit===1/0&&(typeof e!="function"||e===pn)&&{index:r.index,range:r.range};return Promise.resolve(g.length>0&&s.mutate({trans:i,type:"add",values:g}).then(function(H){for(var T in H.failures)A.splice(parseInt(T),1);y(g.length,H)})).then(function(){return(C.length>0||P&&typeof e=="object")&&s.mutate({trans:i,type:"put",keys:k,values:C,criteria:P,changeSpec:typeof e!="function"&&e}).then(function(H){return y(C.length,H)})}).then(function(){return(A.length>0||P&&e===pn)&&s.mutate({trans:i,type:"delete",keys:A,criteria:P}).then(function(H){return y(A.length,H)})}).then(function(){return b.length>_+w&&E(_+c)})})};return E(0).then(function(){if(v.length>0)throw new Ht("Error modifying one or more objects",v,d,p);return b.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return je(e)&&(e.isPrimKey&&!na||n.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,o=n;return e.table.core.count({trans:r,query:{index:i,range:o}}).then(function(a){return e.table.core.mutate({trans:r,type:"deleteRange",range:o}).then(function(u){var s=u.failures;u.lastResult,u.results;var l=u.numFailures;if(l)throw new Ht("Could not delete some values",Object.keys(s).map(function(h){return s[h]}),a-l);return a-l})})}):this.modify(pn)},t}(),pn=function(t,e){return e.value=null};function la(t){return kt(sa.prototype,function(n,r){this.db=t;var i=ki,o=null;if(r)try{i=r()}catch(l){o=l}var a=n._ctx,u=a.table,s=u.hook.reading.fire;this._ctx={table:u,index:a.index,isPrimKey:!a.index||u.schema.primKey.keyPath&&a.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:a.or,valueMapper:s!==_t?s:null}})}function ca(t,e){return t<e?-1:t===e?0:1}function fa(t,e){return t>e?-1:t===e?0:1}function Z(t,e,n){var r=t instanceof Ci?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Ue(t){return new t.Collection(t,function(){return xi("")}).limit(0)}function ha(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function da(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function pa(t,e,n,r,i,o){for(var a=Math.min(t.length,r.length),u=-1,s=0;s<a;++s){var l=e[s];if(l!==r[s])return i(t[s],n[s])<0?t.substr(0,s)+n[s]+n.substr(s+1):i(t[s],r[s])<0?t.substr(0,s)+r[s]+n.substr(s+1):u>=0?t.substr(0,u)+e[u]+n.substr(u+1):null;i(t[s],l)<0&&(u=s)}return a<r.length&&o==="next"?t+n.substr(t.length):a<t.length&&o==="prev"?t.substr(0,n.length):u<0?null:t.substr(0,u)+r[u]+n.substr(u+1)}function Tt(t,e,n,r){var i,o,a,u,s,l,h,f=n.length;if(!n.every(function(p){return typeof p=="string"}))return Z(t,wi);function c(p){i=ha(p),o=da(p),a=p==="next"?ca:fa;var y=n.map(function(b){return{lower:o(b),upper:i(b)}}).sort(function(b,E){return a(b.lower,E.lower)});u=y.map(function(b){return b.upper}),s=y.map(function(b){return b.lower}),l=p,h=p==="next"?"":r}c("next");var v=new t.Collection(t,function(){return we(u[0],s[f-1]+r)});v._ondirectionchange=function(p){c(p)};var d=0;return v._addAlgorithm(function(p,y,b){var E=p.key;if(typeof E!="string")return!1;var _=o(E);if(e(_,s,d))return!0;for(var w=null,m=d;m<f;++m){var g=pa(E,_,u[m],s[m],a,l);g===null&&w===null?d=m+1:(w===null||a(w,g)>0)&&(w=g)}return y(w!==null?function(){p.continue(w+h)}:b),!1}),v}function we(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function xi(t){return{type:1,lower:t,upper:t}}var Ci=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||i)&&!(r&&i)?Ue(this):new this.Collection(this,function(){return we(e,n,!r,!i)})}catch{return Z(this,fe)}},t.prototype.equals=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return xi(e)})},t.prototype.above=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return we(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return we(e,void 0,!1)})},t.prototype.below=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return we(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return we(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?Z(this,wi):this.between(e,e+Me,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Tt(this,function(n,r){return n.indexOf(r[0])===0},[e],Me)},t.prototype.equalsIgnoreCase=function(e){return Tt(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=de.apply(Ve,arguments);return e.length===0?Ue(this):Tt(this,function(n,r){return r.indexOf(n)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=de.apply(Ve,arguments);return e.length===0?Ue(this):Tt(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},e,Me)},t.prototype.anyOf=function(){var e=this,n=de.apply(Ve,arguments),r=this._cmp;try{n.sort(r)}catch{return Z(this,fe)}if(n.length===0)return Ue(this);var i=new this.Collection(this,function(){return we(n[0],n[n.length-1])});i._ondirectionchange=function(a){r=a==="next"?e._ascending:e._descending,n.sort(r)};var o=0;return i._addAlgorithm(function(a,u,s){for(var l=a.key;r(l,n[o])>0;)if(++o,o===n.length)return u(s),!1;return r(l,n[o])===0?!0:(u(function(){a.continue(n[o])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[Pn,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=de.apply(Ve,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Z(this,fe)}var n=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[Pn,i]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,i=this._cmp,o=this._ascending,a=this._descending,u=this._min,s=this._max;if(e.length===0)return Ue(this);if(!e.every(function(m){return m[0]!==void 0&&m[1]!==void 0&&o(m[0],m[1])<=0}))return Z(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",K.InvalidArgument);var l=!n||n.includeLowers!==!1,h=n&&n.includeUppers===!0;function f(m,g){for(var C=0,k=m.length;C<k;++C){var A=m[C];if(i(g[0],A[1])<0&&i(g[1],A[0])>0){A[0]=u(A[0],g[0]),A[1]=s(A[1],g[1]);break}}return C===k&&m.push(g),m}var c=o;function v(m,g){return c(m[0],g[0])}var d;try{d=e.reduce(f,[]),d.sort(v)}catch{return Z(this,fe)}var p=0,y=h?function(m){return o(m,d[p][1])>0}:function(m){return o(m,d[p][1])>=0},b=l?function(m){return a(m,d[p][0])>0}:function(m){return a(m,d[p][0])>=0};function E(m){return!y(m)&&!b(m)}var _=y,w=new this.Collection(this,function(){return we(d[0][0],d[d.length-1][1],!l,!h)});return w._ondirectionchange=function(m){m==="next"?(_=y,c=o):(_=b,c=a),d.sort(v)},w._addAlgorithm(function(m,g,C){for(var k=m.key;_(k);)if(++p,p===d.length)return g(C),!1;return E(k)?!0:(r._cmp(k,d[p][1])===0||r._cmp(k,d[p][0])===0||g(function(){c===o?m.continue(d[p][0]):m.continue(d[p][1])}),!1)}),w},t.prototype.startsWithAnyOf=function(){var e=de.apply(Ve,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?Ue(this):this.inAnyRange(e.map(function(n){return[n,n+Me]})):Z(this,"startsWithAnyOf() only works with strings")},t}();function va(t){return kt(Ci.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:i};var o=t._deps.indexedDB;if(!o)throw new K.MissingAPI;this._cmp=this._ascending=o.cmp.bind(o),this._descending=function(a,u){return o.cmp(u,a)},this._max=function(a,u){return o.cmp(a,u)>0?a:u},this._min=function(a,u){return o.cmp(a,u)<0?a:u},this._IDBKeyRange=t._deps.IDBKeyRange})}function le(t){return L(function(e){return pt(e),t(e.target.error),!1})}function pt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var vt="storagemutated",ke="x-storagemutated-1",De=Et(null,vt),ya=function(){function t(){}return t.prototype._lock=function(){return rt(!S.global),++this._reculock,this._reculock===1&&!S.global&&(S.lockOwnerFor=this),this},t.prototype._unlock=function(){if(rt(!S.global),--this._reculock===0)for(S.global||(S.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Ze(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&S.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(rt(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new K.DatabaseClosed(i);case"MissingAPIError":throw new K.MissingAPI(i.message,i);default:throw new K.OpenFailed(i)}if(!this.active)throw new K.TransactionInactive;return rt(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=L(function(o){pt(o),n._reject(e.error)}),e.onabort=L(function(o){pt(o),n.active&&n._reject(new K.Abort(e.error)),n.active=!1,n.on("abort").fire(o)}),e.oncomplete=L(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&De.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return U(new K.ReadOnly("Transaction is readonly"));if(!this.active)return U(new K.TransactionInactive);if(this._locked())return new x(function(a,u){i._blockedFuncs.push([function(){i._promise(e,n,r).then(a,u)},S])});if(r)return Se(function(){var a=new x(function(u,s){i._lock();var l=n(u,s,i);l&&l.then&&l.then(u,s)});return a.finally(function(){return i._unlock()}),a._lib=!0,a});var o=new x(function(a,u){var s=n(a,u,i);s&&s.then&&s.then(a,u)});return o._lib=!0,o},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=x.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=a)})()}var o=n._waitingFor;return new x(function(a,u){r.then(function(s){return n._waitingQueue.push(L(a.bind(null,s)))},function(s){return n._waitingQueue.push(L(u.bind(null,s)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new K.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(te(n,e))return n[e];var r=this.schema[e];if(!r)throw new K.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i},t}();function ma(t){return kt(ya.prototype,function(n,r,i,o,a){var u=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=Et(this,"complete","error","abort"),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new x(function(s,l){u._resolve=s,u._reject=l}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var l=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):l&&u.idbtrans&&u.idbtrans.abort(),U(s)})})}function Rn(t,e,n,r,i,o,a){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+Ai(e)}}function Ai(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Si(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:ii(n,function(r){return[r.name,r]})}}function ga(t){return t.length===1?t[0]:t}var yt=function(t){try{return t.only([[]]),yt=function(){return[[]]},[[]]}catch{return yt=function(){return Me},Me}};function Mn(t){return t==null?function(){}:typeof t=="string"?_a(t):function(e){return ye(e,t)}}function _a(t){var e=t.split(".");return e.length===1?function(n){return n[t]}:function(n){return ye(n,t)}}function Ir(t){return[].slice.call(t)}var ba=0;function st(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function wa(t,e,n){function r(f,c){var v=Ir(f.objectStoreNames);return{schema:{name:f.name,tables:v.map(function(d){return c.objectStore(d)}).map(function(d){var p=d.keyPath,y=d.autoIncrement,b=G(p),E=p==null,_={},w={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E,compound:b,keyPath:p,autoIncrement:y,unique:!0,extractKey:Mn(p)},indexes:Ir(d.indexNames).map(function(m){return d.index(m)}).map(function(m){var g=m.name,C=m.unique,k=m.multiEntry,A=m.keyPath,D=G(A),M={name:g,compound:D,keyPath:A,unique:C,multiEntry:k,extractKey:Mn(A)};return _[st(A)]=M,M}),getIndexByKeyPath:function(m){return _[st(m)]}};return _[":id"]=w.primaryKey,p!=null&&(_[st(p)]=w.primaryKey),w})},hasGetAll:v.length>0&&"getAll"in c.objectStore(v[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(f){if(f.type===3)return null;if(f.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var c=f.lower,v=f.upper,d=f.lowerOpen,p=f.upperOpen,y=c===void 0?v===void 0?null:e.upperBound(v,!!p):v===void 0?e.lowerBound(c,!!d):e.bound(c,v,!!d,!!p);return y}function o(f){var c=f.name;function v(y){var b=y.trans,E=y.type,_=y.keys,w=y.values,m=y.range;return new Promise(function(g,C){g=L(g);var k=b.objectStore(c),A=k.keyPath==null,D=E==="put"||E==="add";if(!D&&E!=="delete"&&E!=="deleteRange")throw new Error("Invalid operation type: "+E);var M=(_||w||{length:1}).length;if(_&&w&&_.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(M===0)return g({numFailures:0,failures:{},results:[],lastResult:void 0});var O,P=[],H=[],T=0,ne=function(se){++T,pt(se)};if(E==="deleteRange"){if(m.type===4)return g({numFailures:T,failures:H,results:[],lastResult:void 0});m.type===3?P.push(O=k.clear()):P.push(O=k.delete(i(m)))}else{var ie=D?A?[w,_]:[w,null]:[_,null],_e=ie[0],ue=ie[1];if(D)for(var re=0;re<M;++re)P.push(O=ue&&ue[re]!==void 0?k[E](_e[re],ue[re]):k[E](_e[re])),O.onerror=ne;else for(var re=0;re<M;++re)P.push(O=k[E](_e[re])),O.onerror=ne}var be=function(se){var et=se.target.result;P.forEach(function(oe,xt){return oe.error!=null&&(H[xt]=oe.error)}),g({numFailures:T,failures:H,results:E==="delete"?_:P.map(function(oe){return oe.result}),lastResult:et})};O.onerror=function(se){ne(se),be(se)},O.onsuccess=be})}function d(y){var b=y.trans,E=y.values,_=y.query,w=y.reverse,m=y.unique;return new Promise(function(g,C){g=L(g);var k=_.index,A=_.range,D=b.objectStore(c),M=k.isPrimaryKey?D:D.index(k.name),O=w?m?"prevunique":"prev":m?"nextunique":"next",P=E||!("openKeyCursor"in M)?M.openCursor(i(A),O):M.openKeyCursor(i(A),O);P.onerror=le(C),P.onsuccess=L(function(H){var T=P.result;if(!T){g(null);return}T.___id=++ba,T.done=!1;var ne=T.continue.bind(T),ie=T.continuePrimaryKey;ie&&(ie=ie.bind(T));var _e=T.advance.bind(T),ue=function(){throw new Error("Cursor not started")},re=function(){throw new Error("Cursor not stopped")};T.trans=b,T.stop=T.continue=T.continuePrimaryKey=T.advance=ue,T.fail=L(C),T.next=function(){var be=this,se=1;return this.start(function(){return se--?be.continue():be.stop()}).then(function(){return be})},T.start=function(be){var se=new Promise(function(oe,xt){oe=L(oe),P.onerror=le(xt),T.fail=xt,T.stop=function(Mi){T.stop=T.continue=T.continuePrimaryKey=T.advance=re,oe(Mi)}}),et=function(){if(P.result)try{be()}catch(oe){T.fail(oe)}else T.done=!0,T.start=function(){throw new Error("Cursor behind last entry")},T.stop()};return P.onsuccess=L(function(oe){P.onsuccess=et,et()}),T.continue=ne,T.continuePrimaryKey=ie,T.advance=_e,et(),se},g(T)},C)})}function p(y){return function(b){return new Promise(function(E,_){E=L(E);var w=b.trans,m=b.values,g=b.limit,C=b.query,k=g===1/0?void 0:g,A=C.index,D=C.range,M=w.objectStore(c),O=A.isPrimaryKey?M:M.index(A.name),P=i(D);if(g===0)return E({result:[]});if(y){var H=m?O.getAll(P,k):O.getAllKeys(P,k);H.onsuccess=function(_e){return E({result:_e.target.result})},H.onerror=le(_)}else{var T=0,ne=m||!("openKeyCursor"in O)?O.openCursor(P):O.openKeyCursor(P),ie=[];ne.onsuccess=function(_e){var ue=ne.result;if(!ue)return E({result:ie});if(ie.push(m?ue.value:ue.primaryKey),++T===g)return E({result:ie});ue.continue()},ne.onerror=le(_)}})}}return{name:c,schema:f,mutate:v,getMany:function(y){var b=y.trans,E=y.keys;return new Promise(function(_,w){_=L(_);for(var m=b.objectStore(c),g=E.length,C=new Array(g),k=0,A=0,D,M=function(T){var ne=T.target;(C[ne._pos]=ne.result)!=null,++A===k&&_(C)},O=le(w),P=0;P<g;++P){var H=E[P];H!=null&&(D=m.get(E[P]),D._pos=P,D.onsuccess=M,D.onerror=O,++k)}k===0&&_(C)})},get:function(y){var b=y.trans,E=y.key;return new Promise(function(_,w){_=L(_);var m=b.objectStore(c),g=m.get(E);g.onsuccess=function(C){return _(C.target.result)},g.onerror=le(w)})},query:p(s),openCursor:d,count:function(y){var b=y.query,E=y.trans,_=b.index,w=b.range;return new Promise(function(m,g){var C=E.objectStore(c),k=_.isPrimaryKey?C:C.index(_.name),A=i(w),D=A?k.count(A):k.count();D.onsuccess=L(function(M){return m(M.target.result)}),D.onerror=le(g)})}}}var a=r(t,n),u=a.schema,s=a.hasGetAll,l=u.tables.map(function(f){return o(f)}),h={};return l.forEach(function(f){return h[f.name]=f}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(f){var c=h[f];if(!c)throw new Error("Table '"+f+"' not found");return h[f]},MIN_KEY:-1/0,MAX_KEY:yt(e),schema:u}}function Ea(t,e){return e.reduce(function(n,r){var i=r.create;return I(I({},n),i(n))},t)}function ka(t,e,n,r){var i=n.IDBKeyRange;n.indexedDB;var o=Ea(wa(e,i,r),t.dbcore);return{dbcore:o}}function er(t,e){var n=t._novip,r=e.db,i=ka(n._middlewares,r,n._deps,e);n.core=i.dbcore,n.tables.forEach(function(o){var a=o.name;n.core.schema.tables.some(function(u){return u.name===a})&&(o.core=n.core.table(a),n[a]instanceof n.Table&&(n[a].core=o.core))})}function Jt(t,e,n,r){var i=t._novip;n.forEach(function(o){var a=r[o];e.forEach(function(u){var s=Wn(u,o);(!s||"value"in s&&s.value===void 0)&&(u===i.Transaction.prototype||u instanceof i.Transaction?me(u,o,{get:function(){return this.table(o)},set:function(l){ti(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):u[o]=new i.Table(o,a))})})}function On(t,e){var n=t._novip;e.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function xa(t,e){return t._cfg.version-e._cfg.version}function Ca(t,e,n,r){var i=t._dbSchema,o=t._createTransaction("readwrite",t._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),u=S.transless||S;Se(function(){S.trans=o,S.transless=u,e===0?(N(i).forEach(function(s){tr(n,s,i[s].primKey,i[s].indexes)}),er(t,n),x.follow(function(){return t.on.populate.fire(o)}).catch(a)):Aa(t,e,o,n).catch(a)})}function Aa(t,e,n,r){var i=t._novip,o=[],a=i._versions,u=i._dbSchema=nr(i,i.idbdb,r),s=!1,l=a.filter(function(f){return f._cfg.version>=e});l.forEach(function(f){o.push(function(){var c=u,v=f._cfg.dbschema;Fn(i,c,r),Fn(i,v,r),u=i._dbSchema=v;var d=Ki(c,v);d.add.forEach(function(w){tr(r,w[0],w[1].primKey,w[1].indexes)}),d.change.forEach(function(w){if(w.recreate)throw new K.Upgrade("Not yet support for changing primary key");var m=r.objectStore(w.name);w.add.forEach(function(g){return Bn(m,g)}),w.change.forEach(function(g){m.deleteIndex(g.name),Bn(m,g)}),w.del.forEach(function(g){return m.deleteIndex(g)})});var p=f._cfg.contentUpgrade;if(p&&f._cfg.version>e){er(i,r),n._memoizedTables={},s=!0;var y=oi(v);d.del.forEach(function(w){y[w]=c[w]}),On(i,[i.Transaction.prototype]),Jt(i,[i.Transaction.prototype],N(y),y),n.schema=y;var b=Hn(p);b&&Je();var E,_=x.follow(function(){if(E=p(n),E&&b){var w=ge.bind(null,null);E.then(w,w)}});return E&&typeof E.then=="function"?x.resolve(E):_.then(function(){return E})}}),o.push(function(c){if(!s||!ta){var v=f._cfg.dbschema;Ka(v,c)}On(i,[i.Transaction.prototype]),Jt(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function h(){return o.length?x.resolve(o.shift()(n.idbtrans)).then(h):x.resolve()}return h().then(function(){Sa(u,r)})}function Ki(t,e){var n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],o=e[r];if(!i)n.add.push([r,o]);else{var a={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!rn)a.recreate=!0,n.change.push(a);else{var u=i.idxByName,s=o.idxByName,l=void 0;for(l in u)s[l]||a.del.push(l);for(l in s){var h=u[l],f=s[l];h?h.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}}return n}function tr(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return Bn(i,o)}),i}function Sa(t,e){N(t).forEach(function(n){e.db.objectStoreNames.contains(n)||tr(e,n,t[n].primKey,t[n].indexes)})}function Ka(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return t[n]==null&&e.db.deleteObjectStore(n)})}function Bn(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function nr(t,e,n){var r={},i=tn(e.objectStoreNames,0);return i.forEach(function(o){for(var a=n.objectStore(o),u=a.keyPath,s=Rn(Ai(u),u||"",!1,!1,!!a.autoIncrement,u&&typeof u!="string",!0),l=[],h=0;h<a.indexNames.length;++h){var f=a.index(a.indexNames[h]);u=f.keyPath;var c=Rn(f.name,u,!!f.unique,!!f.multiEntry,!1,u&&typeof u!="string",!1);l.push(c)}r[o]=Si(o,s,l)}),r}function Da(t,e,n){var r=t._novip;r.verno=e.version/10;var i=r._dbSchema=nr(r,e,n);r._storeNames=tn(e.objectStoreNames,0),Jt(r,[r._allTables],N(i),i)}function Ta(t,e){var n=nr(t,t.idbdb,e),r=Ki(n,t._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function Fn(t,e,n){for(var r=t._novip,i=n.db.objectStoreNames,o=0;o<i.length;++o){var a=i[o],u=n.objectStore(a);r._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var l=u.indexNames[s],h=u.index(l).keyPath,f=typeof h=="string"?h:"["+tn(h).join("+")+"]";if(e[a]){var c=e[a].idxByName[f];c&&(c.name=l,delete e[a].idxByName[f],e[a].idxByName[l]=c)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&z.WorkerGlobalScope&&z instanceof z.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Ia(t){return t.split(",").map(function(e,n){e=e.trim();var r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Rn(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),G(i),n===0)})}var Pa=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){N(e).forEach(function(r){if(e[r]!==null){var i=Ia(e[r]),o=i.shift();if(o.multi)throw new K.Schema("Primary key cannot be multi-valued");i.forEach(function(a){if(a.auto)throw new K.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new K.Schema("Index must have a name and cannot be an empty string")}),n[r]=Si(r,o,i)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?J(this._cfg.storesSource,e):e;var r=n._versions,i={},o={};return r.forEach(function(a){J(i,a._cfg.storesSource),o=a._cfg.dbschema={},a._parseStoresSpec(i,o)}),n._dbSchema=o,On(n,[n._allTables,n,n.Transaction.prototype]),Jt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],N(o),o),n._storeNames=N(o),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Qn(this._cfg.contentUpgrade||B,e),this},t}();function Ra(t){return kt(Pa.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function rr(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new ur(on,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function ir(t){return t&&typeof t.databases=="function"}function Ma(t){var e=t.indexedDB,n=t.IDBKeyRange;return ir(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==on})}):rr(e,n).toCollection().primaryKeys()}function Oa(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!ir(n)&&e!==on&&rr(n,r).put({name:e}).catch(B)}function Ba(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!ir(n)&&e!==on&&rr(n,r).delete(e).catch(B)}function $n(t){return Se(function(){return S.letThrough=!0,t()})}function Fa(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function $a(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?U(e.dbOpenError):t});ce&&(e.openCanceller._stackHolder=Ne()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new K.DatabaseClosed("db.open() was cancelled")}var o=e.dbReadyResolve,a=null,u=!1;return x.race([r,(typeof navigator=="undefined"?x.resolve():Fa()).then(function(){return new x(function(s,l){if(i(),!n)throw new K.MissingAPI;var h=t.name,f=e.autoSchema?n.open(h):n.open(h,Math.round(t.verno*10));if(!f)throw new K.MissingAPI;f.onerror=le(l),f.onblocked=L(t._fireOnBlocked),f.onupgradeneeded=L(function(c){if(a=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=pt,a.abort(),f.result.close();var v=n.deleteDatabase(h);v.onsuccess=v.onerror=L(function(){l(new K.NoSuchDatabase("Database "+h+" doesnt exist"))})}else{a.onerror=le(l);var d=c.oldVersion>Math.pow(2,62)?0:c.oldVersion;u=d<1,t._novip.idbdb=f.result,Ca(t,d/10,a,l)}},l),f.onsuccess=L(function(){a=null;var c=t._novip.idbdb=f.result,v=tn(c.objectStoreNames);if(v.length>0)try{var d=c.transaction(ga(v),"readonly");e.autoSchema?Da(t,c,d):(Fn(t,t._dbSchema,d),Ta(t,d)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),er(t,d)}catch{}ut.push(t),c.onversionchange=L(function(p){e.vcFired=!0,t.on("versionchange").fire(p)}),c.onclose=L(function(p){t.on("close").fire(p)}),u&&Oa(t._deps,h),s()},l)})})]).then(function(){return i(),e.onReadyBeingFired=[],x.resolve($n(function(){return t.on.ready.fire(t.vip)})).then(function s(){if(e.onReadyBeingFired.length>0){var l=e.onReadyBeingFired.reduce(Qn,B);return e.onReadyBeingFired=[],x.resolve($n(function(){return l(t.vip)})).then(s)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(s){e.dbOpenError=s;try{a&&a.abort()}catch{}return r===e.openCanceller&&t._close(),U(s)}).finally(function(){e.openComplete=!0,o()})}function zn(t){var e=function(a){return t.next(a)},n=function(a){return t.throw(a)},r=o(e),i=o(n);function o(a){return function(u){var s=a(u),l=s.value;return s.done?l:!l||typeof l.then!="function"?G(l)?Promise.all(l).then(r,i):r(l):l.then(r,i)}}return o(e)()}function za(t,e,n){var r=arguments.length;if(r<2)throw new K.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=ai(i);return[t,o,n]}function Di(t,e,n,r,i){return x.resolve().then(function(){var o=S.transless||S,a=t._createTransaction(e,n,t._dbSchema,r),u={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(f){return f.name===Gn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Di(t,e,n,null,i)})):U(f)}var s=Hn(i);s&&Je();var l,h=x.follow(function(){if(l=i.call(a,a),l)if(s){var f=ge.bind(null,null);l.then(f,f)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=zn(l))},u);return(l&&typeof l.then=="function"?x.resolve(l).then(function(f){return a.active?f:U(new K.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):h.then(function(){return l})).then(function(f){return r&&a._resolve(),a._completion.then(function(){return f})}).catch(function(f){return a._reject(f),U(f)})})}function It(t,e,n){for(var r=G(t)?t.slice():[t],i=0;i<n;++i)r.push(e);return r}function La(t){return I(I({},t),{table:function(e){var n=t.table(e),r=n.schema,i={},o=[];function a(p,y,b){var E=st(p),_=i[E]=i[E]||[],w=p==null?0:typeof p=="string"?1:p.length,m=y>0,g=I(I({},b),{isVirtual:m,keyTail:y,keyLength:w,extractKey:Mn(p),unique:!m&&b.unique});if(_.push(g),g.isPrimaryKey||o.push(g),w>1){var C=w===2?p[0]:p.slice(0,w-1);a(C,y+1,b)}return _.sort(function(k,A){return k.keyTail-A.keyTail}),g}var u=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,l=r.indexes;s<l.length;s++){var h=l[s];a(h.keyPath,0,h)}function f(p){var y=i[st(p)];return y&&y[0]}function c(p,y){return{type:p.type===1?2:p.type,lower:It(p.lower,p.lowerOpen?t.MAX_KEY:t.MIN_KEY,y),lowerOpen:!0,upper:It(p.upper,p.upperOpen?t.MIN_KEY:t.MAX_KEY,y),upperOpen:!0}}function v(p){var y=p.query.index;return y.isVirtual?I(I({},p),{query:{index:y,range:c(p.query.range,y.keyTail)}}):p}var d=I(I({},n),{schema:I(I({},r),{primaryKey:u,indexes:o,getIndexByKeyPath:f}),count:function(p){return n.count(v(p))},query:function(p){return n.query(v(p))},openCursor:function(p){var y=p.query.index,b=y.keyTail,E=y.isVirtual,_=y.keyLength;if(!E)return n.openCursor(p);function w(m){function g(k){k!=null?m.continue(It(k,p.reverse?t.MAX_KEY:t.MIN_KEY,b)):p.unique?m.continue(m.key.slice(0,_).concat(p.reverse?t.MIN_KEY:t.MAX_KEY,b)):m.continue()}var C=Object.create(m,{continue:{value:g},continuePrimaryKey:{value:function(k,A){m.continuePrimaryKey(It(k,t.MAX_KEY,b),A)}},primaryKey:{get:function(){return m.primaryKey}},key:{get:function(){var k=m.key;return _===1?k[0]:k.slice(0,_)}},value:{get:function(){return m.value}}});return C}return n.openCursor(v(p)).then(function(m){return m&&w(m)})}});return d}})}var Na={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:La};function or(t,e,n,r){return n=n||{},r=r||"",N(t).forEach(function(i){if(!te(e,i))n[r+i]=void 0;else{var o=t[i],a=e[i];if(typeof o=="object"&&typeof a=="object"&&o&&a){var u=bn(o),s=bn(a);u!==s?n[r+i]=e[i]:u==="Object"?or(o,a,n,r+i+"."):o!==a&&(n[r+i]=e[i])}else o!==a&&(n[r+i]=e[i])}}),N(e).forEach(function(i){te(t,i)||(n[r+i]=e[i])}),n}function ja(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var Ua={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return I(I({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,i=I(I({},n),{mutate:function(o){var a=S.trans,u=a.table(e).hook,s=u.deleting,l=u.creating,h=u.updating;switch(o.type){case"add":if(l.fire===B)break;return a._promise("readwrite",function(){return f(o)},!0);case"put":if(l.fire===B&&h.fire===B)break;return a._promise("readwrite",function(){return f(o)},!0);case"delete":if(s.fire===B)break;return a._promise("readwrite",function(){return f(o)},!0);case"deleteRange":if(s.fire===B)break;return a._promise("readwrite",function(){return c(o)},!0)}return n.mutate(o);function f(d){var p=S.trans,y=d.keys||ja(r,d);if(!y)throw new Error("Keys missing");return d=d.type==="add"||d.type==="put"?I(I({},d),{keys:y}):I({},d),d.type!=="delete"&&(d.values=gn([],d.values,!0)),d.keys&&(d.keys=gn([],d.keys,!0)),Va(n,d,y).then(function(b){var E=y.map(function(_,w){var m=b[w],g={onerror:null,onsuccess:null};if(d.type==="delete")s.fire.call(g,_,m,p);else if(d.type==="add"||m===void 0){var C=l.fire.call(g,_,d.values[w],p);_==null&&C!=null&&(_=C,d.keys[w]=_,r.outbound||ae(d.values[w],r.keyPath,_))}else{var k=or(m,d.values[w]),A=h.fire.call(g,k,_,m,p);if(A){var D=d.values[w];Object.keys(A).forEach(function(M){te(D,M)?D[M]=A[M]:ae(D,M,A[M])})}}return g});return n.mutate(d).then(function(_){for(var w=_.failures,m=_.results,g=_.numFailures,C=_.lastResult,k=0;k<y.length;++k){var A=m?m[k]:y[k],D=E[k];A==null?D.onerror&&D.onerror(w[k]):D.onsuccess&&D.onsuccess(d.type==="put"&&b[k]?d.values[k]:A)}return{failures:w,results:m,numFailures:g,lastResult:C}}).catch(function(_){return E.forEach(function(w){return w.onerror&&w.onerror(_)}),Promise.reject(_)})})}function c(d){return v(d.trans,d.range,1e4)}function v(d,p,y){return n.query({trans:d,values:!1,query:{index:r,range:p},limit:y}).then(function(b){var E=b.result;return f({type:"delete",keys:E,trans:d}).then(function(_){return _.numFailures>0?Promise.reject(_.failures[0]):E.length<y?{failures:[],numFailures:0,lastResult:void 0}:v(d,I(I({},p),{lower:E[E.length-1],lowerOpen:!0}),y)})})}}});return i}})}};function Va(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function Ti(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],i=0,o=0;i<e.keys.length&&o<t.length;++i)X(e.keys[i],t[o])===0&&(r.push(n?gt(e.values[i]):e.values[i]),++o);return r.length===t.length?r:null}catch{return null}}var Wa={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return I(I({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Ti(r.keys,r.trans._cache,r.cache==="clone");return i?x.resolve(i):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?gt(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},vn;function ar(t){return!("from"in t)}var he=function(t,e){if(this)J(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var n=new he;return t&&"d"in t&&J(n,t),n}};Qe(he.prototype,(vn={add:function(t){return Zt(this,t),this},addKey:function(t){return mt(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return mt(e,n,n)}),this}},vn[wn]=function(){return Ln(this)},vn));function mt(t,e,n){var r=X(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(ar(t))return J(t,{from:e,to:n,d:1});var i=t.l,o=t.r;if(X(n,t.from)<0)return i?mt(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Pr(t);if(X(e,t.to)>0)return o?mt(o,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Pr(t);X(e,t.from)<0&&(t.from=e,t.l=null,t.d=o?o.d+1:1),X(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var a=!t.r;i&&!t.l&&Zt(t,i),o&&a&&Zt(t,o)}}function Zt(t,e){function n(r,i){var o=i.from,a=i.to,u=i.l,s=i.r;mt(r,o,a),u&&n(r,u),s&&n(r,s)}ar(e)||n(t,e)}function Ha(t,e){var n=Ln(e),r=n.next();if(r.done)return!1;for(var i=r.value,o=Ln(t),a=o.next(i.from),u=a.value;!r.done&&!a.done;){if(X(u.from,i.to)<=0&&X(u.to,i.from)>=0)return!0;X(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(a=o.next(i.from)).value}return!1}function Ln(t){var e=ar(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&X(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||X(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Pr(t){var e,n,r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var o=i==="r"?"l":"r",a=I({},t),u=t[i];t.from=u.from,t.to=u.to,t[i]=u[i],a[i]=u[o],t[o]=a,a.d=Rr(a)}t.d=Rr(t)}function Rr(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}var Ya={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new he(t.MIN_KEY,t.MAX_KEY);return I(I({},t),{table:function(r){var i=t.table(r),o=i.schema,a=o.primaryKey,u=a.extractKey,s=a.outbound,l=I(I({},i),{mutate:function(c){var v=c.trans,d=v.mutatedParts||(v.mutatedParts={}),p=function(C){var k="idb://"+e+"/"+r+"/"+C;return d[k]||(d[k]=new he)},y=p(""),b=p(":dels"),E=c.type,_=c.type==="deleteRange"?[c.range]:c.type==="delete"?[c.keys]:c.values.length<50?[[],c.values]:[],w=_[0],m=_[1],g=c.trans._cache;return i.mutate(c).then(function(C){if(G(w)){E!=="delete"&&(w=C.results),y.addKeys(w);var k=Ti(w,g);!k&&E!=="add"&&b.addKeys(w),(k||m)&&Ga(p,o,k,m)}else if(w){var A={from:w.lower,to:w.upper};b.add(A),y.add(A)}else y.add(n),b.add(n),o.indexes.forEach(function(D){return p(D.name).add(n)});return C})}}),h=function(c){var v,d,p=c.query,y=p.index,b=p.range;return[y,new he((v=b.lower)!==null&&v!==void 0?v:t.MIN_KEY,(d=b.upper)!==null&&d!==void 0?d:t.MAX_KEY)]},f={get:function(c){return[a,new he(c.key)]},getMany:function(c){return[a,new he().addKeys(c.keys)]},count:h,query:h,openCursor:h};return N(f).forEach(function(c){l[c]=function(v){var d=S.subscr;if(d){var p=function(g){var C="idb://"+e+"/"+r+"/"+g;return d[C]||(d[C]=new he)},y=p(""),b=p(":dels"),E=f[c](v),_=E[0],w=E[1];if(p(_.name||"").add(w),!_.isPrimaryKey)if(c==="count")b.add(n);else{var m=c==="query"&&s&&v.values&&i.query(I(I({},v),{values:!1}));return i[c].apply(this,arguments).then(function(g){if(c==="query"){if(s&&v.values)return m.then(function(D){var M=D.result;return y.addKeys(M),g});var C=v.values?g.result.map(u):g.result;v.values?y.addKeys(C):b.addKeys(C)}else if(c==="openCursor"){var k=g,A=v.values;return k&&Object.create(k,{key:{get:function(){return b.addKey(k.primaryKey),k.key}},primaryKey:{get:function(){var D=k.primaryKey;return b.addKey(D),D}},value:{get:function(){return A&&y.addKey(k.primaryKey),k.value}}})}return g})}}return i[c].apply(this,arguments)}}),l}})}};function Ga(t,e,n,r){function i(o){var a=t(o.name||"");function u(l){return l!=null?o.extractKey(l):null}var s=function(l){return o.multiEntry&&G(l)?l.forEach(function(h){return a.addKey(h)}):a.addKey(l)};(n||r).forEach(function(l,h){var f=n&&u(n[h]),c=r&&u(r[h]);X(f,c)!==0&&(f!=null&&s(f),c!=null&&s(c))})}e.indexes.forEach(i)}var ur=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=n=I({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var o=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:B,dbReadyPromise:null,cancelOpen:B,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};a.dbReadyPromise=new x(function(u){a.dbReadyResolve=u}),a.openCanceller=new x(function(u,s){a.cancelOpen=s}),this._state=a,this.name=e,this.on=Et(this,"populate","blocked","versionchange","close",{ready:[Qn,B]}),this.on.ready.subscribe=ni(this.on.ready.subscribe,function(u){return function(s,l){t.vip(function(){var h=r._state;if(h.openComplete)h.dbOpenError||x.resolve().then(s),l&&u(s);else if(h.onReadyBeingFired)h.onReadyBeingFired.push(s),l&&u(s);else{u(s);var f=r;l||u(function c(){f.on.ready.unsubscribe(s),f.on.ready.unsubscribe(c)})}})}}),this.Collection=la(this),this.Table=ia(this),this.Transaction=ma(this),this.Version=Ra(this),this.WhereClause=va(this),this.on("versionchange",function(u){u.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+u.oldVersion/10)}),this._maxKey=yt(n.IDBKeyRange),this._createTransaction=function(u,s,l,h){return new r.Transaction(u,s,l,r._options.chromeTransactionDurability,h)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),ut.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(u)})},this.use(Na),this.use(Ua),this.use(Ya),this.use(Wa),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(function(u){return u(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new K.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new K.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(xa),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||S.letThrough||this._vip)?e():new x(function(r,i){if(n._state.openComplete)return i(new K.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new K.DatabaseClosed);return}n.open().catch(B)}n._state.dbReadyPromise.then(r,i)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,i=e.level,o=e.name;o&&this.unuse({stack:n,name:o});var a=this._middlewares[n]||(this._middlewares[n]=[]);return a.push({stack:n,create:r,level:i==null?10:i,name:o}),a.sort(function(u,s){return u.level-s.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,i=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(o){return i?o.create!==i:r?o.name!==r:!1})),this},t.prototype.open=function(){return $a(this)},t.prototype._close=function(){var e=this._state,n=ut.indexOf(this);if(n>=0&&ut.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new x(function(r){e.dbReadyResolve=r}),e.openCanceller=new x(function(r,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new K.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new x(function(i,o){var a=function(){e.close();var u=e._deps.indexedDB.deleteDatabase(e.name);u.onsuccess=L(function(){Ba(e._deps,e.name),i()}),u.onerror=le(o),u.onblocked=e._fireOnBlocked};if(n)throw new K.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return N(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=za.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var i=this,o=S.trans;(!o||o.db!==this||e.indexOf("!")!==-1)&&(o=null);var a=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var u,s;try{if(s=n.map(function(h){var f=h instanceof i.Table?h.name:h;if(typeof f!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return f}),e=="r"||e===cn)u=cn;else if(e=="rw"||e==fn)u=fn;else throw new K.InvalidArgument("Invalid transaction mode: "+e);if(o){if(o.mode===cn&&u===fn)if(a)o=null;else throw new K.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o&&s.forEach(function(h){if(o&&o.storeNames.indexOf(h)===-1)if(a)o=null;else throw new K.SubTransaction("Table "+h+" not included in parent transaction.")}),a&&o&&!o.active&&(o=null)}}catch(h){return o?o._promise(null,function(f,c){c(h)}):U(h)}var l=Di.bind(null,this,u,s,o,r);return o?o._promise(u,l,"lock"):S.trans?Ze(S.transless,function(){return i._whenReady(l)}):this._whenReady(l)},t.prototype.table=function(e){if(!te(this._allTables,e))throw new K.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),Qa=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",Xa=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)},t.prototype[Qa]=function(){return this},t}();function Ii(t,e){return N(e).forEach(function(n){var r=t[n]||(t[n]=new he);Zt(r,e[n])}),t}function Pi(t){return new Xa(function(e){var n=Hn(t);function r(v){n&&Je();var d=function(){return Se(t,{subscr:v,trans:null})},p=S.trans?Ze(S.transless,d):d();return n&&p.then(ge,ge),p}var i=!1,o={},a={},u={get closed(){return i},unsubscribe:function(){i=!0,De.storagemutated.unsubscribe(f)}};e.start&&e.start(u);var s=!1,l=!1;function h(){return N(a).some(function(v){return o[v]&&Ha(o[v],a[v])})}var f=function(v){Ii(o,v),h()&&c()},c=function(){if(!(s||i)){o={};var v={},d=r(v);l||(De(vt,f),l=!0),s=!0,Promise.resolve(d).then(function(p){s=!1,!i&&(h()?c():(o={},a=v,e.next&&e.next(p)))},function(p){s=!1,e.error&&e.error(p),u.unsubscribe()})}};return c(),u})}var Nn;try{Nn={indexedDB:z.indexedDB||z.mozIndexedDB||z.webkitIndexedDB||z.msIndexedDB,IDBKeyRange:z.IDBKeyRange||z.webkitIDBKeyRange}}catch{Nn={indexedDB:null,IDBKeyRange:null}}var Re=ur;Qe(Re,I(I({},nn),{delete:function(t){var e=new Re(t,{addons:[]});return e.delete()},exists:function(t){return new Re(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return Ma(Re.dependencies).then(t)}catch{return U(new K.MissingAPI)}},defineClass:function(){function t(e){J(this,e)}return t},ignoreTransaction:function(t){return S.trans?Ze(S.transless,t):t()},vip:$n,async:function(t){return function(){try{var e=zn(t.apply(this,arguments));return!e||typeof e.then!="function"?x.resolve(e):e}catch(n){return U(n)}}},spawn:function(t,e,n){try{var r=zn(t.apply(n,e||[]));return!r||typeof r.then!="function"?x.resolve(r):r}catch(i){return U(i)}},currentTransaction:{get:function(){return S.trans||null}},waitFor:function(t,e){var n=x.resolve(typeof t=="function"?Re.ignoreTransaction(t):t).timeout(e||6e4);return S.trans?S.trans.waitFor(n):n},Promise:x,debug:{get:function(){return ce},set:function(t){si(t,t==="dexie"?function(){return!0}:Ei)}},derive:Xe,extend:J,props:Qe,override:ni,Events:Et,on:De,liveQuery:Pi,extendObservabilitySet:Ii,getByKeyPath:ye,setByKeyPath:ae,delByKeyPath:Do,shallowClone:oi,deepClone:gt,getObjectDiff:or,cmp:X,asap:ri,minKey:Pn,addons:[],connections:ut,errnames:Gn,dependencies:Nn,semVer:Ar,version:Ar.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,n*2)})}));Re.maxKey=yt(Re.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(De(vt,function(t){if(!ve){var e;rn?(e=document.createEvent("CustomEvent"),e.initCustomEvent(ke,!0,!0,t)):e=new CustomEvent(ke,{detail:t}),ve=!0,dispatchEvent(e),ve=!1}}),addEventListener(ke,function(t){var e=t.detail;ve||en(e)}));function en(t){var e=ve;try{ve=!0,De.storagemutated.fire(t)}finally{ve=e}}var ve=!1;if(typeof BroadcastChannel!="undefined"){var Mr=new BroadcastChannel(ke);De(vt,function(t){ve||Mr.postMessage(t)}),Mr.onmessage=function(t){t.data&&en(t.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){De(vt,function(t){try{ve||(typeof localStorage!="undefined"&&localStorage.setItem(ke,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&gn([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:ke,changedParts:t})}))}catch{}}),typeof addEventListener!="undefined"&&addEventListener("storage",function(t){if(t.key===ke){var e=JSON.parse(t.newValue);e&&en(e.changedParts)}});var Or=self.document&&navigator.serviceWorker;Or&&Or.addEventListener("message",qa)}function qa(t){var e=t.data;e&&e.type===ke&&en(e.changedParts)}x.rejectionMapper=$o;si(ce,Ei);class Ja extends ur{constructor(){super("MemoryGame");sr(this,"completedGames");this.version(1).stores({completedGames:"++id, itemCount, moveCount"})}}const Ri=new Ja;function Br(t,e,n){const r=t.slice();return r[5]=e[n],r[7]=n,r}function Za(t){let e=[],n=new Map,r,i=Object.keys(t[1]).sort(t[2]);const o=a=>a[7];for(let a=0;a<i.length;a+=1){let u=Br(t,i,a),s=o(u);n.set(s,e[a]=Fr(s,u))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=Un()},m(a,u){for(let s=0;s<e.length;s+=1)e[s].m(a,u);V(a,r,u)},p(a,u){u&14&&(i=Object.keys(a[1]).sort(a[2]),e=ei(e,u,o,1,a,i,n,r.parentNode,ro,Fr,r,Br))},d(a){for(let u=0;u<e.length;u+=1)e[u].d(a);a&&j(r)}}}function eu(t){let e;return{c(){e=$("tr"),e.innerHTML='<td colspan="3" class="muted centered svelte-19w152h">No games played</td>'},m(n,r){V(n,e,r)},p:Q,d(n){n&&j(e)}}}function Fr(t,e){let n,r,i=e[5]+"",o,a,u,s=e[1][e[5]].length+"",l,h,f,c=e[3](Math.max(...e[1][e[5]].map($r)))+"",v,d;return{key:t,first:null,c(){n=$("tr"),r=$("td"),o=xe(i),a=ee(),u=$("td"),l=xe(s),h=ee(),f=$("td"),v=xe(c),d=ee(),F(r,"class","svelte-19w152h"),F(u,"class","svelte-19w152h"),F(f,"class","svelte-19w152h"),this.first=n},m(p,y){V(p,n,y),R(n,r),R(r,o),R(n,a),R(n,u),R(u,l),R(n,h),R(n,f),R(f,v),R(n,d)},p(p,y){e=p,y&2&&i!==(i=e[5]+"")&&He(o,i),y&2&&s!==(s=e[1][e[5]].length+"")&&He(l,s),y&2&&c!==(c=e[3](Math.max(...e[1][e[5]].map($r)))+"")&&He(v,c)},d(p){p&&j(n)}}}function tu(t){let e,n,r,i;function o(s,l){return s[0]&&s[0].length===0?eu:Za}let a=o(t),u=a(t);return{c(){e=$("table"),n=$("thead"),n.innerHTML=`<tr><th class="svelte-19w152h">Moves</th> 
      <th class="svelte-19w152h">Games</th> 
      <th class="svelte-19w152h">Last Played</th></tr>`,r=ee(),i=$("tbody"),u.c(),F(n,"class","svelte-19w152h"),F(i,"class","svelte-19w152h"),F(e,"class","svelte-19w152h")},m(s,l){V(s,e,l),R(e,n),R(e,r),R(e,i),u.m(i,null)},p(s,[l]){a===(a=o(s))&&u?u.p(s,l):(u.d(1),u=a(s),u&&(u.c(),u.m(i,null)))},i:Q,o:Q,d(s){s&&j(e),u.d()}}}const $r=t=>t.timestamp;function nu(t,e,n){let r,i;const o=(s,l)=>parseInt(s)-parseInt(l),a=s=>{const l={year:"numeric",month:"short",day:"numeric"};return new Date(s).toLocaleDateString(navigator.language,l)};let u=Pi(()=>Ri.completedGames.toArray());return Ni(t,u,s=>n(0,i=s)),t.$$.update=()=>{t.$$.dirty&1&&n(1,r=xo(i||[],"moveCount"))},[i,r,o,a,u]}class ru extends Pe{constructor(e){super(),Ie(this,e,nu,tu,Te,{})}}function iu(t){let e,n,r,i;return{c(){e=$("div"),n=$("button"),n.textContent="Close",n.autofocus=!0,F(n,"class","button modal-close-button svelte-lh4ff1"),F(e,"slot","header"),F(e,"class","modal-header svelte-lh4ff1")},m(o,a){V(o,e,a),R(e,n),n.focus(),r||(i=lt(n,"click",t[0]),r=!0)},p:Q,d(o){o&&j(e),r=!1,i()}}}function ou(t){let e,n,r,i,o;return i=new ru({}),{c(){e=$("div"),n=$("p"),n.textContent="Your objective is to solve puzzles in the fewest moves possible.",r=ee(),Fe(i.$$.fragment),F(n,"class","text-muted"),F(e,"slot","content"),F(e,"class","records-list svelte-lh4ff1")},m(a,u){V(a,e,u),R(e,n),R(e,r),Ce(i,e,null),o=!0},p:Q,i(a){o||(W(i.$$.fragment,a),o=!0)},o(a){q(i.$$.fragment,a),o=!1},d(a){a&&j(e),Ae(i)}}}function au(t){let e,n;return e=new ko({props:{$$slots:{content:[ou],header:[iu]},$$scope:{ctx:t}}}),e.$on("close",t[1]),{c(){Fe(e.$$.fragment)},m(r,i){Ce(e,r,i),n=!0},p(r,[i]){const o={};i&8&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){q(e.$$.fragment,r),n=!1},d(r){Ae(e,r)}}}function uu(t){const e=Vn(),n=()=>e("close");function r(i){Xr.call(this,t,i)}return[n,r]}class su extends Pe{constructor(e){super(),Ie(this,e,uu,au,Te,{})}}function lu(t){let e,n,r,i=t[0]===1?"move":"moves",o;return{c(){e=$("div"),n=xe(t[0]),r=ee(),o=xe(i),F(e,"class","svelte-al6881")},m(a,u){V(a,e,u),R(e,n),R(e,r),R(e,o)},p(a,[u]){u&1&&He(n,a[0]),u&1&&i!==(i=a[0]===1?"move":"moves")&&He(o,i)},i:Q,o:Q,d(a){a&&j(e)}}}function cu(t,e,n){let{count:r=0}=e;return t.$$set=i=>{"count"in i&&n(0,r=i.count)},[r]}class fu extends Pe{constructor(e){super(),Ie(this,e,cu,lu,Te,{count:0})}}function hu(t){let e,n,r,i;return e=new fu({props:{count:t[6]}}),r=new mo({}),r.$on("click",t[3]),{c(){Fe(e.$$.fragment),n=ee(),Fe(r.$$.fragment)},m(o,a){Ce(e,o,a),V(o,n,a),Ce(r,o,a),i=!0},p(o,a){const u={};a&64&&(u.count=o[6]),e.$set(u)},i(o){i||(W(e.$$.fragment,o),W(r.$$.fragment,o),i=!0)},o(o){q(e.$$.fragment,o),q(r.$$.fragment,o),i=!1},d(o){Ae(e,o),o&&j(n),Ae(r,o)}}}function zr(t){let e,n;return e=new su({}),e.$on("close",t[4]),{c(){Fe(e.$$.fragment)},m(r,i){Ce(e,r,i),n=!0},p:Q,i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){q(e.$$.fragment,r),n=!1},d(r){Ae(e,r)}}}function du(t){let e,n,r,i,o,a;r=new po({props:{puzzle:t[0].puzzle,onCompleted:t[2],$$slots:{default:[hu,({moveCount:s})=>({6:s}),({moveCount:s})=>s?64:0]},$$scope:{ctx:t}}});let u=t[1]&&zr(t);return{c(){e=$("div"),n=$("div"),Fe(r.$$.fragment),i=ee(),u&&u.c(),o=Un(),F(n,"class","app-container svelte-15ktk62"),F(e,"class","app-root svelte-15ktk62")},m(s,l){V(s,e,l),R(e,n),Ce(r,n,null),V(s,i,l),u&&u.m(s,l),V(s,o,l),a=!0},p(s,[l]){const h={};l&1&&(h.puzzle=s[0].puzzle),l&194&&(h.$$scope={dirty:l,ctx:s}),r.$set(h),s[1]?u?(u.p(s,l),l&2&&W(u,1)):(u=zr(s),u.c(),W(u,1),u.m(o.parentNode,o)):u&&(Jr(),q(u,1,1,()=>{u=null}),Zr())},i(s){a||(W(r.$$.fragment,s),W(u),a=!0)},o(s){q(r.$$.fragment,s),q(u),a=!1},d(s){s&&j(e),Ae(r),s&&j(i),u&&u.d(s),s&&j(o)}}}function Lr(){const t=Math.random,e=[[4,4]],[n,r]=e[Math.floor(t()*e.length)],i=n*r/2;let o=new Array(i).fill().map((l,h)=>h+1);o.push(...o);const a=Array.from({length:o.length},(l,h)=>{const f=Math.floor(t()*o.length);return{index:h,type:o.splice(f,1)[0],backfaceIsUp:!1}});console.log("new puzzle!");const u=a.map(l=>l.type);for(var s=0;s<r;s++)console.log(u.splice(0,n));return{puzzle:a}}function pu(t,e,n){let r=Lr();const i=async l=>{await Ri.completedGames.add({itemCount:r.puzzle.length,moveCount:l,timestamp:Date.now()})};function o(l){alert(`You won in ${l} moves!`),i(l),n(0,r=Lr())}let a=!1;return[r,a,o,()=>n(1,a=!0),()=>n(1,a=!1)]}class vu extends Pe{constructor(e){super(),Ie(this,e,pu,du,Te,{})}}new vu({target:document.body,props:{}});
