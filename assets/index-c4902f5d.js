var Fi=Object.defineProperty;var zi=(t,e,n)=>e in t?Fi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var hr=(t,e,n)=>(zi(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function j(){}const Wr=t=>t;function Ni(t,e){for(const n in e)t[n]=e[n];return t}function Hr(t){return t()}function dr(){return Object.create(null)}function Ie(t){t.forEach(Hr)}function Vn(t){return typeof t=="function"}function _e(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function ji(t){return Object.keys(t).length===0}function Li(t,...e){if(t==null)return j;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Wn(t,e,n){t.$$.on_destroy.push(Li(e,n))}function Lt(t,e,n,r){if(t){const i=Yr(t,e,n,r);return t[0](i)}}function Yr(t,e,n,r){return t[1]&&r?Ni(n.ctx.slice(),t[1](r(e))):n.ctx}function Ut(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],a=Math.max(e.dirty.length,i.length);for(let u=0;u<a;u+=1)o[u]=e.dirty[u]|i[u];return o}return e.dirty|i}return e.dirty}function Vt(t,e,n,r,i,o){if(i){const a=Yr(e,n,r,o);t.p(a,i)}}function Wt(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function pr(t,e,n){return t.set(n),e}const Gr=typeof window<"u";let Ui=Gr?()=>window.performance.now():()=>Date.now(),Hn=Gr?t=>requestAnimationFrame(t):j;const He=new Set;function Qr(t){He.forEach(e=>{e.c(t)||(He.delete(e),e.f())}),He.size!==0&&Hn(Qr)}function Vi(t){let e;return He.size===0&&Hn(Qr),{promise:new Promise(n=>{He.add(e={c:t,f:n})}),abort(){He.delete(e)}}}function O(t,e){t.appendChild(e)}function Xr(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Wi(t){const e=F("style");return Hi(Xr(t),e),e.sheet}function Hi(t,e){return O(t.head||t,e),e.sheet}function W(t,e,n){t.insertBefore(e,n||null)}function L(t){t.parentNode&&t.parentNode.removeChild(t)}function F(t){return document.createElement(t)}function Ae(t){return document.createTextNode(t)}function ee(){return Ae(" ")}function Yn(){return Ae("")}function Qe(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function P(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Yi(t){return Array.from(t.childNodes)}function Ye(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function vr(t,e,n){t.classList[n?"add":"remove"](e)}function qr(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}const Ht=new Map;let Yt=0;function Gi(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Qi(t,e){const n={stylesheet:Wi(e),rules:{}};return Ht.set(t,n),n}function yr(t,e,n,r,i,o,a,u=0){const s=16.666/r;let l=`{
`;for(let y=0;y<=1;y+=s){const b=e+(n-e)*o(y);l+=y*100+`%{${a(b,1-b)}}
`}const f=l+`100% {${a(n,1-n)}}
}`,c=`__svelte_${Gi(f)}_${u}`,h=Xr(t),{stylesheet:p,rules:d}=Ht.get(h)||Qi(h,t);d[c]||(d[c]=!0,p.insertRule(`@keyframes ${c} ${f}`,p.cssRules.length));const v=t.style.animation||"";return t.style.animation=`${v?`${v}, `:""}${c} ${r}ms linear ${i}ms 1 both`,Yt+=1,c}function Xi(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),Yt-=i,Yt||qi())}function qi(){Hn(()=>{Yt||(Ht.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&L(e)}),Ht.clear())})}let ft;function ut(t){ft=t}function Jr(){if(!ft)throw new Error("Function called outside component initialization");return ft}function Ji(t){Jr().$$.on_destroy.push(t)}function Gn(){const t=Jr();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=qr(e,n,{cancelable:r});return i.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function Zr(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const it=[],gn=[],Rt=[],mr=[],Zi=Promise.resolve();let _n=!1;function eo(){_n||(_n=!0,Zi.then(ei))}function Xe(t){Rt.push(t)}const sn=new Set;let Ct=0;function ei(){const t=ft;do{for(;Ct<it.length;){const e=it[Ct];Ct++,ut(e),to(e.$$)}for(ut(null),it.length=0,Ct=0;gn.length;)gn.pop()();for(let e=0;e<Rt.length;e+=1){const n=Rt[e];sn.has(n)||(sn.add(n),n())}Rt.length=0}while(it.length);for(;mr.length;)mr.pop()();_n=!1,sn.clear(),ut(t)}function to(t){if(t.fragment!==null){t.update(),Ie(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Xe)}}let rt;function no(){return rt||(rt=Promise.resolve(),rt.then(()=>{rt=null})),rt}function ln(t,e,n){t.dispatchEvent(qr(`${e?"intro":"outro"}${n}`))}const Ot=new Set;let pe;function ti(){pe={r:0,c:[],p:pe}}function ni(){pe.r||Ie(pe.c),pe=pe.p}function H(t,e){t&&t.i&&(Ot.delete(t),t.i(e))}function q(t,e,n,r){if(t&&t.o){if(Ot.has(t))return;Ot.add(t),pe.c.push(()=>{Ot.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const ro={duration:0};function St(t,e,n,r){const i={direction:"both"};let o=e(t,n,i),a=r?0:1,u=null,s=null,l=null;function f(){l&&Xi(t,l)}function c(p,d){const v=p.b-a;return d*=Math.abs(v),{a,b:p.b,d:v,duration:d,start:p.start,end:p.start+d,group:p.group}}function h(p){const{delay:d=0,duration:v=300,easing:y=Wr,tick:b=j,css:E}=o||ro,g={start:Ui()+d,b:p};p||(g.group=pe,pe.r+=1),u||s?s=g:(E&&(f(),l=yr(t,a,p,v,d,y,E)),p&&b(0,1),u=c(g,v),Xe(()=>ln(t,p,"start")),Vi(w=>{if(s&&w>s.start&&(u=c(s,v),s=null,ln(t,u.b,"start"),E&&(f(),l=yr(t,a,u.b,u.duration,0,y,o.css))),u){if(w>=u.end)b(a=u.b,1-a),ln(t,u.b,"end"),s||(u.b?f():--u.group.r||Ie(u.group.c)),u=null;else if(w>=u.start){const m=w-u.start;a=u.a+u.d*y(m/u.duration),b(a,1-a)}}return!!(u||s)}))}return{run(p){Vn(o)?no().then(()=>{o=o(i),h(p)}):h(p)},end(){f(),u=s=null}}}function io(t,e){t.d(1),e.delete(t.key)}function oo(t,e){q(t,1,1,()=>{e.delete(t.key)})}function ri(t,e,n,r,i,o,a,u,s,l,f,c){let h=t.length,p=o.length,d=h;const v={};for(;d--;)v[t[d].key]=d;const y=[],b=new Map,E=new Map;for(d=p;d--;){const _=c(i,o,d),A=n(_);let k=a.get(A);k?r&&k.p(_,e):(k=l(A,_),k.c()),b.set(A,y[d]=k),A in v&&E.set(A,Math.abs(d-v[A]))}const g=new Set,w=new Set;function m(_){H(_,1),_.m(u,f),a.set(_.key,_),f=_.first,p--}for(;h&&p;){const _=y[p-1],A=t[h-1],k=_.key,C=A.key;_===A?(f=_.first,h--,p--):b.has(C)?!a.has(k)||g.has(k)?m(_):w.has(C)?h--:E.get(k)>E.get(C)?(w.add(k),m(_)):(g.add(C),h--):(s(A,a),h--)}for(;h--;){const _=t[h];b.has(_.key)||s(_,a)}for(;p;)m(y[p-1]);return y}function Fe(t){t&&t.c()}function Ce(t,e,n,r){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),r||Xe(()=>{const a=t.$$.on_mount.map(Hr).filter(Vn);t.$$.on_destroy?t.$$.on_destroy.push(...a):Ie(a),t.$$.on_mount=[]}),o.forEach(Xe)}function Se(t,e){const n=t.$$;n.fragment!==null&&(Ie(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ao(t,e){t.$$.dirty[0]===-1&&(it.push(t),eo(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Pe(t,e,n,r,i,o,a,u=[-1]){const s=ft;ut(t);const l=t.$$={fragment:null,ctx:[],props:o,update:j,not_equal:i,bound:dr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:dr(),dirty:u,skip_bound:!1,root:e.target||s.$$.root};a&&a(l.root);let f=!1;if(l.ctx=n?n(t,e.props||{},(c,h,...p)=>{const d=p.length?p[0]:h;return l.ctx&&i(l.ctx[c],l.ctx[c]=d)&&(!l.skip_bound&&l.bound[c]&&l.bound[c](d),f&&ao(t,c)),h}):[],l.update(),f=!0,Ie(l.before_update),l.fragment=r?r(l.ctx):!1,e.target){if(e.hydrate){const c=Yi(e.target);l.fragment&&l.fragment.l(c),c.forEach(L)}else l.fragment&&l.fragment.c();e.intro&&H(t.$$.fragment),Ce(t,e.target,e.anchor,e.customElement),ei()}ut(s)}class Re{$destroy(){Se(this,1),this.$destroy=j}$on(e,n){if(!Vn(n))return j;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!ji(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function uo(t){let e,n,r,i,o,a,u,s;const l=t[5].default,f=Lt(l,t,t[4],null);return{c(){e=F("div"),n=F("div"),r=ee(),i=F("div"),f&&f.c(),P(n,"class","card-front svelte-1enngss"),P(i,"class","card-back svelte-1enngss"),P(e,"data-testid",o="card-"+t[0].type),P(e,"class","card svelte-1enngss"),vr(e,"toggled",t[1])},m(c,h){W(c,e,h),O(e,n),O(e,r),O(e,i),f&&f.m(i,null),a=!0,u||(s=[Qe(e,"click",t[2]),Qe(e,"keyup",t[2])],u=!0)},p(c,[h]){f&&f.p&&(!a||h&16)&&Vt(f,l,c,c[4],a?Ut(l,c[4],h,null):Wt(c[4]),null),(!a||h&1&&o!==(o="card-"+c[0].type))&&P(e,"data-testid",o),(!a||h&2)&&vr(e,"toggled",c[1])},i(c){a||(H(f,c),a=!0)},o(c){q(f,c),a=!1},d(c){c&&L(e),f&&f.d(c),u=!1,Ie(s)}}}function so(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Gn();let{item:a={index:0,type:0,backfaceIsUp:!1}}=e,{flippable:u=!0}=e,{flipped:s=!1}=e;function l(){u&&!s&&o("flip",a)}return t.$$set=f=>{"item"in f&&n(0,a=f.item),"flippable"in f&&n(3,u=f.flippable),"flipped"in f&&n(1,s=f.flipped),"$$scope"in f&&n(4,i=f.$$scope)},[a,s,l,u,i,r]}class lo extends Re{constructor(e){super(),Pe(this,e,so,uo,_e,{item:0,flippable:3,flipped:1})}}const Le=[];function co(t,e=j){let n;const r=new Set;function i(u){if(_e(t,u)&&(t=u,n)){const s=!Le.length;for(const l of r)l[1](),Le.push(l,t);if(s){for(let l=0;l<Le.length;l+=2)Le[l][0](Le[l+1]);Le.length=0}}}function o(u){i(u(t))}function a(u,s=j){const l=[u,s];return r.add(l),r.size===1&&(n=e(i)||j),u(t),()=>{r.delete(l),r.size===0&&(n(),n=null)}}return{set:i,update:o,subscribe:a}}const Mt=co(0);function gr(t,e,n){const r=t.slice();return r[11]=e[n],r[13]=n,r}function fo(t){let e=t[11].type.toString()+"",n,r;return{c(){n=Ae(e),r=ee()},m(i,o){W(i,n,o),W(i,r,o)},p(i,o){o&1&&e!==(e=i[11].type.toString()+"")&&Ye(n,e)},d(i){i&&L(n),i&&L(r)}}}function _r(t,e){let n,r,i;return r=new lo({props:{item:e[11],flipped:e[11].backfaceIsUp,flippable:e[1].length<2,$$slots:{default:[fo]},$$scope:{ctx:e}}}),r.$on("flip",e[2]),{key:t,first:null,c(){n=Yn(),Fe(r.$$.fragment),this.first=n},m(o,a){W(o,n,a),Ce(r,o,a),i=!0},p(o,a){e=o;const u={};a&1&&(u.item=e[11]),a&1&&(u.flipped=e[11].backfaceIsUp),a&2&&(u.flippable=e[1].length<2),a&33&&(u.$$scope={dirty:a,ctx:e}),r.$set(u)},i(o){i||(H(r.$$.fragment,o),i=!0)},o(o){q(r.$$.fragment,o),i=!1},d(o){o&&L(n),Se(r,o)}}}function ho(t){let e,n,r=[],i=new Map,o,a,u,s=t[0];const l=h=>h[13];for(let h=0;h<s.length;h+=1){let p=gr(t,s,h),d=l(p);i.set(d,r[h]=_r(d,p))}const f=t[4].default,c=Lt(f,t,t[5],null);return{c(){e=F("div"),n=F("div");for(let h=0;h<r.length;h+=1)r[h].c();o=ee(),a=F("div"),c&&c.c(),P(n,"class","full-grid disable-text-selection svelte-1zhk37"),P(a,"class","footer-bar svelte-1zhk37")},m(h,p){W(h,e,p),O(e,n);for(let d=0;d<r.length;d+=1)r[d].m(n,null);O(e,o),O(e,a),c&&c.m(a,null),u=!0},p(h,[p]){p&7&&(s=h[0],ti(),r=ri(r,p,l,1,h,s,i,n,oo,_r,null,gr),ni()),c&&c.p&&(!u||p&32)&&Vt(c,f,h,h[5],u?Ut(f,h[5],p,null):Wt(h[5]),null)},i(h){if(!u){for(let p=0;p<s.length;p+=1)H(r[p]);H(c,h),u=!0}},o(h){for(let p=0;p<r.length;p+=1)q(r[p]);q(c,h),u=!1},d(h){h&&L(e);for(let p=0;p<r.length;p+=1)r[p].d();c&&c.d(h)}}}function cn(t,...e){return new Promise(n=>setTimeout(n,t,...e))}function po(t,e,n){let r;Wn(t,Mt,d=>n(6,r=d));let{$$slots:i={},$$scope:o}=e,{puzzle:a=[]}=e,{onCompleted:u}=e,s=[];function l(d){d.backfaceIsUp=!1,n(0,a)}function f(){a.length===a.filter(v=>v.backfaceIsUp).length&&cn(300).then(()=>{u(r),pr(Mt,r=0,r)})}function c(){const d=[cn(600,s[1]).then(l),cn(800,s[0]).then(l)];Promise.all(d).then(()=>n(1,s=[]))}function h(){return s[0].type===s[1].type}function p(d){const v=d.detail;n(0,a[v.index].backfaceIsUp=!a[v.index].backfaceIsUp,a),n(1,s=[...s,v]),s.length>=2&&(pr(Mt,r++,r),h()?(n(1,s=[]),f()):c())}return t.$$set=d=>{"puzzle"in d&&n(0,a=d.puzzle),"onCompleted"in d&&n(3,u=d.onCompleted),"$$scope"in d&&n(5,o=d.$$scope)},[a,s,p,u,i,o]}class vo extends Re{constructor(e){super(),Pe(this,e,po,ho,_e,{puzzle:0,onCompleted:3})}}function yo(t){let e,n,r;return{c(){e=F("button"),e.innerHTML=`<span class="icon svelte-glkhk4"><svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline></svg></span>
  Records`,P(e,"class","button")},m(i,o){W(i,e,o),n||(r=Qe(e,"click",t[0]),n=!0)},p:j,i:j,o:j,d(i){i&&L(e),n=!1,r()}}}function mo(t){function e(n){Zr.call(this,t,n)}return[e]}class go extends Re{constructor(e){super(),Pe(this,e,mo,yo,_e,{})}}function _o(t){const e=t-1;return e*e*e+1}function br(t){return--t*t*t*t*t+1}function wr(t){return-.5*(Math.cos(Math.PI*t)-1)}function Er(t,{delay:e=0,duration:n=400,easing:r=Wr}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:o=>`opacity: ${o*i}`}}function kr(t,{delay:e=0,duration:n=400,easing:r=_o}={}){const i=getComputedStyle(t),o=+i.opacity,a=parseFloat(i.height),u=parseFloat(i.paddingTop),s=parseFloat(i.paddingBottom),l=parseFloat(i.marginTop),f=parseFloat(i.marginBottom),c=parseFloat(i.borderTopWidth),h=parseFloat(i.borderBottomWidth);return{delay:e,duration:n,easing:r,css:p=>`overflow: hidden;opacity: ${Math.min(p*20,1)*o};height: ${p*a}px;padding-top: ${p*u}px;padding-bottom: ${p*s}px;margin-top: ${p*l}px;margin-bottom: ${p*f}px;border-top-width: ${p*c}px;border-bottom-width: ${p*h}px;`}}const bo=t=>({}),xr=t=>({}),wo=t=>({}),Ar=t=>({});function Eo(t){let e,n,r,i,o,a,u,s,l,f;const c=t[4].header,h=Lt(c,t,t[3],Ar),p=t[4].content,d=Lt(p,t,t[3],xr);return{c(){e=F("div"),n=F("div"),i=ee(),o=F("div"),h&&h.c(),a=ee(),d&&d.c(),P(n,"class","modal-backdrop svelte-1hm6iu8"),P(o,"class","modal svelte-1hm6iu8"),P(o,"role","dialog"),P(o,"aria-modal","true"),P(e,"class","modal-overlay svelte-1hm6iu8")},m(v,y){W(v,e,y),O(e,n),O(e,i),O(e,o),h&&h.m(o,null),O(o,a),d&&d.m(o,null),t[5](o),s=!0,l||(f=[Qe(window,"keydown",t[2]),Qe(n,"pointerdown",t[1])],l=!0)},p(v,[y]){t=v,h&&h.p&&(!s||y&8)&&Vt(h,c,t,t[3],s?Ut(c,t[3],y,wo):Wt(t[3]),Ar),d&&d.p&&(!s||y&8)&&Vt(d,p,t,t[3],s?Ut(p,t[3],y,bo):Wt(t[3]),xr)},i(v){s||(Xe(()=>{r||(r=St(n,Er,{duration:600,easing:wr},!0)),r.run(1)}),H(h,v),H(d,v),Xe(()=>{u||(u=St(o,kr,{duration:600,easing:br},!0)),u.run(1)}),s=!0)},o(v){r||(r=St(n,Er,{duration:600,easing:wr},!1)),r.run(0),q(h,v),q(d,v),u||(u=St(o,kr,{duration:600,easing:br},!1)),u.run(0),s=!1},d(v){v&&L(e),v&&r&&r.end(),h&&h.d(v),d&&d.d(v),t[5](null),v&&u&&u.end(),l=!1,Ie(f)}}}function ko(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Gn(),a=()=>o("close");let u;const s=c=>{if(c.key==="Escape"){a();return}if(c.key==="Tab"){const h=u.querySelectorAll("*"),p=Array.from(h).filter(v=>v.tabIndex>=0);let d=p.indexOf(document.activeElement);d===-1&&c.shiftKey&&(d=0),d+=p.length+(c.shiftKey?-1:1),d%=p.length,p[d].focus(),c.preventDefault()}},l=typeof document<"u"&&document.activeElement;l&&Ji(()=>{l.focus()});function f(c){gn[c?"unshift":"push"](()=>{u=c,n(0,u)})}return t.$$set=c=>{"$$scope"in c&&n(3,i=c.$$scope)},[u,a,s,i,r,f]}class xo extends Re{constructor(e){super(),Pe(this,e,ko,Eo,_e,{})}}const Ao=(t,e)=>t.reduce((n,r,i,o,a=r[e])=>((n[a]||(n[a]=[])).push(r),n),{});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var I=function(){return I=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},I.apply(this,arguments)};function bn(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var z=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,U=Object.keys,Q=Array.isArray;typeof Promise<"u"&&!z.Promise&&(z.Promise=Promise);function J(t,e){return typeof e!="object"||U(e).forEach(function(n){t[n]=e[n]}),t}var ht=Object.getPrototypeOf,Co={}.hasOwnProperty;function te(t,e){return Co.call(t,e)}function qe(t,e){typeof e=="function"&&(e=e(ht(t))),(typeof Reflect>"u"?U:Reflect.ownKeys)(e).forEach(function(n){me(t,n,e[n])})}var ii=Object.defineProperty;function me(t,e,n,r){ii(t,e,J(n&&te(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Je(t){return{from:function(e){return t.prototype=Object.create(e.prototype),me(t.prototype,"constructor",t),{extend:qe.bind(null,t.prototype)}}}}var So=Object.getOwnPropertyDescriptor;function Qn(t,e){var n=So(t,e),r;return n||(r=ht(t))&&Qn(r,e)}var Ko=[].slice;function rn(t,e,n){return Ko.call(t,e,n)}function oi(t,e){return e(t)}function ot(t){if(!t)throw new Error("Assertion Failed")}function ai(t){z.setImmediate?setImmediate(t):setTimeout(t,0)}function ui(t,e){return t.reduce(function(n,r,i){var o=e(r,i);return o&&(n[o[0]]=o[1]),n},{})}function Do(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function ye(t,e){if(te(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,i=e.length;r<i;++r){var o=ye(t,e[r]);n.push(o)}return n}var a=e.indexOf(".");if(a!==-1){var u=t[e.substr(0,a)];return u===void 0?void 0:ye(u,e.substr(a+1))}}function ae(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){ot(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)ae(t,e[r],n[r])}else{var o=e.indexOf(".");if(o!==-1){var a=e.substr(0,o),u=e.substr(o+1);if(u==="")n===void 0?Q(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var s=t[a];(!s||!te(t,a))&&(s=t[a]={}),ae(s,u,n)}}else n===void 0?Q(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function To(t,e){typeof e=="string"?ae(t,e,void 0):"length"in e&&[].map.call(e,function(n){ae(t,n,void 0)})}function si(t){var e={};for(var n in t)te(t,n)&&(e[n]=t[n]);return e}var Io=[].concat;function li(t){return Io.apply([],t)}var ci="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(li([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return z[t]}),Po=ci.map(function(t){return z[t]});ui(ci,function(t){return[t,!0]});var ke=null;function _t(t){ke=typeof WeakMap<"u"&&new WeakMap;var e=wn(t);return ke=null,e}function wn(t){if(!t||typeof t!="object")return t;var e=ke&&ke.get(t);if(e)return e;if(Q(t)){e=[],ke&&ke.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(wn(t[n]))}else if(Po.indexOf(t.constructor)>=0)e=t;else{var i=ht(t);e=i===Object.prototype?{}:Object.create(i),ke&&ke.set(t,e);for(var o in t)te(t,o)&&(e[o]=wn(t[o]))}return e}var Ro={}.toString;function En(t){return Ro.call(t).slice(8,-1)}var kn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Oo=typeof kn=="symbol"?function(t){var e;return t!=null&&(e=t[kn])&&e.apply(t)}:function(){return null},We={};function de(t){var e,n,r,i;if(arguments.length===1){if(Q(t))return t.slice();if(this===We&&typeof t=="string")return[t];if(i=Oo(t)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var Xn=typeof Symbol<"u"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ce=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function fi(t,e){ce=t,hi=e}var hi=function(){return!0},Mo=!new Error("").stack;function je(){if(Mo)try{throw je.arguments,new Error}catch(t){return t}return new Error}function xn(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(hi).map(function(r){return`
`+r}).join("")):""}var Bo=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],di=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],qn=Bo.concat(di),$o={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ze(t,e){this._e=je(),this.name=t,this.message=e}Je(Ze).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+xn(this._e,2))}},toString:function(){return this.name+": "+this.message}});function pi(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function Gt(t,e,n,r){this._e=je(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=pi(t,e)}Je(Gt).from(Ze);function st(t,e){this._e=je(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=pi(t,e)}Je(st).from(Ze);var Jn=qn.reduce(function(t,e){return t[e]=e+"Error",t},{}),Fo=Ze,K=qn.reduce(function(t,e){var n=e+"Error";function r(i,o){this._e=je(),this.name=n,i?typeof i=="string"?(this.message=""+i+(o?`
 `+o:""),this.inner=o||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=$o[e]||n,this.inner=null)}return Je(r).from(Fo),t[e]=r,t},{});K.Syntax=SyntaxError;K.Type=TypeError;K.Range=RangeError;var Cr=di.reduce(function(t,e){return t[e+"Error"]=K[e],t},{});function zo(t,e){if(!t||t instanceof Ze||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Cr[t.name])return t;var n=new Cr[t.name](e||t.message,t);return"stack"in t&&me(n,"stack",{get:function(){return this.inner.stack}}),n}var on=qn.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=K[e]),t},{});on.ModifyError=Gt;on.DexieError=Ze;on.BulkError=st;function $(){}function bt(t){return t}function No(t,e){return t==null||t===bt?e:function(n){return e(t(n))}}function ze(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function jo(t,e){return t===$?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ze(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ze(i,this.onerror):i),o!==void 0?o:n}}function Lo(t,e){return t===$?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ze(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ze(r,this.onerror):r)}}function Uo(t,e){return t===$?e:function(n){var r=t.apply(this,arguments);J(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ze(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ze(o,this.onerror):o),r===void 0?a===void 0?void 0:a:J(r,a)}}function Vo(t,e){return t===$?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function Zn(t,e){return t===$?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return e.apply(r,o)})}return e.apply(this,arguments)}}var dt={},Wo=100,Ho=20,vi=100,er=typeof Promise>"u"?[]:function(){var t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,ht(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,ht(e),t]}(),An=er[0],Qt=er[1],Cn=er[2],yi=Qt&&Qt.then,Bt=An&&An.constructor,tr=!!Cn,Sn=!1,Yo=Cn?function(){Cn.then(Kt)}:z.setImmediate?setImmediate.bind(null,Kt):z.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){Kt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Kt,0)},pt=function(t,e){at.push([t,e]),Xt&&(Yo(),Xt=!1)},Kn=!0,Xt=!0,Be=[],$t=[],Dn=null,Tn=bt,Ge={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Dr,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{Dr(t[0],t[1])}catch{}})}},S=Ge,at=[],$e=0,Ft=[];function x(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=$,this._lib=!1;var e=this._PSD=S;if(ce&&(this._stackHolder=je(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==dt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Pn(this,this._value);return}this._state=null,this._value=null,++e.ref,gi(this,t)}var In={get:function(){var t=S,e=qt;function n(r,i){var o=this,a=!t.global&&(t!==S||e!==qt),u=a&&!ge(),s=new x(function(l,f){nr(o,new mi(Zt(r,t,a,u),Zt(i,t,a,u),l,f,t))});return ce&&wi(s,this),s}return n.prototype=dt,n},set:function(t){me(this,"then",t&&t.prototype===dt?In:{get:function(){return t},set:In.set})}};qe(x.prototype,{then:In,_then:function(t,e){nr(this,new mi(null,null,t,e,S))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,function(r){return r instanceof e?n(r):zt(r)}):this.then(null,function(r){return r&&r.name===e?n(r):zt(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),zt(e)})},stack:{get:function(){if(this._stack)return this._stack;try{Sn=!0;var t=bi(this,[],Ho),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Sn=!1}}},timeout:function(t,e){var n=this;return t<1/0?new x(function(r,i){var o=setTimeout(function(){return i(new K.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&me(x.prototype,Symbol.toStringTag,"Dexie.Promise");Ge.env=Ei();function mi(t,e,n,r,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=i}qe(x,{all:function(){var t=de.apply(null,arguments).map(Jt);return new x(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(i,o){return x.resolve(i).then(function(a){t[o]=a,--r||e(t)},n)})})},resolve:function(t){if(t instanceof x)return t;if(t&&typeof t.then=="function")return new x(function(n,r){t.then(n,r)});var e=new x(dt,!0,t);return wi(e,Dn),e},reject:zt,race:function(){var t=de.apply(null,arguments).map(Jt);return new x(function(e,n){t.map(function(r){return x.resolve(r).then(e,n)})})},PSD:{get:function(){return S},set:function(t){return S=t}},totalEchoes:{get:function(){return qt}},newPSD:Ke,usePSD:tt,scheduler:{get:function(){return pt},set:function(t){pt=t}},rejectionMapper:{get:function(){return Tn},set:function(t){Tn=t}},follow:function(t,e){return new x(function(n,r){return Ke(function(i,o){var a=S;a.unhandleds=[],a.onunhandled=o,a.finalize=ze(function(){var u=this;Qo(function(){u.unhandleds.length===0?i():o(u.unhandleds[0])})},a.finalize),t()},e,n,r)})}});Bt&&(Bt.allSettled&&me(x,"allSettled",function(){var t=de.apply(null,arguments).map(Jt);return new x(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(i,o){return x.resolve(i).then(function(a){return r[o]={status:"fulfilled",value:a}},function(a){return r[o]={status:"rejected",reason:a}}).then(function(){return--n||e(r)})})})}),Bt.any&&typeof AggregateError<"u"&&me(x,"any",function(){var t=de.apply(null,arguments).map(Jt);return new x(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,i=new Array(r);t.forEach(function(o,a){return x.resolve(o).then(function(u){return e(u)},function(u){i[a]=u,--r||n(new AggregateError(i))})})})}));function gi(t,e){try{e(function(n){if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&wt();n&&typeof n.then=="function"?gi(t,function(i,o){n instanceof x?n._then(i,o):n.then(i,o)}):(t._state=!0,t._value=n,_i(t)),r&&Et()}},Pn.bind(null,t))}catch(n){Pn(t,n)}}function Pn(t,e){if($t.push(e),t._state===null){var n=t._lib&&wt();e=Tn(e),t._state=!1,t._value=e,ce&&e!==null&&typeof e=="object"&&!e._promise&&Do(function(){var r=Qn(e,"stack");e._promise=t,me(e,"stack",{get:function(){return Sn?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),Xo(t),_i(t),n&&Et()}}function _i(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)nr(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),$e===0&&(++$e,pt(function(){--$e===0&&rr()},[]))}function nr(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++$e,pt(Go,[n,t,e])}function Go(t,e,n){try{Dn=e;var r,i=e._value;e._state?r=t(i):($t.length&&($t=[]),r=t(i),$t.indexOf(i)===-1&&qo(e)),n.resolve(r)}catch(o){n.reject(o)}finally{Dn=null,--$e===0&&rr(),--n.psd.ref||n.psd.finalize()}}function bi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var i=t._value,o,a;i!=null?(o=i.name||"Error",a=i.message||i,r=xn(i,0)):(o=i,a=""),e.push(o+(a?": "+a:"")+r)}return ce&&(r=xn(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&bi(t._prev,e,n)),e}function wi(t,e){var n=e?e._numPrev+1:0;n<Wo&&(t._prev=e,t._numPrev=n)}function Kt(){wt()&&Et()}function wt(){var t=Kn;return Kn=!1,Xt=!1,t}function Et(){var t,e,n;do for(;at.length>0;)for(t=at,at=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(at.length>0);Kn=!0,Xt=!0}function rr(){var t=Be;Be=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=Ft.slice(0),n=e.length;n;)e[--n]()}function Qo(t){function e(){t(),Ft.splice(Ft.indexOf(e),1)}Ft.push(e),++$e,pt(function(){--$e===0&&rr()},[])}function Xo(t){Be.some(function(e){return e._value===t._value})||Be.push(t)}function qo(t){for(var e=Be.length;e;)if(Be[--e]._value===t._value){Be.splice(e,1);return}}function zt(t){return new x(dt,!1,t)}function N(t,e){var n=S;return function(){var r=wt(),i=S;try{return De(n,!0),t.apply(this,arguments)}catch(o){e&&e(o)}finally{De(i,!1),r&&Et()}}}var G={awaits:0,echoes:0,id:0},Jo=0,Nt=[],fn=0,qt=0,Zo=0;function Ke(t,e,n,r){var i=S,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Zo;var a=Ge.env;o.env=tr?{Promise:x,PromiseProp:{value:x,configurable:!0,writable:!0},all:x.all,race:x.race,allSettled:x.allSettled,any:x.any,resolve:x.resolve,reject:x.reject,nthen:Sr(a.nthen,o),gthen:Sr(a.gthen,o)}:{},e&&J(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=tt(o,t,n,r);return o.ref===0&&o.finalize(),u}function et(){return G.id||(G.id=++Jo),++G.awaits,G.echoes+=vi,G.id}function ge(){return G.awaits?(--G.awaits===0&&(G.id=0),G.echoes=G.awaits*vi,!0):!1}(""+yi).indexOf("[native code]")===-1&&(et=ge=$);function Jt(t){return G.echoes&&t&&t.constructor===Bt?(et(),t.then(function(e){return ge(),e},function(e){return ge(),V(e)})):t}function ea(t){++qt,(!G.echoes||--G.echoes===0)&&(G.echoes=G.id=0),Nt.push(S),De(t,!0)}function ta(){var t=Nt[Nt.length-1];Nt.pop(),De(t,!1)}function De(t,e){var n=S;if((e?G.echoes&&(!fn++||t!==S):fn&&(!--fn||t!==S))&&ki(e?ea.bind(null,t):ta),t!==S&&(S=t,n===Ge&&(Ge.env=Ei()),tr)){var r=Ge.env.Promise,i=t.env;Qt.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(z,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Ei(){var t=z.Promise;return tr?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(z,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Qt.then,gthen:t.prototype.then}:{}}function tt(t,e,n,r,i){var o=S;try{return De(t,!0),e(n,r,i)}finally{De(o,!1)}}function ki(t){yi.call(An,t)}function Zt(t,e,n,r){return typeof t!="function"?t:function(){var i=S;n&&et(),De(e,!0);try{return t.apply(this,arguments)}finally{De(i,!1),r&&ki(ge)}}}function Sr(t,e){return function(n,r){return t.call(this,Zt(n,e),Zt(r,e))}}var Kr="unhandledrejection";function Dr(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,i={promise:e,reason:t};if(z.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Kr,!0,!0),J(r,i)):z.CustomEvent&&(r=new CustomEvent(Kr,{detail:i}),J(r,i)),r&&z.dispatchEvent&&(dispatchEvent(r),!z.PromiseRejectionEvent&&z.onunhandledrejection))try{z.onunhandledrejection(r)}catch{}ce&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var V=x.reject;function Rn(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!S.letThrough&&!t._vip){if(t._state.openComplete)return V(new K.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return V(new K.DatabaseClosed);t.open().catch($)}return t._state.dbReadyPromise.then(function(){return Rn(t,e,n,r)})}else{var i=t._createTransaction(e,n,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(o){return o.name===Jn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Rn(t,e,n,r)})):V(o)}return i._promise(e,function(o,a){return Ke(function(){return S.trans=i,r(o,a,i)})}).then(function(o){return i._completion.then(function(){return o})})}}var Tr="3.2.2",Me=String.fromCharCode(65535),On=-1/0,fe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",xi="String expected.",lt=[],an=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),na=an,ra=an,Ai=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},un="__dbnames",hn="readonly",dn="readwrite";function Ne(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var Ci={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Dt(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=_t(e),delete e[t]),e}:function(e){return e}}var ia=function(){function t(){}return t.prototype._trans=function(e,n,r){var i=this._tx||S.trans,o=this.name;function a(s,l,f){if(!f.schema[o])throw new K.NotFound("Table "+o+" not part of transaction");return n(f.idbtrans,f)}var u=wt();try{return i&&i.db===this.db?i===S.trans?i._promise(e,a,r):Ke(function(){return i._promise(e,a,r)},{trans:i,transless:S.transless||S}):Rn(this.db,e,[this.name],a)}finally{u&&Et()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(o){return r.hook.reading.fire(o)})}).then(n)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(Q(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=U(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(f){return f.compound&&n.every(function(c){return f.keyPath.indexOf(c)>=0})&&f.keyPath.every(function(c){return n.indexOf(c)>=0})})[0];if(r&&this.db._maxKey!==Me)return this.where(r.name).equals(r.keyPath.map(function(f){return e[f]}));!r&&ce&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,o=this.db._deps.indexedDB;function a(f,c){try{return o.cmp(f,c)===0}catch{return!1}}var u=n.reduce(function(f,c){var h=f[0],p=f[1],d=i[c],v=e[c];return[h||d,h||!d?Ne(p,d&&d.multi?function(y){var b=ye(y,c);return Q(b)&&b.some(function(E){return a(v,E)})}:function(y){return a(v,ye(y,c))}):p]},[null,null]),s=u[0],l=u[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,Q(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var i=Object.create(e.prototype);for(var o in r)if(te(r,o))try{i[o]=r[o]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){function e(n){J(this,n)}return this.mapToClass(e)},t.prototype.add=function(e,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,u=e;return a&&o&&(u=Dt(a)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(a)try{ae(e,a,s)}catch{}return s})},t.prototype.update=function(e,n){if(typeof e=="object"&&!Q(e)){var r=ye(e,this.schema.primKey.keyPath);if(r===void 0)return V(new K.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?U(n).forEach(function(i){ae(e,i,n[i])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)},t.prototype.put=function(e,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,u=e;return a&&o&&(u=Dt(a)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(a)try{ae(e,a,s)}catch{}return s})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?x.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:Ci})}).then(function(n){return n.numFailures?x.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(o){return n.hook.reading.fire(o)})})})},t.prototype.bulkAdd=function(e,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var a=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,f=s.keyPath;if(f&&o)throw new K.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,h=f&&l?e.map(Dt(f)):e;return i.core.mutate({trans:u,type:"add",keys:o,values:h,wantResults:a}).then(function(p){var d=p.numFailures,v=p.results,y=p.lastResult,b=p.failures,E=a?v:y;if(d===0)return E;throw new st(i.name+".bulkAdd(): "+d+" of "+c+" operations failed",b)})})},t.prototype.bulkPut=function(e,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var a=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,f=s.keyPath;if(f&&o)throw new K.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,h=f&&l?e.map(Dt(f)):e;return i.core.mutate({trans:u,type:"put",keys:o,values:h,wantResults:a}).then(function(p){var d=p.numFailures,v=p.results,y=p.lastResult,b=p.failures,E=a?v:y;if(d===0)return E;throw new st(i.name+".bulkPut(): "+d+" of "+c+" operations failed",b)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var o=i.numFailures,a=i.lastResult,u=i.failures;if(o===0)return a;throw new st(n.name+".bulkDelete(): "+o+" of "+r+" operations failed",u)})},t}();function kt(t){var e={},n=function(u,s){if(s){for(var l=arguments.length,f=new Array(l-1);--l;)f[l-1]=arguments[l];return e[u].subscribe.apply(null,f),t}else if(typeof u=="string")return e[u]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(u,s,l){if(typeof u=="object")return a(u);s||(s=Vo),l||(l=$);var f={subscribers:[],fire:l,subscribe:function(c){f.subscribers.indexOf(c)===-1&&(f.subscribers.push(c),f.fire=s(f.fire,c))},unsubscribe:function(c){f.subscribers=f.subscribers.filter(function(h){return h!==c}),f.fire=f.subscribers.reduce(s,l)}};return e[u]=n[u]=f,f}function a(u){U(u).forEach(function(s){var l=u[s];if(Q(l))o(s,u[s][0],u[s][1]);else if(l==="asap")var f=o(s,bt,function(){for(var h=arguments.length,p=new Array(h);h--;)p[h]=arguments[h];f.subscribers.forEach(function(d){ai(function(){d.apply(null,p)})})});else throw new K.InvalidArgument("Invalid event config")})}}function xt(t,e){return Je(e).from({prototype:t}),e}function oa(t){return xt(ia.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:kt(null,{creating:[jo,$],reading:[No,bt],updating:[Uo,$],deleting:[Lo,$]})})}function Ue(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function pn(t,e){t.filter=Ne(t.filter,e)}function vn(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Ne(r(),e())}:e,t.justLimit=n&&!r}function aa(t,e){t.isMatch=Ne(t.isMatch,e)}function jt(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new K.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Ir(t,e,n){var r=jt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Tt(t,e,n,r){var i=t.replayFilter?Ne(t.filter,t.replayFilter()):t.filter;if(t.or){var o={},a=function(u,s,l){if(!i||i(s,l,function(h){return s.stop(h)},function(h){return s.fail(h)})){var f=s.primaryKey,c=""+f;c==="[object ArrayBuffer]"&&(c=""+new Uint8Array(f)),te(o,c)||(o[c]=!0,e(u,s,l))}};return Promise.all([t.or._iterate(a,n),Pr(Ir(t,r,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}else return Pr(Ir(t,r,n),Ne(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function Pr(t,e,n,r){var i=r?function(a,u,s){return n(r(a),u,s)}:n,o=N(i);return t.then(function(a){if(a)return a.start(function(){var u=function(){return a.continue()};(!e||e(a,function(s){return u=s},function(s){a.stop(s),u=$},function(s){a.fail(s),u=$}))&&o(a.value,a,function(s){return u=s}),u()})})}function X(t,e){try{var n=Rr(t),r=Rr(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return sa(Or(t),Or(e));case"Array":return ua(t,e)}}catch{}return NaN}function ua(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,o=0;o<i;++o){var a=X(t[o],e[o]);if(a!==0)return a}return n===r?0:n<r?-1:1}function sa(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,o=0;o<i;++o)if(t[o]!==e[o])return t[o]<e[o]?-1:1;return n===r?0:n<r?-1:1}function Rr(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var n=En(t);return n==="ArrayBuffer"?"binary":n}function Or(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var la=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,V.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,V.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Ne(n.algorithm,e)},t.prototype._iterate=function(e,n){return Tt(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&J(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return Tt(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var i=n._ctx,o=i.table.core;if(Ue(i,!0))return o.count({trans:r,query:{index:jt(i,o.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var a=0;return Tt(i,function(){return++a,!1},r,o).then(function(){return a})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),i=r[0],o=r.length-1;function a(l,f){return f?a(l[r[f]],f-1):l[i]}var u=this._ctx.dir==="next"?1:-1;function s(l,f){var c=a(l,o),h=a(f,o);return c<h?-u:c>h?u:0}return this.toArray(function(l){return l.sort(s)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ue(i,!0)&&i.limit>0){var o=i.valueMapper,a=jt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:a,range:i.range}}).then(function(s){var l=s.result;return o?l.map(o):l})}else{var u=[];return Tt(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Ue(n)?vn(n,function(){var r=e;return function(i,o){return r===0?!0:r===1?(--r,!1):(o(function(){i.advance(r),r=0}),!1)}}):vn(n,function(){var r=e;return function(){return--r<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),vn(this._ctx,function(){var n=e;return function(r,i,o){return--n<=0&&i(o),n>=0}},!0),this},t.prototype.until=function(e,n){return pn(this._ctx,function(r,i,o){return e(r.value)?(i(o),n):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return pn(this._ctx,function(n){return e(n.value)}),aa(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&Ue(n,!0)&&n.limit>0)return this._read(function(i){var o=jt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:o,range:n.range}})}).then(function(i){var o=i.result;return o}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return pn(this._ctx,function(i){var o=i.primaryKey.toString(),a=te(r,o);return r[o]=!0,!a}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(i){var o;if(typeof e=="function")o=e;else{var a=U(e),u=a.length;o=function(b){for(var E=!1,g=0;g<u;++g){var w=a[g],m=e[w];ye(b,w)!==m&&(ae(b,w,m),E=!0)}return E}}var s=r.table.core,l=s.schema.primaryKey,f=l.outbound,c=l.extractKey,h=n.db._options.modifyChunkSize||200,p=[],d=0,v=[],y=function(b,E){var g=E.failures,w=E.numFailures;d+=b-w;for(var m=0,_=U(g);m<_.length;m++){var A=_[m];p.push(g[A])}};return n.clone().primaryKeys().then(function(b){var E=function(g){var w=Math.min(h,b.length-g);return s.getMany({trans:i,keys:b.slice(g,g+w),cache:"immutable"}).then(function(m){for(var _=[],A=[],k=f?[]:null,C=[],D=0;D<w;++D){var M=m[D],B={value:_t(M),primKey:b[g+D]};o.call(B,B.value,B)!==!1&&(B.value==null?C.push(b[g+D]):!f&&X(c(M),c(B.value))!==0?(C.push(b[g+D]),_.push(B.value)):(A.push(B.value),f&&k.push(b[g+D])))}var R=Ue(r)&&r.limit===1/0&&(typeof e!="function"||e===yn)&&{index:r.index,range:r.range};return Promise.resolve(_.length>0&&s.mutate({trans:i,type:"add",values:_}).then(function(Y){for(var T in Y.failures)C.splice(parseInt(T),1);y(_.length,Y)})).then(function(){return(A.length>0||R&&typeof e=="object")&&s.mutate({trans:i,type:"put",keys:k,values:A,criteria:R,changeSpec:typeof e!="function"&&e}).then(function(Y){return y(A.length,Y)})}).then(function(){return(C.length>0||R&&e===yn)&&s.mutate({trans:i,type:"delete",keys:C,criteria:R}).then(function(Y){return y(C.length,Y)})}).then(function(){return b.length>g+w&&E(g+h)})})};return E(0).then(function(){if(p.length>0)throw new Gt("Error modifying one or more objects",p,d,v);return b.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return Ue(e)&&(e.isPrimKey&&!ra||n.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,o=n;return e.table.core.count({trans:r,query:{index:i,range:o}}).then(function(a){return e.table.core.mutate({trans:r,type:"deleteRange",range:o}).then(function(u){var s=u.failures;u.lastResult,u.results;var l=u.numFailures;if(l)throw new Gt("Could not delete some values",Object.keys(s).map(function(f){return s[f]}),a-l);return a-l})})}):this.modify(yn)},t}(),yn=function(t,e){return e.value=null};function ca(t){return xt(la.prototype,function(n,r){this.db=t;var i=Ci,o=null;if(r)try{i=r()}catch(l){o=l}var a=n._ctx,u=a.table,s=u.hook.reading.fire;this._ctx={table:u,index:a.index,isPrimKey:!a.index||u.schema.primKey.keyPath&&a.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:a.or,valueMapper:s!==bt?s:null}})}function fa(t,e){return t<e?-1:t===e?0:1}function ha(t,e){return t>e?-1:t===e?0:1}function Z(t,e,n){var r=t instanceof Ki?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Ve(t){return new t.Collection(t,function(){return Si("")}).limit(0)}function da(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function pa(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function va(t,e,n,r,i,o){for(var a=Math.min(t.length,r.length),u=-1,s=0;s<a;++s){var l=e[s];if(l!==r[s])return i(t[s],n[s])<0?t.substr(0,s)+n[s]+n.substr(s+1):i(t[s],r[s])<0?t.substr(0,s)+r[s]+n.substr(s+1):u>=0?t.substr(0,u)+e[u]+n.substr(u+1):null;i(t[s],l)<0&&(u=s)}return a<r.length&&o==="next"?t+n.substr(t.length):a<t.length&&o==="prev"?t.substr(0,n.length):u<0?null:t.substr(0,u)+r[u]+n.substr(u+1)}function It(t,e,n,r){var i,o,a,u,s,l,f,c=n.length;if(!n.every(function(v){return typeof v=="string"}))return Z(t,xi);function h(v){i=da(v),o=pa(v),a=v==="next"?fa:ha;var y=n.map(function(b){return{lower:o(b),upper:i(b)}}).sort(function(b,E){return a(b.lower,E.lower)});u=y.map(function(b){return b.upper}),s=y.map(function(b){return b.lower}),l=v,f=v==="next"?"":r}h("next");var p=new t.Collection(t,function(){return Ee(u[0],s[c-1]+r)});p._ondirectionchange=function(v){h(v)};var d=0;return p._addAlgorithm(function(v,y,b){var E=v.key;if(typeof E!="string")return!1;var g=o(E);if(e(g,s,d))return!0;for(var w=null,m=d;m<c;++m){var _=va(E,g,u[m],s[m],a,l);_===null&&w===null?d=m+1:(w===null||a(w,_)>0)&&(w=_)}return y(w!==null?function(){v.continue(w+f)}:b),!1}),p}function Ee(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Si(t){return{type:1,lower:t,upper:t}}var Ki=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||i)&&!(r&&i)?Ve(this):new this.Collection(this,function(){return Ee(e,n,!r,!i)})}catch{return Z(this,fe)}},t.prototype.equals=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return Si(e)})},t.prototype.above=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return Ee(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return Ee(e,void 0,!1)})},t.prototype.below=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return Ee(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?Z(this,fe):new this.Collection(this,function(){return Ee(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?Z(this,xi):this.between(e,e+Me,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):It(this,function(n,r){return n.indexOf(r[0])===0},[e],Me)},t.prototype.equalsIgnoreCase=function(e){return It(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=de.apply(We,arguments);return e.length===0?Ve(this):It(this,function(n,r){return r.indexOf(n)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=de.apply(We,arguments);return e.length===0?Ve(this):It(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},e,Me)},t.prototype.anyOf=function(){var e=this,n=de.apply(We,arguments),r=this._cmp;try{n.sort(r)}catch{return Z(this,fe)}if(n.length===0)return Ve(this);var i=new this.Collection(this,function(){return Ee(n[0],n[n.length-1])});i._ondirectionchange=function(a){r=a==="next"?e._ascending:e._descending,n.sort(r)};var o=0;return i._addAlgorithm(function(a,u,s){for(var l=a.key;r(l,n[o])>0;)if(++o,o===n.length)return u(s),!1;return r(l,n[o])===0?!0:(u(function(){a.continue(n[o])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[On,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=de.apply(We,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Z(this,fe)}var n=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[On,i]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,i=this._cmp,o=this._ascending,a=this._descending,u=this._min,s=this._max;if(e.length===0)return Ve(this);if(!e.every(function(m){return m[0]!==void 0&&m[1]!==void 0&&o(m[0],m[1])<=0}))return Z(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",K.InvalidArgument);var l=!n||n.includeLowers!==!1,f=n&&n.includeUppers===!0;function c(m,_){for(var A=0,k=m.length;A<k;++A){var C=m[A];if(i(_[0],C[1])<0&&i(_[1],C[0])>0){C[0]=u(C[0],_[0]),C[1]=s(C[1],_[1]);break}}return A===k&&m.push(_),m}var h=o;function p(m,_){return h(m[0],_[0])}var d;try{d=e.reduce(c,[]),d.sort(p)}catch{return Z(this,fe)}var v=0,y=f?function(m){return o(m,d[v][1])>0}:function(m){return o(m,d[v][1])>=0},b=l?function(m){return a(m,d[v][0])>0}:function(m){return a(m,d[v][0])>=0};function E(m){return!y(m)&&!b(m)}var g=y,w=new this.Collection(this,function(){return Ee(d[0][0],d[d.length-1][1],!l,!f)});return w._ondirectionchange=function(m){m==="next"?(g=y,h=o):(g=b,h=a),d.sort(p)},w._addAlgorithm(function(m,_,A){for(var k=m.key;g(k);)if(++v,v===d.length)return _(A),!1;return E(k)?!0:(r._cmp(k,d[v][1])===0||r._cmp(k,d[v][0])===0||_(function(){h===o?m.continue(d[v][0]):m.continue(d[v][1])}),!1)}),w},t.prototype.startsWithAnyOf=function(){var e=de.apply(We,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?Ve(this):this.inAnyRange(e.map(function(n){return[n,n+Me]})):Z(this,"startsWithAnyOf() only works with strings")},t}();function ya(t){return xt(Ki.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:i};var o=t._deps.indexedDB;if(!o)throw new K.MissingAPI;this._cmp=this._ascending=o.cmp.bind(o),this._descending=function(a,u){return o.cmp(u,a)},this._max=function(a,u){return o.cmp(a,u)>0?a:u},this._min=function(a,u){return o.cmp(a,u)<0?a:u},this._IDBKeyRange=t._deps.IDBKeyRange})}function le(t){return N(function(e){return vt(e),t(e.target.error),!1})}function vt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var yt="storagemutated",xe="x-storagemutated-1",Te=kt(null,yt),ma=function(){function t(){}return t.prototype._lock=function(){return ot(!S.global),++this._reculock,this._reculock===1&&!S.global&&(S.lockOwnerFor=this),this},t.prototype._unlock=function(){if(ot(!S.global),--this._reculock===0)for(S.global||(S.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{tt(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&S.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(ot(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new K.DatabaseClosed(i);case"MissingAPIError":throw new K.MissingAPI(i.message,i);default:throw new K.OpenFailed(i)}if(!this.active)throw new K.TransactionInactive;return ot(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=N(function(o){vt(o),n._reject(e.error)}),e.onabort=N(function(o){vt(o),n.active&&n._reject(new K.Abort(e.error)),n.active=!1,n.on("abort").fire(o)}),e.oncomplete=N(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&Te.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return V(new K.ReadOnly("Transaction is readonly"));if(!this.active)return V(new K.TransactionInactive);if(this._locked())return new x(function(a,u){i._blockedFuncs.push([function(){i._promise(e,n,r).then(a,u)},S])});if(r)return Ke(function(){var a=new x(function(u,s){i._lock();var l=n(u,s,i);l&&l.then&&l.then(u,s)});return a.finally(function(){return i._unlock()}),a._lib=!0,a});var o=new x(function(a,u){var s=n(a,u,i);s&&s.then&&s.then(a,u)});return o._lib=!0,o},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=x.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=a)})()}var o=n._waitingFor;return new x(function(a,u){r.then(function(s){return n._waitingQueue.push(N(a.bind(null,s)))},function(s){return n._waitingQueue.push(N(u.bind(null,s)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new K.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(te(n,e))return n[e];var r=this.schema[e];if(!r)throw new K.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i},t}();function ga(t){return xt(ma.prototype,function(n,r,i,o,a){var u=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=kt(this,"complete","error","abort"),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new x(function(s,l){u._resolve=s,u._reject=l}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var l=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):l&&u.idbtrans&&u.idbtrans.abort(),V(s)})})}function Mn(t,e,n,r,i,o,a){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+Di(e)}}function Di(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Ti(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:ui(n,function(r){return[r.name,r]})}}function _a(t){return t.length===1?t[0]:t}var mt=function(t){try{return t.only([[]]),mt=function(){return[[]]},[[]]}catch{return mt=function(){return Me},Me}};function Bn(t){return t==null?function(){}:typeof t=="string"?ba(t):function(e){return ye(e,t)}}function ba(t){var e=t.split(".");return e.length===1?function(n){return n[t]}:function(n){return ye(n,t)}}function Mr(t){return[].slice.call(t)}var wa=0;function ct(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function Ea(t,e,n){function r(c,h){var p=Mr(c.objectStoreNames);return{schema:{name:c.name,tables:p.map(function(d){return h.objectStore(d)}).map(function(d){var v=d.keyPath,y=d.autoIncrement,b=Q(v),E=v==null,g={},w={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E,compound:b,keyPath:v,autoIncrement:y,unique:!0,extractKey:Bn(v)},indexes:Mr(d.indexNames).map(function(m){return d.index(m)}).map(function(m){var _=m.name,A=m.unique,k=m.multiEntry,C=m.keyPath,D=Q(C),M={name:_,compound:D,keyPath:C,unique:A,multiEntry:k,extractKey:Bn(C)};return g[ct(C)]=M,M}),getIndexByKeyPath:function(m){return g[ct(m)]}};return g[":id"]=w.primaryKey,v!=null&&(g[ct(v)]=w.primaryKey),w})},hasGetAll:p.length>0&&"getAll"in h.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var h=c.lower,p=c.upper,d=c.lowerOpen,v=c.upperOpen,y=h===void 0?p===void 0?null:e.upperBound(p,!!v):p===void 0?e.lowerBound(h,!!d):e.bound(h,p,!!d,!!v);return y}function o(c){var h=c.name;function p(y){var b=y.trans,E=y.type,g=y.keys,w=y.values,m=y.range;return new Promise(function(_,A){_=N(_);var k=b.objectStore(h),C=k.keyPath==null,D=E==="put"||E==="add";if(!D&&E!=="delete"&&E!=="deleteRange")throw new Error("Invalid operation type: "+E);var M=(g||w||{length:1}).length;if(g&&w&&g.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(M===0)return _({numFailures:0,failures:{},results:[],lastResult:void 0});var B,R=[],Y=[],T=0,ne=function(se){++T,vt(se)};if(E==="deleteRange"){if(m.type===4)return _({numFailures:T,failures:Y,results:[],lastResult:void 0});m.type===3?R.push(B=k.clear()):R.push(B=k.delete(i(m)))}else{var ie=D?C?[w,g]:[w,null]:[g,null],be=ie[0],ue=ie[1];if(D)for(var re=0;re<M;++re)R.push(B=ue&&ue[re]!==void 0?k[E](be[re],ue[re]):k[E](be[re])),B.onerror=ne;else for(var re=0;re<M;++re)R.push(B=k[E](be[re])),B.onerror=ne}var we=function(se){var nt=se.target.result;R.forEach(function(oe,At){return oe.error!=null&&(Y[At]=oe.error)}),_({numFailures:T,failures:Y,results:E==="delete"?g:R.map(function(oe){return oe.result}),lastResult:nt})};B.onerror=function(se){ne(se),we(se)},B.onsuccess=we})}function d(y){var b=y.trans,E=y.values,g=y.query,w=y.reverse,m=y.unique;return new Promise(function(_,A){_=N(_);var k=g.index,C=g.range,D=b.objectStore(h),M=k.isPrimaryKey?D:D.index(k.name),B=w?m?"prevunique":"prev":m?"nextunique":"next",R=E||!("openKeyCursor"in M)?M.openCursor(i(C),B):M.openKeyCursor(i(C),B);R.onerror=le(A),R.onsuccess=N(function(Y){var T=R.result;if(!T){_(null);return}T.___id=++wa,T.done=!1;var ne=T.continue.bind(T),ie=T.continuePrimaryKey;ie&&(ie=ie.bind(T));var be=T.advance.bind(T),ue=function(){throw new Error("Cursor not started")},re=function(){throw new Error("Cursor not stopped")};T.trans=b,T.stop=T.continue=T.continuePrimaryKey=T.advance=ue,T.fail=N(A),T.next=function(){var we=this,se=1;return this.start(function(){return se--?we.continue():we.stop()}).then(function(){return we})},T.start=function(we){var se=new Promise(function(oe,At){oe=N(oe),R.onerror=le(At),T.fail=At,T.stop=function($i){T.stop=T.continue=T.continuePrimaryKey=T.advance=re,oe($i)}}),nt=function(){if(R.result)try{we()}catch(oe){T.fail(oe)}else T.done=!0,T.start=function(){throw new Error("Cursor behind last entry")},T.stop()};return R.onsuccess=N(function(oe){R.onsuccess=nt,nt()}),T.continue=ne,T.continuePrimaryKey=ie,T.advance=be,nt(),se},_(T)},A)})}function v(y){return function(b){return new Promise(function(E,g){E=N(E);var w=b.trans,m=b.values,_=b.limit,A=b.query,k=_===1/0?void 0:_,C=A.index,D=A.range,M=w.objectStore(h),B=C.isPrimaryKey?M:M.index(C.name),R=i(D);if(_===0)return E({result:[]});if(y){var Y=m?B.getAll(R,k):B.getAllKeys(R,k);Y.onsuccess=function(be){return E({result:be.target.result})},Y.onerror=le(g)}else{var T=0,ne=m||!("openKeyCursor"in B)?B.openCursor(R):B.openKeyCursor(R),ie=[];ne.onsuccess=function(be){var ue=ne.result;if(!ue)return E({result:ie});if(ie.push(m?ue.value:ue.primaryKey),++T===_)return E({result:ie});ue.continue()},ne.onerror=le(g)}})}}return{name:h,schema:c,mutate:p,getMany:function(y){var b=y.trans,E=y.keys;return new Promise(function(g,w){g=N(g);for(var m=b.objectStore(h),_=E.length,A=new Array(_),k=0,C=0,D,M=function(T){var ne=T.target;(A[ne._pos]=ne.result)!=null,++C===k&&g(A)},B=le(w),R=0;R<_;++R){var Y=E[R];Y!=null&&(D=m.get(E[R]),D._pos=R,D.onsuccess=M,D.onerror=B,++k)}k===0&&g(A)})},get:function(y){var b=y.trans,E=y.key;return new Promise(function(g,w){g=N(g);var m=b.objectStore(h),_=m.get(E);_.onsuccess=function(A){return g(A.target.result)},_.onerror=le(w)})},query:v(s),openCursor:d,count:function(y){var b=y.query,E=y.trans,g=b.index,w=b.range;return new Promise(function(m,_){var A=E.objectStore(h),k=g.isPrimaryKey?A:A.index(g.name),C=i(w),D=C?k.count(C):k.count();D.onsuccess=N(function(M){return m(M.target.result)}),D.onerror=le(_)})}}}var a=r(t,n),u=a.schema,s=a.hasGetAll,l=u.tables.map(function(c){return o(c)}),f={};return l.forEach(function(c){return f[c.name]=c}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(c){var h=f[c];if(!h)throw new Error("Table '"+c+"' not found");return f[c]},MIN_KEY:-1/0,MAX_KEY:mt(e),schema:u}}function ka(t,e){return e.reduce(function(n,r){var i=r.create;return I(I({},n),i(n))},t)}function xa(t,e,n,r){var i=n.IDBKeyRange;n.indexedDB;var o=ka(Ea(e,i,r),t.dbcore);return{dbcore:o}}function ir(t,e){var n=t._novip,r=e.db,i=xa(n._middlewares,r,n._deps,e);n.core=i.dbcore,n.tables.forEach(function(o){var a=o.name;n.core.schema.tables.some(function(u){return u.name===a})&&(o.core=n.core.table(a),n[a]instanceof n.Table&&(n[a].core=o.core))})}function en(t,e,n,r){var i=t._novip;n.forEach(function(o){var a=r[o];e.forEach(function(u){var s=Qn(u,o);(!s||"value"in s&&s.value===void 0)&&(u===i.Transaction.prototype||u instanceof i.Transaction?me(u,o,{get:function(){return this.table(o)},set:function(l){ii(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):u[o]=new i.Table(o,a))})})}function $n(t,e){var n=t._novip;e.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Aa(t,e){return t._cfg.version-e._cfg.version}function Ca(t,e,n,r){var i=t._dbSchema,o=t._createTransaction("readwrite",t._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),u=S.transless||S;Ke(function(){S.trans=o,S.transless=u,e===0?(U(i).forEach(function(s){or(n,s,i[s].primKey,i[s].indexes)}),ir(t,n),x.follow(function(){return t.on.populate.fire(o)}).catch(a)):Sa(t,e,o,n).catch(a)})}function Sa(t,e,n,r){var i=t._novip,o=[],a=i._versions,u=i._dbSchema=ar(i,i.idbdb,r),s=!1,l=a.filter(function(c){return c._cfg.version>=e});l.forEach(function(c){o.push(function(){var h=u,p=c._cfg.dbschema;zn(i,h,r),zn(i,p,r),u=i._dbSchema=p;var d=Ii(h,p);d.add.forEach(function(w){or(r,w[0],w[1].primKey,w[1].indexes)}),d.change.forEach(function(w){if(w.recreate)throw new K.Upgrade("Not yet support for changing primary key");var m=r.objectStore(w.name);w.add.forEach(function(_){return Fn(m,_)}),w.change.forEach(function(_){m.deleteIndex(_.name),Fn(m,_)}),w.del.forEach(function(_){return m.deleteIndex(_)})});var v=c._cfg.contentUpgrade;if(v&&c._cfg.version>e){ir(i,r),n._memoizedTables={},s=!0;var y=si(p);d.del.forEach(function(w){y[w]=h[w]}),$n(i,[i.Transaction.prototype]),en(i,[i.Transaction.prototype],U(y),y),n.schema=y;var b=Xn(v);b&&et();var E,g=x.follow(function(){if(E=v(n),E&&b){var w=ge.bind(null,null);E.then(w,w)}});return E&&typeof E.then=="function"?x.resolve(E):g.then(function(){return E})}}),o.push(function(h){if(!s||!na){var p=c._cfg.dbschema;Da(p,h)}$n(i,[i.Transaction.prototype]),en(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function f(){return o.length?x.resolve(o.shift()(n.idbtrans)).then(f):x.resolve()}return f().then(function(){Ka(u,r)})}function Ii(t,e){var n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],o=e[r];if(!i)n.add.push([r,o]);else{var a={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!an)a.recreate=!0,n.change.push(a);else{var u=i.idxByName,s=o.idxByName,l=void 0;for(l in u)s[l]||a.del.push(l);for(l in s){var f=u[l],c=s[l];f?f.src!==c.src&&a.change.push(c):a.add.push(c)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}}return n}function or(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return Fn(i,o)}),i}function Ka(t,e){U(t).forEach(function(n){e.db.objectStoreNames.contains(n)||or(e,n,t[n].primKey,t[n].indexes)})}function Da(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return t[n]==null&&e.db.deleteObjectStore(n)})}function Fn(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function ar(t,e,n){var r={},i=rn(e.objectStoreNames,0);return i.forEach(function(o){for(var a=n.objectStore(o),u=a.keyPath,s=Mn(Di(u),u||"",!1,!1,!!a.autoIncrement,u&&typeof u!="string",!0),l=[],f=0;f<a.indexNames.length;++f){var c=a.index(a.indexNames[f]);u=c.keyPath;var h=Mn(c.name,u,!!c.unique,!!c.multiEntry,!1,u&&typeof u!="string",!1);l.push(h)}r[o]=Ti(o,s,l)}),r}function Ta(t,e,n){var r=t._novip;r.verno=e.version/10;var i=r._dbSchema=ar(r,e,n);r._storeNames=rn(e.objectStoreNames,0),en(r,[r._allTables],U(i),i)}function Ia(t,e){var n=ar(t,t.idbdb,e),r=Ii(n,t._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function zn(t,e,n){for(var r=t._novip,i=n.db.objectStoreNames,o=0;o<i.length;++o){var a=i[o],u=n.objectStore(a);r._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var l=u.indexNames[s],f=u.index(l).keyPath,c=typeof f=="string"?f:"["+rn(f).join("+")+"]";if(e[a]){var h=e[a].idxByName[c];h&&(h.name=l,delete e[a].idxByName[c],e[a].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&z.WorkerGlobalScope&&z instanceof z.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Pa(t){return t.split(",").map(function(e,n){e=e.trim();var r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Mn(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),Q(i),n===0)})}var Ra=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){U(e).forEach(function(r){if(e[r]!==null){var i=Pa(e[r]),o=i.shift();if(o.multi)throw new K.Schema("Primary key cannot be multi-valued");i.forEach(function(a){if(a.auto)throw new K.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new K.Schema("Index must have a name and cannot be an empty string")}),n[r]=Ti(r,o,i)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?J(this._cfg.storesSource,e):e;var r=n._versions,i={},o={};return r.forEach(function(a){J(i,a._cfg.storesSource),o=a._cfg.dbschema={},a._parseStoresSpec(i,o)}),n._dbSchema=o,$n(n,[n._allTables,n,n.Transaction.prototype]),en(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],U(o),o),n._storeNames=U(o),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Zn(this._cfg.contentUpgrade||$,e),this},t}();function Oa(t){return xt(Ra.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function ur(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new fr(un,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function sr(t){return t&&typeof t.databases=="function"}function Ma(t){var e=t.indexedDB,n=t.IDBKeyRange;return sr(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==un})}):ur(e,n).toCollection().primaryKeys()}function Ba(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!sr(n)&&e!==un&&ur(n,r).put({name:e}).catch($)}function $a(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!sr(n)&&e!==un&&ur(n,r).delete(e).catch($)}function Nn(t){return Ke(function(){return S.letThrough=!0,t()})}function Fa(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function za(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?V(e.dbOpenError):t});ce&&(e.openCanceller._stackHolder=je()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new K.DatabaseClosed("db.open() was cancelled")}var o=e.dbReadyResolve,a=null,u=!1;return x.race([r,(typeof navigator>"u"?x.resolve():Fa()).then(function(){return new x(function(s,l){if(i(),!n)throw new K.MissingAPI;var f=t.name,c=e.autoSchema?n.open(f):n.open(f,Math.round(t.verno*10));if(!c)throw new K.MissingAPI;c.onerror=le(l),c.onblocked=N(t._fireOnBlocked),c.onupgradeneeded=N(function(h){if(a=c.transaction,e.autoSchema&&!t._options.allowEmptyDB){c.onerror=vt,a.abort(),c.result.close();var p=n.deleteDatabase(f);p.onsuccess=p.onerror=N(function(){l(new K.NoSuchDatabase("Database "+f+" doesnt exist"))})}else{a.onerror=le(l);var d=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;u=d<1,t._novip.idbdb=c.result,Ca(t,d/10,a,l)}},l),c.onsuccess=N(function(){a=null;var h=t._novip.idbdb=c.result,p=rn(h.objectStoreNames);if(p.length>0)try{var d=h.transaction(_a(p),"readonly");e.autoSchema?Ta(t,h,d):(zn(t,t._dbSchema,d),Ia(t,d)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),ir(t,d)}catch{}lt.push(t),h.onversionchange=N(function(v){e.vcFired=!0,t.on("versionchange").fire(v)}),h.onclose=N(function(v){t.on("close").fire(v)}),u&&Ba(t._deps,f),s()},l)})})]).then(function(){return i(),e.onReadyBeingFired=[],x.resolve(Nn(function(){return t.on.ready.fire(t.vip)})).then(function s(){if(e.onReadyBeingFired.length>0){var l=e.onReadyBeingFired.reduce(Zn,$);return e.onReadyBeingFired=[],x.resolve(Nn(function(){return l(t.vip)})).then(s)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(s){e.dbOpenError=s;try{a&&a.abort()}catch{}return r===e.openCanceller&&t._close(),V(s)}).finally(function(){e.openComplete=!0,o()})}function jn(t){var e=function(a){return t.next(a)},n=function(a){return t.throw(a)},r=o(e),i=o(n);function o(a){return function(u){var s=a(u),l=s.value;return s.done?l:!l||typeof l.then!="function"?Q(l)?Promise.all(l).then(r,i):r(l):l.then(r,i)}}return o(e)()}function Na(t,e,n){var r=arguments.length;if(r<2)throw new K.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=li(i);return[t,o,n]}function Pi(t,e,n,r,i){return x.resolve().then(function(){var o=S.transless||S,a=t._createTransaction(e,n,t._dbSchema,r),u={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(c){return c.name===Jn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Pi(t,e,n,null,i)})):V(c)}var s=Xn(i);s&&et();var l,f=x.follow(function(){if(l=i.call(a,a),l)if(s){var c=ge.bind(null,null);l.then(c,c)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=jn(l))},u);return(l&&typeof l.then=="function"?x.resolve(l).then(function(c){return a.active?c:V(new K.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):f.then(function(){return l})).then(function(c){return r&&a._resolve(),a._completion.then(function(){return c})}).catch(function(c){return a._reject(c),V(c)})})}function Pt(t,e,n){for(var r=Q(t)?t.slice():[t],i=0;i<n;++i)r.push(e);return r}function ja(t){return I(I({},t),{table:function(e){var n=t.table(e),r=n.schema,i={},o=[];function a(v,y,b){var E=ct(v),g=i[E]=i[E]||[],w=v==null?0:typeof v=="string"?1:v.length,m=y>0,_=I(I({},b),{isVirtual:m,keyTail:y,keyLength:w,extractKey:Bn(v),unique:!m&&b.unique});if(g.push(_),_.isPrimaryKey||o.push(_),w>1){var A=w===2?v[0]:v.slice(0,w-1);a(A,y+1,b)}return g.sort(function(k,C){return k.keyTail-C.keyTail}),_}var u=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,l=r.indexes;s<l.length;s++){var f=l[s];a(f.keyPath,0,f)}function c(v){var y=i[ct(v)];return y&&y[0]}function h(v,y){return{type:v.type===1?2:v.type,lower:Pt(v.lower,v.lowerOpen?t.MAX_KEY:t.MIN_KEY,y),lowerOpen:!0,upper:Pt(v.upper,v.upperOpen?t.MIN_KEY:t.MAX_KEY,y),upperOpen:!0}}function p(v){var y=v.query.index;return y.isVirtual?I(I({},v),{query:{index:y,range:h(v.query.range,y.keyTail)}}):v}var d=I(I({},n),{schema:I(I({},r),{primaryKey:u,indexes:o,getIndexByKeyPath:c}),count:function(v){return n.count(p(v))},query:function(v){return n.query(p(v))},openCursor:function(v){var y=v.query.index,b=y.keyTail,E=y.isVirtual,g=y.keyLength;if(!E)return n.openCursor(v);function w(m){function _(k){k!=null?m.continue(Pt(k,v.reverse?t.MAX_KEY:t.MIN_KEY,b)):v.unique?m.continue(m.key.slice(0,g).concat(v.reverse?t.MIN_KEY:t.MAX_KEY,b)):m.continue()}var A=Object.create(m,{continue:{value:_},continuePrimaryKey:{value:function(k,C){m.continuePrimaryKey(Pt(k,t.MAX_KEY,b),C)}},primaryKey:{get:function(){return m.primaryKey}},key:{get:function(){var k=m.key;return g===1?k[0]:k.slice(0,g)}},value:{get:function(){return m.value}}});return A}return n.openCursor(p(v)).then(function(m){return m&&w(m)})}});return d}})}var La={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:ja};function lr(t,e,n,r){return n=n||{},r=r||"",U(t).forEach(function(i){if(!te(e,i))n[r+i]=void 0;else{var o=t[i],a=e[i];if(typeof o=="object"&&typeof a=="object"&&o&&a){var u=En(o),s=En(a);u!==s?n[r+i]=e[i]:u==="Object"?lr(o,a,n,r+i+"."):o!==a&&(n[r+i]=e[i])}else o!==a&&(n[r+i]=e[i])}}),U(e).forEach(function(i){te(t,i)||(n[r+i]=e[i])}),n}function Ua(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var Va={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return I(I({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,i=I(I({},n),{mutate:function(o){var a=S.trans,u=a.table(e).hook,s=u.deleting,l=u.creating,f=u.updating;switch(o.type){case"add":if(l.fire===$)break;return a._promise("readwrite",function(){return c(o)},!0);case"put":if(l.fire===$&&f.fire===$)break;return a._promise("readwrite",function(){return c(o)},!0);case"delete":if(s.fire===$)break;return a._promise("readwrite",function(){return c(o)},!0);case"deleteRange":if(s.fire===$)break;return a._promise("readwrite",function(){return h(o)},!0)}return n.mutate(o);function c(d){var v=S.trans,y=d.keys||Ua(r,d);if(!y)throw new Error("Keys missing");return d=d.type==="add"||d.type==="put"?I(I({},d),{keys:y}):I({},d),d.type!=="delete"&&(d.values=bn([],d.values,!0)),d.keys&&(d.keys=bn([],d.keys,!0)),Wa(n,d,y).then(function(b){var E=y.map(function(g,w){var m=b[w],_={onerror:null,onsuccess:null};if(d.type==="delete")s.fire.call(_,g,m,v);else if(d.type==="add"||m===void 0){var A=l.fire.call(_,g,d.values[w],v);g==null&&A!=null&&(g=A,d.keys[w]=g,r.outbound||ae(d.values[w],r.keyPath,g))}else{var k=lr(m,d.values[w]),C=f.fire.call(_,k,g,m,v);if(C){var D=d.values[w];Object.keys(C).forEach(function(M){te(D,M)?D[M]=C[M]:ae(D,M,C[M])})}}return _});return n.mutate(d).then(function(g){for(var w=g.failures,m=g.results,_=g.numFailures,A=g.lastResult,k=0;k<y.length;++k){var C=m?m[k]:y[k],D=E[k];C==null?D.onerror&&D.onerror(w[k]):D.onsuccess&&D.onsuccess(d.type==="put"&&b[k]?d.values[k]:C)}return{failures:w,results:m,numFailures:_,lastResult:A}}).catch(function(g){return E.forEach(function(w){return w.onerror&&w.onerror(g)}),Promise.reject(g)})})}function h(d){return p(d.trans,d.range,1e4)}function p(d,v,y){return n.query({trans:d,values:!1,query:{index:r,range:v},limit:y}).then(function(b){var E=b.result;return c({type:"delete",keys:E,trans:d}).then(function(g){return g.numFailures>0?Promise.reject(g.failures[0]):E.length<y?{failures:[],numFailures:0,lastResult:void 0}:p(d,I(I({},v),{lower:E[E.length-1],lowerOpen:!0}),y)})})}}});return i}})}};function Wa(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function Ri(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],i=0,o=0;i<e.keys.length&&o<t.length;++i)X(e.keys[i],t[o])===0&&(r.push(n?_t(e.values[i]):e.values[i]),++o);return r.length===t.length?r:null}catch{return null}}var Ha={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return I(I({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Ri(r.keys,r.trans._cache,r.cache==="clone");return i?x.resolve(i):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?_t(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},mn;function cr(t){return!("from"in t)}var he=function(t,e){if(this)J(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var n=new he;return t&&"d"in t&&J(n,t),n}};qe(he.prototype,(mn={add:function(t){return tn(this,t),this},addKey:function(t){return gt(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return gt(e,n,n)}),this}},mn[kn]=function(){return Ln(this)},mn));function gt(t,e,n){var r=X(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(cr(t))return J(t,{from:e,to:n,d:1});var i=t.l,o=t.r;if(X(n,t.from)<0)return i?gt(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Br(t);if(X(e,t.to)>0)return o?gt(o,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Br(t);X(e,t.from)<0&&(t.from=e,t.l=null,t.d=o?o.d+1:1),X(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var a=!t.r;i&&!t.l&&tn(t,i),o&&a&&tn(t,o)}}function tn(t,e){function n(r,i){var o=i.from,a=i.to,u=i.l,s=i.r;gt(r,o,a),u&&n(r,u),s&&n(r,s)}cr(e)||n(t,e)}function Ya(t,e){var n=Ln(e),r=n.next();if(r.done)return!1;for(var i=r.value,o=Ln(t),a=o.next(i.from),u=a.value;!r.done&&!a.done;){if(X(u.from,i.to)<=0&&X(u.to,i.from)>=0)return!0;X(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(a=o.next(i.from)).value}return!1}function Ln(t){var e=cr(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&X(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||X(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Br(t){var e,n,r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var o=i==="r"?"l":"r",a=I({},t),u=t[i];t.from=u.from,t.to=u.to,t[i]=u[i],a[i]=u[o],t[o]=a,a.d=$r(a)}t.d=$r(t)}function $r(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}var Ga={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new he(t.MIN_KEY,t.MAX_KEY);return I(I({},t),{table:function(r){var i=t.table(r),o=i.schema,a=o.primaryKey,u=a.extractKey,s=a.outbound,l=I(I({},i),{mutate:function(h){var p=h.trans,d=p.mutatedParts||(p.mutatedParts={}),v=function(A){var k="idb://"+e+"/"+r+"/"+A;return d[k]||(d[k]=new he)},y=v(""),b=v(":dels"),E=h.type,g=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[],w=g[0],m=g[1],_=h.trans._cache;return i.mutate(h).then(function(A){if(Q(w)){E!=="delete"&&(w=A.results),y.addKeys(w);var k=Ri(w,_);!k&&E!=="add"&&b.addKeys(w),(k||m)&&Qa(v,o,k,m)}else if(w){var C={from:w.lower,to:w.upper};b.add(C),y.add(C)}else y.add(n),b.add(n),o.indexes.forEach(function(D){return v(D.name).add(n)});return A})}}),f=function(h){var p,d,v=h.query,y=v.index,b=v.range;return[y,new he((p=b.lower)!==null&&p!==void 0?p:t.MIN_KEY,(d=b.upper)!==null&&d!==void 0?d:t.MAX_KEY)]},c={get:function(h){return[a,new he(h.key)]},getMany:function(h){return[a,new he().addKeys(h.keys)]},count:f,query:f,openCursor:f};return U(c).forEach(function(h){l[h]=function(p){var d=S.subscr;if(d){var v=function(_){var A="idb://"+e+"/"+r+"/"+_;return d[A]||(d[A]=new he)},y=v(""),b=v(":dels"),E=c[h](p),g=E[0],w=E[1];if(v(g.name||"").add(w),!g.isPrimaryKey)if(h==="count")b.add(n);else{var m=h==="query"&&s&&p.values&&i.query(I(I({},p),{values:!1}));return i[h].apply(this,arguments).then(function(_){if(h==="query"){if(s&&p.values)return m.then(function(D){var M=D.result;return y.addKeys(M),_});var A=p.values?_.result.map(u):_.result;p.values?y.addKeys(A):b.addKeys(A)}else if(h==="openCursor"){var k=_,C=p.values;return k&&Object.create(k,{key:{get:function(){return b.addKey(k.primaryKey),k.key}},primaryKey:{get:function(){var D=k.primaryKey;return b.addKey(D),D}},value:{get:function(){return C&&y.addKey(k.primaryKey),k.value}}})}return _})}}return i[h].apply(this,arguments)}}),l}})}};function Qa(t,e,n,r){function i(o){var a=t(o.name||"");function u(l){return l!=null?o.extractKey(l):null}var s=function(l){return o.multiEntry&&Q(l)?l.forEach(function(f){return a.addKey(f)}):a.addKey(l)};(n||r).forEach(function(l,f){var c=n&&u(n[f]),h=r&&u(r[f]);X(c,h)!==0&&(c!=null&&s(c),h!=null&&s(h))})}e.indexes.forEach(i)}var fr=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=n=I({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var o=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:$,dbReadyPromise:null,cancelOpen:$,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};a.dbReadyPromise=new x(function(u){a.dbReadyResolve=u}),a.openCanceller=new x(function(u,s){a.cancelOpen=s}),this._state=a,this.name=e,this.on=kt(this,"populate","blocked","versionchange","close",{ready:[Zn,$]}),this.on.ready.subscribe=oi(this.on.ready.subscribe,function(u){return function(s,l){t.vip(function(){var f=r._state;if(f.openComplete)f.dbOpenError||x.resolve().then(s),l&&u(s);else if(f.onReadyBeingFired)f.onReadyBeingFired.push(s),l&&u(s);else{u(s);var c=r;l||u(function h(){c.on.ready.unsubscribe(s),c.on.ready.unsubscribe(h)})}})}}),this.Collection=ca(this),this.Table=oa(this),this.Transaction=ga(this),this.Version=Oa(this),this.WhereClause=ya(this),this.on("versionchange",function(u){u.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+u.oldVersion/10)}),this._maxKey=mt(n.IDBKeyRange),this._createTransaction=function(u,s,l,f){return new r.Transaction(u,s,l,r._options.chromeTransactionDurability,f)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),lt.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(u)})},this.use(La),this.use(Va),this.use(Ga),this.use(Ha),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(function(u){return u(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new K.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new K.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(Aa),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||S.letThrough||this._vip)?e():new x(function(r,i){if(n._state.openComplete)return i(new K.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new K.DatabaseClosed);return}n.open().catch($)}n._state.dbReadyPromise.then(r,i)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,i=e.level,o=e.name;o&&this.unuse({stack:n,name:o});var a=this._middlewares[n]||(this._middlewares[n]=[]);return a.push({stack:n,create:r,level:i??10,name:o}),a.sort(function(u,s){return u.level-s.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,i=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(o){return i?o.create!==i:r?o.name!==r:!1})),this},t.prototype.open=function(){return za(this)},t.prototype._close=function(){var e=this._state,n=lt.indexOf(this);if(n>=0&&lt.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new x(function(r){e.dbReadyResolve=r}),e.openCanceller=new x(function(r,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new K.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new x(function(i,o){var a=function(){e.close();var u=e._deps.indexedDB.deleteDatabase(e.name);u.onsuccess=N(function(){$a(e._deps,e.name),i()}),u.onerror=le(o),u.onblocked=e._fireOnBlocked};if(n)throw new K.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return U(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=Na.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var i=this,o=S.trans;(!o||o.db!==this||e.indexOf("!")!==-1)&&(o=null);var a=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var u,s;try{if(s=n.map(function(f){var c=f instanceof i.Table?f.name:f;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e===hn)u=hn;else if(e=="rw"||e==dn)u=dn;else throw new K.InvalidArgument("Invalid transaction mode: "+e);if(o){if(o.mode===hn&&u===dn)if(a)o=null;else throw new K.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o&&s.forEach(function(f){if(o&&o.storeNames.indexOf(f)===-1)if(a)o=null;else throw new K.SubTransaction("Table "+f+" not included in parent transaction.")}),a&&o&&!o.active&&(o=null)}}catch(f){return o?o._promise(null,function(c,h){h(f)}):V(f)}var l=Pi.bind(null,this,u,s,o,r);return o?o._promise(u,l,"lock"):S.trans?tt(S.transless,function(){return i._whenReady(l)}):this._whenReady(l)},t.prototype.table=function(e){if(!te(this._allTables,e))throw new K.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),Xa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",qa=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)},t.prototype[Xa]=function(){return this},t}();function Oi(t,e){return U(e).forEach(function(n){var r=t[n]||(t[n]=new he);tn(r,e[n])}),t}function Mi(t){return new qa(function(e){var n=Xn(t);function r(p){n&&et();var d=function(){return Ke(t,{subscr:p,trans:null})},v=S.trans?tt(S.transless,d):d();return n&&v.then(ge,ge),v}var i=!1,o={},a={},u={get closed(){return i},unsubscribe:function(){i=!0,Te.storagemutated.unsubscribe(c)}};e.start&&e.start(u);var s=!1,l=!1;function f(){return U(a).some(function(p){return o[p]&&Ya(o[p],a[p])})}var c=function(p){Oi(o,p),f()&&h()},h=function(){if(!(s||i)){o={};var p={},d=r(p);l||(Te(yt,c),l=!0),s=!0,Promise.resolve(d).then(function(v){s=!1,!i&&(f()?h():(o={},a=p,e.next&&e.next(v)))},function(v){s=!1,e.error&&e.error(v),u.unsubscribe()})}};return h(),u})}var Un;try{Un={indexedDB:z.indexedDB||z.mozIndexedDB||z.webkitIndexedDB||z.msIndexedDB,IDBKeyRange:z.IDBKeyRange||z.webkitIDBKeyRange}}catch{Un={indexedDB:null,IDBKeyRange:null}}var Oe=fr;qe(Oe,I(I({},on),{delete:function(t){var e=new Oe(t,{addons:[]});return e.delete()},exists:function(t){return new Oe(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return Ma(Oe.dependencies).then(t)}catch{return V(new K.MissingAPI)}},defineClass:function(){function t(e){J(this,e)}return t},ignoreTransaction:function(t){return S.trans?tt(S.transless,t):t()},vip:Nn,async:function(t){return function(){try{var e=jn(t.apply(this,arguments));return!e||typeof e.then!="function"?x.resolve(e):e}catch(n){return V(n)}}},spawn:function(t,e,n){try{var r=jn(t.apply(n,e||[]));return!r||typeof r.then!="function"?x.resolve(r):r}catch(i){return V(i)}},currentTransaction:{get:function(){return S.trans||null}},waitFor:function(t,e){var n=x.resolve(typeof t=="function"?Oe.ignoreTransaction(t):t).timeout(e||6e4);return S.trans?S.trans.waitFor(n):n},Promise:x,debug:{get:function(){return ce},set:function(t){fi(t,t==="dexie"?function(){return!0}:Ai)}},derive:Je,extend:J,props:qe,override:oi,Events:kt,on:Te,liveQuery:Mi,extendObservabilitySet:Oi,getByKeyPath:ye,setByKeyPath:ae,delByKeyPath:To,shallowClone:si,deepClone:_t,getObjectDiff:lr,cmp:X,asap:ai,minKey:On,addons:[],connections:lt,errnames:Jn,dependencies:Un,semVer:Tr,version:Tr.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,n*2)})}));Oe.maxKey=mt(Oe.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Te(yt,function(t){if(!ve){var e;an?(e=document.createEvent("CustomEvent"),e.initCustomEvent(xe,!0,!0,t)):e=new CustomEvent(xe,{detail:t}),ve=!0,dispatchEvent(e),ve=!1}}),addEventListener(xe,function(t){var e=t.detail;ve||nn(e)}));function nn(t){var e=ve;try{ve=!0,Te.storagemutated.fire(t)}finally{ve=e}}var ve=!1;if(typeof BroadcastChannel<"u"){var Fr=new BroadcastChannel(xe);Te(yt,function(t){ve||Fr.postMessage(t)}),Fr.onmessage=function(t){t.data&&nn(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Te(yt,function(t){try{ve||(typeof localStorage<"u"&&localStorage.setItem(xe,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&bn([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:xe,changedParts:t})}))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",function(t){if(t.key===xe){var e=JSON.parse(t.newValue);e&&nn(e.changedParts)}});var zr=self.document&&navigator.serviceWorker;zr&&zr.addEventListener("message",Ja)}function Ja(t){var e=t.data;e&&e.type===xe&&nn(e.changedParts)}x.rejectionMapper=zo;fi(ce,Ai);class Za extends fr{constructor(){super("MemoryGame");hr(this,"completedGames");this.version(1).stores({completedGames:"++id, itemCount, moveCount"})}}const Bi=new Za;function Nr(t,e,n){const r=t.slice();return r[5]=e[n],r[7]=n,r}function eu(t){let e=[],n=new Map,r,i=Object.keys(t[1]).sort(t[2]);const o=a=>a[7];for(let a=0;a<i.length;a+=1){let u=Nr(t,i,a),s=o(u);n.set(s,e[a]=jr(s,u))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=Yn()},m(a,u){for(let s=0;s<e.length;s+=1)e[s].m(a,u);W(a,r,u)},p(a,u){u&14&&(i=Object.keys(a[1]).sort(a[2]),e=ri(e,u,o,1,a,i,n,r.parentNode,io,jr,r,Nr))},d(a){for(let u=0;u<e.length;u+=1)e[u].d(a);a&&L(r)}}}function tu(t){let e;return{c(){e=F("tr"),e.innerHTML='<td colspan="3" class="muted centered svelte-19w152h">No games played</td>'},m(n,r){W(n,e,r)},p:j,d(n){n&&L(e)}}}function jr(t,e){let n,r,i=e[5]+"",o,a,u,s,l=e[1][e[5]].length+"",f,c,h,p,d=e[3](Math.max(...e[1][e[5]].map(Lr)))+"",v,y,b;return{key:t,first:null,c(){n=F("tr"),r=F("td"),o=Ae(i),u=ee(),s=F("td"),f=Ae(l),h=ee(),p=F("td"),v=Ae(d),b=ee(),P(r,"data-testid",a="records-row"+e[7]+"-col0"),P(r,"class","svelte-19w152h"),P(s,"data-testid",c="records-row"+e[7]+"-col1"),P(s,"class","svelte-19w152h"),P(p,"data-testid",y="records-row"+e[7]+"-col2"),P(p,"class","svelte-19w152h"),this.first=n},m(E,g){W(E,n,g),O(n,r),O(r,o),O(n,u),O(n,s),O(s,f),O(n,h),O(n,p),O(p,v),O(n,b)},p(E,g){e=E,g&2&&i!==(i=e[5]+"")&&Ye(o,i),g&2&&a!==(a="records-row"+e[7]+"-col0")&&P(r,"data-testid",a),g&2&&l!==(l=e[1][e[5]].length+"")&&Ye(f,l),g&2&&c!==(c="records-row"+e[7]+"-col1")&&P(s,"data-testid",c),g&2&&d!==(d=e[3](Math.max(...e[1][e[5]].map(Lr)))+"")&&Ye(v,d),g&2&&y!==(y="records-row"+e[7]+"-col2")&&P(p,"data-testid",y)},d(E){E&&L(n)}}}function nu(t){let e,n,r,i;function o(s,l){return s[0]&&s[0].length===0?tu:eu}let a=o(t),u=a(t);return{c(){e=F("table"),n=F("thead"),n.innerHTML=`<tr><th scope="col" class="svelte-19w152h">Moves</th> 
      <th scope="col" class="svelte-19w152h">Games</th> 
      <th scope="col" class="svelte-19w152h">Last Played</th></tr>`,r=ee(),i=F("tbody"),u.c(),P(n,"class","svelte-19w152h"),P(i,"class","svelte-19w152h"),P(e,"class","svelte-19w152h")},m(s,l){W(s,e,l),O(e,n),O(e,r),O(e,i),u.m(i,null)},p(s,[l]){a===(a=o(s))&&u?u.p(s,l):(u.d(1),u=a(s),u&&(u.c(),u.m(i,null)))},i:j,o:j,d(s){s&&L(e),u.d()}}}const Lr=t=>t.timestamp;function ru(t,e,n){let r,i;const o=(s,l)=>parseInt(s)-parseInt(l),a=s=>{const l={year:"numeric",month:"short",day:"numeric"};return new Date(s).toLocaleDateString(navigator.language,l)};let u=Mi(()=>Bi.completedGames.toArray());return Wn(t,u,s=>n(0,i=s)),t.$$.update=()=>{t.$$.dirty&1&&n(1,r=Ao(i||[],"moveCount"))},[i,r,o,a,u]}class iu extends Re{constructor(e){super(),Pe(this,e,ru,nu,_e,{})}}function ou(t){let e,n,r,i;return{c(){e=F("div"),n=F("button"),n.textContent="Close",n.autofocus=!0,P(n,"class","button modal-close-button svelte-lh4ff1"),P(e,"slot","header"),P(e,"class","modal-header svelte-lh4ff1")},m(o,a){W(o,e,a),O(e,n),n.focus(),r||(i=Qe(n,"click",t[0]),r=!0)},p:j,d(o){o&&L(e),r=!1,i()}}}function au(t){let e,n,r,i,o;return i=new iu({}),{c(){e=F("div"),n=F("p"),n.textContent="Your objective is to solve puzzles in the fewest moves possible.",r=ee(),Fe(i.$$.fragment),P(n,"class","text-muted"),P(e,"slot","content"),P(e,"class","records-list svelte-lh4ff1")},m(a,u){W(a,e,u),O(e,n),O(e,r),Ce(i,e,null),o=!0},p:j,i(a){o||(H(i.$$.fragment,a),o=!0)},o(a){q(i.$$.fragment,a),o=!1},d(a){a&&L(e),Se(i)}}}function uu(t){let e,n;return e=new xo({props:{$$slots:{content:[au],header:[ou]},$$scope:{ctx:t}}}),e.$on("close",t[1]),{c(){Fe(e.$$.fragment)},m(r,i){Ce(e,r,i),n=!0},p(r,[i]){const o={};i&8&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(H(e.$$.fragment,r),n=!0)},o(r){q(e.$$.fragment,r),n=!1},d(r){Se(e,r)}}}function su(t){const e=Gn(),n=()=>e("close");function r(i){Zr.call(this,t,i)}return[n,r]}class lu extends Re{constructor(e){super(),Pe(this,e,su,uu,_e,{})}}function cu(t){let e,n,r,i=t[0]===1?"move":"moves",o;return{c(){e=F("div"),n=Ae(t[0]),r=ee(),o=Ae(i),P(e,"class","svelte-al6881")},m(a,u){W(a,e,u),O(e,n),O(e,r),O(e,o)},p(a,[u]){u&1&&Ye(n,a[0]),u&1&&i!==(i=a[0]===1?"move":"moves")&&Ye(o,i)},i:j,o:j,d(a){a&&L(e)}}}function fu(t,e,n){let{count:r=0}=e;return t.$$set=i=>{"count"in i&&n(0,r=i.count)},[r]}class hu extends Re{constructor(e){super(),Pe(this,e,fu,cu,_e,{count:0})}}function du(t){let e,n,r,i;return e=new hu({props:{count:t[2]}}),r=new go({}),r.$on("click",t[4]),{c(){Fe(e.$$.fragment),n=ee(),Fe(r.$$.fragment)},m(o,a){Ce(e,o,a),W(o,n,a),Ce(r,o,a),i=!0},p(o,a){const u={};a&4&&(u.count=o[2]),e.$set(u)},i(o){i||(H(e.$$.fragment,o),H(r.$$.fragment,o),i=!0)},o(o){q(e.$$.fragment,o),q(r.$$.fragment,o),i=!1},d(o){Se(e,o),o&&L(n),Se(r,o)}}}function Ur(t){let e,n;return e=new lu({}),e.$on("close",t[5]),{c(){Fe(e.$$.fragment)},m(r,i){Ce(e,r,i),n=!0},p:j,i(r){n||(H(e.$$.fragment,r),n=!0)},o(r){q(e.$$.fragment,r),n=!1},d(r){Se(e,r)}}}function pu(t){let e,n,r,i,o,a;r=new vo({props:{puzzle:t[0].puzzle,onCompleted:t[3],$$slots:{default:[du]},$$scope:{ctx:t}}});let u=t[1]&&Ur(t);return{c(){e=F("div"),n=F("div"),Fe(r.$$.fragment),i=ee(),u&&u.c(),o=Yn(),P(n,"class","app-container svelte-15ktk62"),P(e,"class","app-root svelte-15ktk62")},m(s,l){W(s,e,l),O(e,n),Ce(r,n,null),W(s,i,l),u&&u.m(s,l),W(s,o,l),a=!0},p(s,[l]){const f={};l&1&&(f.puzzle=s[0].puzzle),l&134&&(f.$$scope={dirty:l,ctx:s}),r.$set(f),s[1]?u?(u.p(s,l),l&2&&H(u,1)):(u=Ur(s),u.c(),H(u,1),u.m(o.parentNode,o)):u&&(ti(),q(u,1,1,()=>{u=null}),ni())},i(s){a||(H(r.$$.fragment,s),H(u),a=!0)},o(s){q(r.$$.fragment,s),q(u),a=!1},d(s){s&&L(e),Se(r),s&&L(i),u&&u.d(s),s&&L(o)}}}function Vr(){const t=Math.random,e=[[4,4]],[n,r]=e[Math.floor(t()*e.length)],i=n*r/2;let o=new Array(i).fill().map((l,f)=>f+1);o.push(...o);const a=Array.from({length:o.length},(l,f)=>{const c=Math.floor(t()*o.length);return{index:f,type:o.splice(c,1)[0],backfaceIsUp:!1}});console.log("new puzzle!");const u=a.map(l=>l.type);for(var s=0;s<r;s++)console.log(u.splice(0,n));return{puzzle:a}}function vu(t,e,n){let r;Wn(t,Mt,f=>n(2,r=f));let i=Vr();const o=async f=>{await Bi.completedGames.add({itemCount:i.puzzle.length,moveCount:f,timestamp:Date.now()})};function a(f){alert(`You won in ${f} moves!`),o(f),n(0,i=Vr())}let u=!1;return[i,u,r,a,()=>n(1,u=!0),()=>n(1,u=!1)]}class yu extends Re{constructor(e){super(),Pe(this,e,vu,pu,_e,{})}}new yu({target:document.body,props:{}});
