var Pi=Object.defineProperty;var Mi=(t,e,n)=>e in t?Pi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var lr=(t,e,n)=>(Mi(t,typeof e!="symbol"?e+"":e,n),n);const Oi=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};Oi();function ee(){}const Nr=t=>t;function Bi(t,e){for(const n in e)t[n]=e[n];return t}function jr(t){return t()}function cr(){return Object.create(null)}function Me(t){t.forEach(jr)}function jn(t){return typeof t=="function"}function Oe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Fi(t){return Object.keys(t).length===0}function $i(t,...e){if(t==null)return ee;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function zi(t,e,n){t.$$.on_destroy.push($i(e,n))}function hn(t,e,n,r){if(t){const i=Ur(t,e,n,r);return t[0](i)}}function Ur(t,e,n,r){return t[1]&&r?Bi(n.ctx.slice(),t[1](r(e))):n.ctx}function dn(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],a=Math.max(e.dirty.length,i.length);for(let u=0;u<a;u+=1)o[u]=e.dirty[u]|i[u];return o}return e.dirty|i}return e.dirty}function pn(t,e,n,r,i,o){if(i){const a=Ur(e,n,r,o);t.p(a,i)}}function vn(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}const Vr=typeof window!="undefined";let Li=Vr?()=>window.performance.now():()=>Date.now(),Un=Vr?t=>requestAnimationFrame(t):ee;const Ve=new Set;function Wr(t){Ve.forEach(e=>{e.c(t)||(Ve.delete(e),e.f())}),Ve.size!==0&&Un(Wr)}function Ni(t){let e;return Ve.size===0&&Un(Wr),{promise:new Promise(n=>{Ve.add(e={c:t,f:n})}),abort(){Ve.delete(e)}}}function R(t,e){t.appendChild(e)}function Hr(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function ji(t){const e=$("style");return Ui(Hr(t),e),e.sheet}function Ui(t,e){R(t.head||t,e)}function Y(t,e,n){t.insertBefore(e,n||null)}function U(t){t.parentNode.removeChild(t)}function $(t){return document.createElement(t)}function xe(t){return document.createTextNode(t)}function J(){return xe(" ")}function Vn(){return xe("")}function lt(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function B(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Vi(t){return Array.from(t.childNodes)}function We(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function fr(t,e,n){t.classList[n?"add":"remove"](e)}function Yr(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}const Lt=new Map;let Nt=0;function Wi(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Hi(t,e){const n={stylesheet:ji(e),rules:{}};return Lt.set(t,n),n}function hr(t,e,n,r,i,o,a,u=0){const s=16.666/r;let l=`{
`;for(let y=0;y<=1;y+=s){const g=e+(n-e)*o(y);l+=y*100+`%{${a(g,1-g)}}
`}const c=l+`100% {${a(n,1-n)}}
}`,f=`__svelte_${Wi(c)}_${u}`,h=Hr(t),{stylesheet:v,rules:p}=Lt.get(h)||Hi(h,t);p[f]||(p[f]=!0,v.insertRule(`@keyframes ${f} ${c}`,v.cssRules.length));const d=t.style.animation||"";return t.style.animation=`${d?`${d}, `:""}${f} ${r}ms linear ${i}ms 1 both`,Nt+=1,f}function Yi(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),Nt-=i,Nt||Gi())}function Gi(){Un(()=>{Nt||(Lt.forEach(t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}}),Lt.clear())})}let ct;function ot(t){ct=t}function Gr(){if(!ct)throw new Error("Function called outside component initialization");return ct}function qi(t){Gr().$$.on_destroy.push(t)}function Wn(){const t=Gr();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=Yr(e,n,{cancelable:r});return i.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function Qi(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const nt=[],yn=[],Rt=[],dr=[],Xi=Promise.resolve();let mn=!1;function Ji(){mn||(mn=!0,Xi.then(qr))}function Ye(t){Rt.push(t)}const tn=new Set;let At=0;function qr(){const t=ct;do{for(;At<nt.length;){const e=nt[At];At++,ot(e),Zi(e.$$)}for(ot(null),nt.length=0,At=0;yn.length;)yn.pop()();for(let e=0;e<Rt.length;e+=1){const n=Rt[e];tn.has(n)||(tn.add(n),n())}Rt.length=0}while(nt.length);for(;dr.length;)dr.pop()();mn=!1,tn.clear(),ot(t)}function Zi(t){if(t.fragment!==null){t.update(),Me(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ye)}}let tt;function eo(){return tt||(tt=Promise.resolve(),tt.then(()=>{tt=null})),tt}function nn(t,e,n){t.dispatchEvent(Yr(`${e?"intro":"outro"}${n}`))}const Pt=new Set;let pe;function Qr(){pe={r:0,c:[],p:pe}}function Xr(){pe.r||Me(pe.c),pe=pe.p}function q(t,e){t&&t.i&&(Pt.delete(t),t.i(e))}function Z(t,e,n,r){if(t&&t.o){if(Pt.has(t))return;Pt.add(t),pe.c.push(()=>{Pt.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}const to={duration:0};function Ct(t,e,n,r){let i=e(t,n),o=r?0:1,a=null,u=null,s=null;function l(){s&&Yi(t,s)}function c(h,v){const p=h.b-o;return v*=Math.abs(p),{a:o,b:h.b,d:p,duration:v,start:h.start,end:h.start+v,group:h.group}}function f(h){const{delay:v=0,duration:p=300,easing:d=Nr,tick:y=ee,css:g}=i||to,E={start:Li()+v,b:h};h||(E.group=pe,pe.r+=1),a||u?u=E:(g&&(l(),s=hr(t,o,h,p,v,d,g)),h&&y(0,1),a=c(E,p),Ye(()=>nn(t,h,"start")),Ni(b=>{if(u&&b>u.start&&(a=c(u,p),u=null,nn(t,a.b,"start"),g&&(l(),s=hr(t,o,a.b,a.duration,0,d,i.css))),a){if(b>=a.end)y(o=a.b,1-o),nn(t,a.b,"end"),u||(a.b?l():--a.group.r||Me(a.group.c)),a=null;else if(b>=a.start){const w=b-a.start;o=a.a+a.d*d(w/a.duration),y(o,1-o)}}return!!(a||u)}))}return{run(h){jn(i)?eo().then(()=>{i=i(),f(h)}):f(h)},end(){l(),a=u=null}}}function no(t,e){t.d(1),e.delete(t.key)}function ro(t,e){Z(t,1,1,()=>{e.delete(t.key)})}function Jr(t,e,n,r,i,o,a,u,s,l,c,f){let h=t.length,v=o.length,p=h;const d={};for(;p--;)d[t[p].key]=p;const y=[],g=new Map,E=new Map;for(p=v;p--;){const _=f(i,o,p),A=n(_);let k=a.get(A);k?r&&k.p(_,e):(k=l(A,_),k.c()),g.set(A,y[p]=k),A in d&&E.set(A,Math.abs(p-d[A]))}const b=new Set,w=new Set;function m(_){q(_,1),_.m(u,c),a.set(_.key,_),c=_.first,v--}for(;h&&v;){const _=y[v-1],A=t[h-1],k=_.key,C=A.key;_===A?(c=_.first,h--,v--):g.has(C)?!a.has(k)||b.has(k)?m(_):w.has(C)?h--:E.get(k)>E.get(C)?(w.add(k),m(_)):(b.add(C),h--):(s(A,a),h--)}for(;h--;){const _=t[h];g.has(_.key)||s(_,a)}for(;v;)m(y[v-1]);return y}function qe(t){t&&t.c()}function Be(t,e,n,r){const{fragment:i,on_mount:o,on_destroy:a,after_update:u}=t.$$;i&&i.m(e,n),r||Ye(()=>{const s=o.map(jr).filter(jn);a?a.push(...s):Me(s),t.$$.on_mount=[]}),u.forEach(Ye)}function Fe(t,e){const n=t.$$;n.fragment!==null&&(Me(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function io(t,e){t.$$.dirty[0]===-1&&(nt.push(t),Ji(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function $e(t,e,n,r,i,o,a,u=[-1]){const s=ct;ot(t);const l=t.$$={fragment:null,ctx:null,props:o,update:ee,not_equal:i,bound:cr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:cr(),dirty:u,skip_bound:!1,root:e.target||s.$$.root};a&&a(l.root);let c=!1;if(l.ctx=n?n(t,e.props||{},(f,h,...v)=>{const p=v.length?v[0]:h;return l.ctx&&i(l.ctx[f],l.ctx[f]=p)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](p),c&&io(t,f)),h}):[],l.update(),c=!0,Me(l.before_update),l.fragment=r?r(l.ctx):!1,e.target){if(e.hydrate){const f=Vi(e.target);l.fragment&&l.fragment.l(f),f.forEach(U)}else l.fragment&&l.fragment.c();e.intro&&q(t.$$.fragment),Be(t,e.target,e.anchor,e.customElement),qr()}ot(s)}class ze{$destroy(){Fe(this,1),this.$destroy=ee}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!Fi(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function oo(t){let e,n,r,i,o,a,u;const s=t[5].default,l=hn(s,t,t[4],null);return{c(){e=$("div"),n=$("div"),r=J(),i=$("div"),l&&l.c(),B(n,"class","card-front svelte-12ur0pi"),B(i,"class","card-back svelte-12ur0pi"),B(e,"class","card svelte-12ur0pi"),fr(e,"toggled",t[0])},m(c,f){Y(c,e,f),R(e,n),R(e,r),R(e,i),l&&l.m(i,null),o=!0,a||(u=lt(e,"click",t[1]),a=!0)},p(c,[f]){l&&l.p&&(!o||f&16)&&pn(l,s,c,c[4],o?dn(s,c[4],f,null):vn(c[4]),null),f&1&&fr(e,"toggled",c[0])},i(c){o||(q(l,c),o=!0)},o(c){Z(l,c),o=!1},d(c){c&&U(e),l&&l.d(c),a=!1,u()}}}function ao(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Wn();let{item:a={index:0,type:0,backfaceIsUp:!1}}=e,{flippable:u=!0}=e,{flipped:s=!1}=e;function l(){u&&!s&&o("flip",a)}return t.$$set=c=>{"item"in c&&n(2,a=c.item),"flippable"in c&&n(3,u=c.flippable),"flipped"in c&&n(0,s=c.flipped),"$$scope"in c&&n(4,i=c.$$scope)},[s,l,a,u,i,r]}class uo extends ze{constructor(e){super(),$e(this,e,ao,oo,Oe,{item:2,flippable:3,flipped:0})}}function so(t){let e,n,r,i=t[0]===1?"move":"moves",o;return{c(){e=$("div"),n=xe(t[0]),r=J(),o=xe(i),B(e,"class","svelte-al6881")},m(a,u){Y(a,e,u),R(e,n),R(e,r),R(e,o)},p(a,[u]){u&1&&We(n,a[0]),u&1&&i!==(i=a[0]===1?"move":"moves")&&We(o,i)},i:ee,o:ee,d(a){a&&U(e)}}}function lo(t,e,n){let{count:r=0}=e;return t.$$set=i=>{"count"in i&&n(0,r=i.count)},[r]}class co extends ze{constructor(e){super(),$e(this,e,lo,so,Oe,{count:0})}}function pr(t,e,n){const r=t.slice();return r[10]=e[n],r[12]=n,r}function fo(t){let e=t[10].type.toString()+"",n,r;return{c(){n=xe(e),r=J()},m(i,o){Y(i,n,o),Y(i,r,o)},p(i,o){o&1&&e!==(e=i[10].type.toString()+"")&&We(n,e)},d(i){i&&U(n),i&&U(r)}}}function vr(t,e){let n,r,i;return r=new uo({props:{item:e[10],flipped:e[10].backfaceIsUp,flippable:e[2].length<2,$$slots:{default:[fo]},$$scope:{ctx:e}}}),r.$on("flip",e[4]),{key:t,first:null,c(){n=Vn(),qe(r.$$.fragment),this.first=n},m(o,a){Y(o,n,a),Be(r,o,a),i=!0},p(o,a){e=o;const u={};a&1&&(u.item=e[10]),a&1&&(u.flipped=e[10].backfaceIsUp),a&4&&(u.flippable=e[2].length<2),a&8193&&(u.$$scope={dirty:a,ctx:e}),r.$set(u)},i(o){i||(q(r.$$.fragment,o),i=!0)},o(o){Z(r.$$.fragment,o),i=!1},d(o){o&&U(n),Fe(r,o)}}}function ho(t){let e,n,r=[],i=new Map,o,a,u,s,l,c,f,h,v=t[0];const p=d=>d[12];for(let d=0;d<v.length;d+=1){let y=pr(t,v,d),g=p(y);i.set(g,r[d]=vr(g,y))}return u=new co({props:{count:t[3]}}),{c(){e=$("div"),n=$("div");for(let d=0;d<r.length;d+=1)r[d].c();o=J(),a=$("div"),qe(u.$$.fragment),s=J(),l=$("button"),l.innerHTML=`<span class="icon svelte-zqv77c"><svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline></svg></span>
      Records`,B(n,"class","full-grid svelte-zqv77c"),B(l,"class","button"),B(a,"class","footer-bar svelte-zqv77c"),B(e,"class","disable-text-selection svelte-zqv77c")},m(d,y){Y(d,e,y),R(e,n);for(let g=0;g<r.length;g+=1)r[g].m(n,null);R(e,o),R(e,a),Be(u,a,null),R(a,s),R(a,l),c=!0,f||(h=lt(l,"click",function(){jn(t[1])&&t[1].apply(this,arguments)}),f=!0)},p(d,[y]){t=d,y&21&&(v=t[0],Qr(),r=Jr(r,y,p,1,t,v,i,n,ro,vr,null,pr),Xr());const g={};y&8&&(g.count=t[3]),u.$set(g)},i(d){if(!c){for(let y=0;y<v.length;y+=1)q(r[y]);q(u.$$.fragment,d),c=!0}},o(d){for(let y=0;y<r.length;y+=1)Z(r[y]);Z(u.$$.fragment,d),c=!1},d(d){d&&U(e);for(let y=0;y<r.length;y+=1)r[y].d();Fe(u),f=!1,h()}}}function rn(t,...e){return new Promise(n=>setTimeout(n,t,...e))}function po(t,e,n){let{puzzle:r=[]}=e,{onCompleted:i}=e,{showRecords:o}=e,a=[],u=0;function s(v){v.backfaceIsUp=!1,n(0,r)}function l(){r.length===r.filter(p=>p.backfaceIsUp).length&&rn(300,u).then(()=>{i(u),n(3,u=0)})}function c(){const v=[rn(600,a[1]).then(s),rn(800,a[0]).then(s)];Promise.all(v).then(()=>n(2,a=[]))}function f(){return a[0].type===a[1].type}function h(v){const p=v.detail;n(0,r[p.index].backfaceIsUp=!r[p.index].backfaceIsUp,r),n(2,a=[...a,p]),a.length>=2&&(n(3,u++,u),f()?(n(2,a=[]),l()):c())}return t.$$set=v=>{"puzzle"in v&&n(0,r=v.puzzle),"onCompleted"in v&&n(5,i=v.onCompleted),"showRecords"in v&&n(1,o=v.showRecords)},[r,o,a,u,h,i]}class vo extends ze{constructor(e){super(),$e(this,e,po,ho,Oe,{puzzle:0,onCompleted:5,showRecords:1})}}function yo(t){const e=t-1;return e*e*e+1}function yr(t){return--t*t*t*t*t+1}function mr(t){return-.5*(Math.cos(Math.PI*t)-1)}function gr(t,{delay:e=0,duration:n=400,easing:r=Nr}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:o=>`opacity: ${o*i}`}}function _r(t,{delay:e=0,duration:n=400,easing:r=yo}={}){const i=getComputedStyle(t),o=+i.opacity,a=parseFloat(i.height),u=parseFloat(i.paddingTop),s=parseFloat(i.paddingBottom),l=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),f=parseFloat(i.borderTopWidth),h=parseFloat(i.borderBottomWidth);return{delay:e,duration:n,easing:r,css:v=>`overflow: hidden;opacity: ${Math.min(v*20,1)*o};height: ${v*a}px;padding-top: ${v*u}px;padding-bottom: ${v*s}px;margin-top: ${v*l}px;margin-bottom: ${v*c}px;border-top-width: ${v*f}px;border-bottom-width: ${v*h}px;`}}const mo=t=>({}),br=t=>({}),go=t=>({}),wr=t=>({});function _o(t){let e,n,r,i,o,a,u,s,l,c;const f=t[4].header,h=hn(f,t,t[3],wr),v=t[4].content,p=hn(v,t,t[3],br);return{c(){e=$("div"),n=$("div"),i=J(),o=$("div"),h&&h.c(),a=J(),p&&p.c(),B(n,"class","modal-backdrop svelte-1hm6iu8"),B(o,"class","modal svelte-1hm6iu8"),B(o,"role","dialog"),B(o,"aria-modal","true"),B(e,"class","modal-overlay svelte-1hm6iu8")},m(d,y){Y(d,e,y),R(e,n),R(e,i),R(e,o),h&&h.m(o,null),R(o,a),p&&p.m(o,null),t[5](o),s=!0,l||(c=[lt(window,"keydown",t[2]),lt(n,"click",t[1])],l=!0)},p(d,[y]){t=d,h&&h.p&&(!s||y&8)&&pn(h,f,t,t[3],s?dn(f,t[3],y,go):vn(t[3]),wr),p&&p.p&&(!s||y&8)&&pn(p,v,t,t[3],s?dn(v,t[3],y,mo):vn(t[3]),br)},i(d){s||(Ye(()=>{r||(r=Ct(n,gr,{duration:600,easing:mr},!0)),r.run(1)}),q(h,d),q(p,d),Ye(()=>{u||(u=Ct(o,_r,{duration:600,easing:yr},!0)),u.run(1)}),s=!0)},o(d){r||(r=Ct(n,gr,{duration:600,easing:mr},!1)),r.run(0),Z(h,d),Z(p,d),u||(u=Ct(o,_r,{duration:600,easing:yr},!1)),u.run(0),s=!1},d(d){d&&U(e),d&&r&&r.end(),h&&h.d(d),p&&p.d(d),t[5](null),d&&u&&u.end(),l=!1,Me(c)}}}function bo(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Wn(),a=()=>o("close");let u;const s=f=>{if(f.key==="Escape"){a();return}if(f.key==="Tab"){const h=u.querySelectorAll("*"),v=Array.from(h).filter(d=>d.tabIndex>=0);let p=v.indexOf(document.activeElement);p===-1&&f.shiftKey&&(p=0),p+=v.length+(f.shiftKey?-1:1),p%=v.length,v[p].focus(),f.preventDefault()}},l=typeof document!="undefined"&&document.activeElement;l&&qi(()=>{l.focus()});function c(f){yn[f?"unshift":"push"](()=>{u=f,n(0,u)})}return t.$$set=f=>{"$$scope"in f&&n(3,i=f.$$scope)},[u,a,s,i,r,c]}class wo extends ze{constructor(e){super(),$e(this,e,bo,_o,Oe,{})}}const Eo=(t,e)=>t.reduce(function(n,r){var i=typeof e=="function"?e(r):r[e];return n.hasOwnProperty(i)||(n[i]=[]),n[i].push(r),n},{});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var I=function(){return I=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},I.apply(this,arguments)};function gn(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var z=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,N=Object.keys,H=Array.isArray;typeof Promise!="undefined"&&!z.Promise&&(z.Promise=Promise);function Q(t,e){return typeof e!="object"||N(e).forEach(function(n){t[n]=e[n]}),t}var ft=Object.getPrototypeOf,ko={}.hasOwnProperty;function te(t,e){return ko.call(t,e)}function Ge(t,e){typeof e=="function"&&(e=e(ft(t))),(typeof Reflect=="undefined"?N:Reflect.ownKeys)(e).forEach(function(n){me(t,n,e[n])})}var Zr=Object.defineProperty;function me(t,e,n,r){Zr(t,e,Q(n&&te(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Qe(t){return{from:function(e){return t.prototype=Object.create(e.prototype),me(t.prototype,"constructor",t),{extend:Ge.bind(null,t.prototype)}}}}var xo=Object.getOwnPropertyDescriptor;function Hn(t,e){var n=xo(t,e),r;return n||(r=ft(t))&&Hn(r,e)}var Ao=[].slice;function Xt(t,e,n){return Ao.call(t,e,n)}function ei(t,e){return e(t)}function rt(t){if(!t)throw new Error("Assertion Failed")}function ti(t){z.setImmediate?setImmediate(t):setTimeout(t,0)}function ni(t,e){return t.reduce(function(n,r,i){var o=e(r,i);return o&&(n[o[0]]=o[1]),n},{})}function Co(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function ye(t,e){if(te(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,i=e.length;r<i;++r){var o=ye(t,e[r]);n.push(o)}return n}var a=e.indexOf(".");if(a!==-1){var u=t[e.substr(0,a)];return u===void 0?void 0:ye(u,e.substr(a+1))}}function ae(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){rt(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)ae(t,e[r],n[r])}else{var o=e.indexOf(".");if(o!==-1){var a=e.substr(0,o),u=e.substr(o+1);if(u==="")n===void 0?H(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var s=t[a];(!s||!te(t,a))&&(s=t[a]={}),ae(s,u,n)}}else n===void 0?H(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function So(t,e){typeof e=="string"?ae(t,e,void 0):"length"in e&&[].map.call(e,function(n){ae(t,n,void 0)})}function ri(t){var e={};for(var n in t)te(t,n)&&(e[n]=t[n]);return e}var Ko=[].concat;function ii(t){return Ko.apply([],t)}var oi="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ii([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return z[t]}),Do=oi.map(function(t){return z[t]});ni(oi,function(t){return[t,!0]});var Ee=null;function gt(t){Ee=typeof WeakMap!="undefined"&&new WeakMap;var e=_n(t);return Ee=null,e}function _n(t){if(!t||typeof t!="object")return t;var e=Ee&&Ee.get(t);if(e)return e;if(H(t)){e=[],Ee&&Ee.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(_n(t[n]))}else if(Do.indexOf(t.constructor)>=0)e=t;else{var i=ft(t);e=i===Object.prototype?{}:Object.create(i),Ee&&Ee.set(t,e);for(var o in t)te(t,o)&&(e[o]=_n(t[o]))}return e}var To={}.toString;function bn(t){return To.call(t).slice(8,-1)}var wn=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",Io=typeof wn=="symbol"?function(t){var e;return t!=null&&(e=t[wn])&&e.apply(t)}:function(){return null},Ue={};function de(t){var e,n,r,i;if(arguments.length===1){if(H(t))return t.slice();if(this===Ue&&typeof t=="string")return[t];if(i=Io(t)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var Yn=typeof Symbol!="undefined"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ce=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ai(t,e){ce=t,ui=e}var ui=function(){return!0},Ro=!new Error("").stack;function Le(){if(Ro)try{throw Le.arguments,new Error}catch(t){return t}return new Error}function En(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(ui).map(function(r){return`
`+r}).join("")):""}var Po=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],si=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Gn=Po.concat(si),Mo={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Xe(t,e){this._e=Le(),this.name=t,this.message=e}Qe(Xe).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+En(this._e,2))}},toString:function(){return this.name+": "+this.message}});function li(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function jt(t,e,n,r){this._e=Le(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=li(t,e)}Qe(jt).from(Xe);function at(t,e){this._e=Le(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=li(t,e)}Qe(at).from(Xe);var qn=Gn.reduce(function(t,e){return t[e]=e+"Error",t},{}),Oo=Xe,K=Gn.reduce(function(t,e){var n=e+"Error";function r(i,o){this._e=Le(),this.name=n,i?typeof i=="string"?(this.message=""+i+(o?`
 `+o:""),this.inner=o||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Mo[e]||n,this.inner=null)}return Qe(r).from(Oo),t[e]=r,t},{});K.Syntax=SyntaxError;K.Type=TypeError;K.Range=RangeError;var Er=si.reduce(function(t,e){return t[e+"Error"]=K[e],t},{});function Bo(t,e){if(!t||t instanceof Xe||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Er[t.name])return t;var n=new Er[t.name](e||t.message,t);return"stack"in t&&me(n,"stack",{get:function(){return this.inner.stack}}),n}var Jt=Gn.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=K[e]),t},{});Jt.ModifyError=jt;Jt.DexieError=Xe;Jt.BulkError=at;function F(){}function _t(t){return t}function Fo(t,e){return t==null||t===_t?e:function(n){return e(t(n))}}function Re(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function $o(t,e){return t===F?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Re(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Re(i,this.onerror):i),o!==void 0?o:n}}function zo(t,e){return t===F?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Re(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Re(r,this.onerror):r)}}function Lo(t,e){return t===F?e:function(n){var r=t.apply(this,arguments);Q(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Re(i,this.onsuccess):i),o&&(this.onerror=this.onerror?Re(o,this.onerror):o),r===void 0?a===void 0?void 0:a:Q(r,a)}}function No(t,e){return t===F?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function Qn(t,e){return t===F?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return e.apply(r,o)})}return e.apply(this,arguments)}}var ht={},jo=100,Uo=20,ci=100,Xn=typeof Promise=="undefined"?[]:function(){var t=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[t,ft(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,ft(e),t]}(),kn=Xn[0],Ut=Xn[1],xn=Xn[2],fi=Ut&&Ut.then,Mt=kn&&kn.constructor,Jn=!!xn,An=!1,Vo=xn?function(){xn.then(St)}:z.setImmediate?setImmediate.bind(null,St):z.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){St(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(St,0)},dt=function(t,e){it.push([t,e]),Vt&&(Vo(),Vt=!1)},Cn=!0,Vt=!0,Te=[],Ot=[],Sn=null,Kn=_t,He={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ar,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{Ar(t[0],t[1])}catch{}})}},S=He,it=[],Ie=0,Bt=[];function x(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=F,this._lib=!1;var e=this._PSD=S;if(ce&&(this._stackHolder=Le(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==ht)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Tn(this,this._value);return}this._state=null,this._value=null,++e.ref,di(this,t)}var Dn={get:function(){var t=S,e=Wt;function n(r,i){var o=this,a=!t.global&&(t!==S||e!==Wt),u=a&&!ge(),s=new x(function(l,c){Zn(o,new hi(Yt(r,t,a,u),Yt(i,t,a,u),l,c,t))});return ce&&yi(s,this),s}return n.prototype=ht,n},set:function(t){me(this,"then",t&&t.prototype===ht?Dn:{get:function(){return t},set:Dn.set})}};Ge(x.prototype,{then:Dn,_then:function(t,e){Zn(this,new hi(null,null,t,e,S))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,function(r){return r instanceof e?n(r):Ft(r)}):this.then(null,function(r){return r&&r.name===e?n(r):Ft(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),Ft(e)})},stack:{get:function(){if(this._stack)return this._stack;try{An=!0;var t=vi(this,[],Uo),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{An=!1}}},timeout:function(t,e){var n=this;return t<1/0?new x(function(r,i){var o=setTimeout(function(){return i(new K.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&me(x.prototype,Symbol.toStringTag,"Dexie.Promise");He.env=mi();function hi(t,e,n,r,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=i}Ge(x,{all:function(){var t=de.apply(null,arguments).map(Ht);return new x(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(i,o){return x.resolve(i).then(function(a){t[o]=a,--r||e(t)},n)})})},resolve:function(t){if(t instanceof x)return t;if(t&&typeof t.then=="function")return new x(function(n,r){t.then(n,r)});var e=new x(ht,!0,t);return yi(e,Sn),e},reject:Ft,race:function(){var t=de.apply(null,arguments).map(Ht);return new x(function(e,n){t.map(function(r){return x.resolve(r).then(e,n)})})},PSD:{get:function(){return S},set:function(t){return S=t}},totalEchoes:{get:function(){return Wt}},newPSD:Ae,usePSD:Ze,scheduler:{get:function(){return dt},set:function(t){dt=t}},rejectionMapper:{get:function(){return Kn},set:function(t){Kn=t}},follow:function(t,e){return new x(function(n,r){return Ae(function(i,o){var a=S;a.unhandleds=[],a.onunhandled=o,a.finalize=Re(function(){var u=this;Ho(function(){u.unhandleds.length===0?i():o(u.unhandleds[0])})},a.finalize),t()},e,n,r)})}});Mt&&(Mt.allSettled&&me(x,"allSettled",function(){var t=de.apply(null,arguments).map(Ht);return new x(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(i,o){return x.resolve(i).then(function(a){return r[o]={status:"fulfilled",value:a}},function(a){return r[o]={status:"rejected",reason:a}}).then(function(){return--n||e(r)})})})}),Mt.any&&typeof AggregateError!="undefined"&&me(x,"any",function(){var t=de.apply(null,arguments).map(Ht);return new x(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,i=new Array(r);t.forEach(function(o,a){return x.resolve(o).then(function(u){return e(u)},function(u){i[a]=u,--r||n(new AggregateError(i))})})})}));function di(t,e){try{e(function(n){if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&bt();n&&typeof n.then=="function"?di(t,function(i,o){n instanceof x?n._then(i,o):n.then(i,o)}):(t._state=!0,t._value=n,pi(t)),r&&wt()}},Tn.bind(null,t))}catch(n){Tn(t,n)}}function Tn(t,e){if(Ot.push(e),t._state===null){var n=t._lib&&bt();e=Kn(e),t._state=!1,t._value=e,ce&&e!==null&&typeof e=="object"&&!e._promise&&Co(function(){var r=Hn(e,"stack");e._promise=t,me(e,"stack",{get:function(){return An?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),Yo(t),pi(t),n&&wt()}}function pi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Zn(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),Ie===0&&(++Ie,dt(function(){--Ie===0&&er()},[]))}function Zn(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Ie,dt(Wo,[n,t,e])}function Wo(t,e,n){try{Sn=e;var r,i=e._value;e._state?r=t(i):(Ot.length&&(Ot=[]),r=t(i),Ot.indexOf(i)===-1&&Go(e)),n.resolve(r)}catch(o){n.reject(o)}finally{Sn=null,--Ie===0&&er(),--n.psd.ref||n.psd.finalize()}}function vi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var i=t._value,o,a;i!=null?(o=i.name||"Error",a=i.message||i,r=En(i,0)):(o=i,a=""),e.push(o+(a?": "+a:"")+r)}return ce&&(r=En(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&vi(t._prev,e,n)),e}function yi(t,e){var n=e?e._numPrev+1:0;n<jo&&(t._prev=e,t._numPrev=n)}function St(){bt()&&wt()}function bt(){var t=Cn;return Cn=!1,Vt=!1,t}function wt(){var t,e,n;do for(;it.length>0;)for(t=it,it=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(it.length>0);Cn=!0,Vt=!0}function er(){var t=Te;Te=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=Bt.slice(0),n=e.length;n;)e[--n]()}function Ho(t){function e(){t(),Bt.splice(Bt.indexOf(e),1)}Bt.push(e),++Ie,dt(function(){--Ie===0&&er()},[])}function Yo(t){Te.some(function(e){return e._value===t._value})||Te.push(t)}function Go(t){for(var e=Te.length;e;)if(Te[--e]._value===t._value){Te.splice(e,1);return}}function Ft(t){return new x(ht,!1,t)}function L(t,e){var n=S;return function(){var r=bt(),i=S;try{return Ce(n,!0),t.apply(this,arguments)}catch(o){e&&e(o)}finally{Ce(i,!1),r&&wt()}}}var W={awaits:0,echoes:0,id:0},qo=0,$t=[],on=0,Wt=0,Qo=0;function Ae(t,e,n,r){var i=S,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Qo;var a=He.env;o.env=Jn?{Promise:x,PromiseProp:{value:x,configurable:!0,writable:!0},all:x.all,race:x.race,allSettled:x.allSettled,any:x.any,resolve:x.resolve,reject:x.reject,nthen:kr(a.nthen,o),gthen:kr(a.gthen,o)}:{},e&&Q(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Ze(o,t,n,r);return o.ref===0&&o.finalize(),u}function Je(){return W.id||(W.id=++qo),++W.awaits,W.echoes+=ci,W.id}function ge(){return W.awaits?(--W.awaits===0&&(W.id=0),W.echoes=W.awaits*ci,!0):!1}(""+fi).indexOf("[native code]")===-1&&(Je=ge=F);function Ht(t){return W.echoes&&t&&t.constructor===Mt?(Je(),t.then(function(e){return ge(),e},function(e){return ge(),j(e)})):t}function Xo(t){++Wt,(!W.echoes||--W.echoes===0)&&(W.echoes=W.id=0),$t.push(S),Ce(t,!0)}function Jo(){var t=$t[$t.length-1];$t.pop(),Ce(t,!1)}function Ce(t,e){var n=S;if((e?W.echoes&&(!on++||t!==S):on&&(!--on||t!==S))&&gi(e?Xo.bind(null,t):Jo),t!==S&&(S=t,n===He&&(He.env=mi()),Jn)){var r=He.env.Promise,i=t.env;Ut.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(z,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function mi(){var t=z.Promise;return Jn?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(z,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Ut.then,gthen:t.prototype.then}:{}}function Ze(t,e,n,r,i){var o=S;try{return Ce(t,!0),e(n,r,i)}finally{Ce(o,!1)}}function gi(t){fi.call(kn,t)}function Yt(t,e,n,r){return typeof t!="function"?t:function(){var i=S;n&&Je(),Ce(e,!0);try{return t.apply(this,arguments)}finally{Ce(i,!1),r&&gi(ge)}}}function kr(t,e){return function(n,r){return t.call(this,Yt(n,e),Yt(r,e))}}var xr="unhandledrejection";function Ar(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,i={promise:e,reason:t};if(z.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(xr,!0,!0),Q(r,i)):z.CustomEvent&&(r=new CustomEvent(xr,{detail:i}),Q(r,i)),r&&z.dispatchEvent&&(dispatchEvent(r),!z.PromiseRejectionEvent&&z.onunhandledrejection))try{z.onunhandledrejection(r)}catch{}ce&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var j=x.reject;function In(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!S.letThrough&&!t._vip){if(t._state.openComplete)return j(new K.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return j(new K.DatabaseClosed);t.open().catch(F)}return t._state.dbReadyPromise.then(function(){return In(t,e,n,r)})}else{var i=t._createTransaction(e,n,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(o){return o.name===qn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return In(t,e,n,r)})):j(o)}return i._promise(e,function(o,a){return Ae(function(){return S.trans=i,r(o,a,i)})}).then(function(o){return i._completion.then(function(){return o})})}}var Cr="3.2.2",De=String.fromCharCode(65535),Rn=-1/0,fe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",_i="String expected.",ut=[],Zt=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Zo=Zt,ea=Zt,bi=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},en="__dbnames",an="readonly",un="readwrite";function Pe(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var wi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Kt(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=gt(e),delete e[t]),e}:function(e){return e}}var ta=function(){function t(){}return t.prototype._trans=function(e,n,r){var i=this._tx||S.trans,o=this.name;function a(s,l,c){if(!c.schema[o])throw new K.NotFound("Table "+o+" not part of transaction");return n(c.idbtrans,c)}var u=bt();try{return i&&i.db===this.db?i===S.trans?i._promise(e,a,r):Ae(function(){return i._promise(e,a,r)},{trans:i,transless:S.transless||S}):In(this.db,e,[this.name],a)}finally{u&&wt()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(o){return r.hook.reading.fire(o)})}).then(n)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(H(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=N(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(c){return c.compound&&n.every(function(f){return c.keyPath.indexOf(f)>=0})&&c.keyPath.every(function(f){return n.indexOf(f)>=0})})[0];if(r&&this.db._maxKey!==De)return this.where(r.name).equals(r.keyPath.map(function(c){return e[c]}));!r&&ce&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,o=this.db._deps.indexedDB;function a(c,f){try{return o.cmp(c,f)===0}catch{return!1}}var u=n.reduce(function(c,f){var h=c[0],v=c[1],p=i[f],d=e[f];return[h||p,h||!p?Pe(v,p&&p.multi?function(y){var g=ye(y,f);return H(g)&&g.some(function(E){return a(d,E)})}:function(y){return a(d,ye(y,f))}):v]},[null,null]),s=u[0],l=u[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,H(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var i=Object.create(e.prototype);for(var o in r)if(te(r,o))try{i[o]=r[o]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){function e(n){Q(this,n)}return this.mapToClass(e)},t.prototype.add=function(e,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,u=e;return a&&o&&(u=Kt(a)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(a)try{ae(e,a,s)}catch{}return s})},t.prototype.update=function(e,n){if(typeof e=="object"&&!H(e)){var r=ye(e,this.schema.primKey.keyPath);if(r===void 0)return j(new K.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?N(n).forEach(function(i){ae(e,i,n[i])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)},t.prototype.put=function(e,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,u=e;return a&&o&&(u=Kt(a)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(a)try{ae(e,a,s)}catch{}return s})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?x.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:wi})}).then(function(n){return n.numFailures?x.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(o){return n.hook.reading.fire(o)})})})},t.prototype.bulkAdd=function(e,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var a=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,c=s.keyPath;if(c&&o)throw new K.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var f=e.length,h=c&&l?e.map(Kt(c)):e;return i.core.mutate({trans:u,type:"add",keys:o,values:h,wantResults:a}).then(function(v){var p=v.numFailures,d=v.results,y=v.lastResult,g=v.failures,E=a?d:y;if(p===0)return E;throw new at(i.name+".bulkAdd(): "+p+" of "+f+" operations failed",g)})})},t.prototype.bulkPut=function(e,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var a=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,c=s.keyPath;if(c&&o)throw new K.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var f=e.length,h=c&&l?e.map(Kt(c)):e;return i.core.mutate({trans:u,type:"put",keys:o,values:h,wantResults:a}).then(function(v){var p=v.numFailures,d=v.results,y=v.lastResult,g=v.failures,E=a?d:y;if(p===0)return E;throw new at(i.name+".bulkPut(): "+p+" of "+f+" operations failed",g)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var o=i.numFailures,a=i.lastResult,u=i.failures;if(o===0)return a;throw new at(n.name+".bulkDelete(): "+o+" of "+r+" operations failed",u)})},t}();function Et(t){var e={},n=function(u,s){if(s){for(var l=arguments.length,c=new Array(l-1);--l;)c[l-1]=arguments[l];return e[u].subscribe.apply(null,c),t}else if(typeof u=="string")return e[u]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(u,s,l){if(typeof u=="object")return a(u);s||(s=No),l||(l=F);var c={subscribers:[],fire:l,subscribe:function(f){c.subscribers.indexOf(f)===-1&&(c.subscribers.push(f),c.fire=s(c.fire,f))},unsubscribe:function(f){c.subscribers=c.subscribers.filter(function(h){return h!==f}),c.fire=c.subscribers.reduce(s,l)}};return e[u]=n[u]=c,c}function a(u){N(u).forEach(function(s){var l=u[s];if(H(l))o(s,u[s][0],u[s][1]);else if(l==="asap")var c=o(s,_t,function(){for(var h=arguments.length,v=new Array(h);h--;)v[h]=arguments[h];c.subscribers.forEach(function(p){ti(function(){p.apply(null,v)})})});else throw new K.InvalidArgument("Invalid event config")})}}function kt(t,e){return Qe(e).from({prototype:t}),e}function na(t){return kt(ta.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:Et(null,{creating:[$o,F],reading:[Fo,_t],updating:[Lo,F],deleting:[zo,F]})})}function Ne(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function sn(t,e){t.filter=Pe(t.filter,e)}function ln(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Pe(r(),e())}:e,t.justLimit=n&&!r}function ra(t,e){t.isMatch=Pe(t.isMatch,e)}function zt(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new K.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Sr(t,e,n){var r=zt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Dt(t,e,n,r){var i=t.replayFilter?Pe(t.filter,t.replayFilter()):t.filter;if(t.or){var o={},a=function(u,s,l){if(!i||i(s,l,function(h){return s.stop(h)},function(h){return s.fail(h)})){var c=s.primaryKey,f=""+c;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(c)),te(o,f)||(o[f]=!0,e(u,s,l))}};return Promise.all([t.or._iterate(a,n),Kr(Sr(t,r,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}else return Kr(Sr(t,r,n),Pe(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function Kr(t,e,n,r){var i=r?function(a,u,s){return n(r(a),u,s)}:n,o=L(i);return t.then(function(a){if(a)return a.start(function(){var u=function(){return a.continue()};(!e||e(a,function(s){return u=s},function(s){a.stop(s),u=F},function(s){a.fail(s),u=F}))&&o(a.value,a,function(s){return u=s}),u()})})}function G(t,e){try{var n=Dr(t),r=Dr(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return oa(Tr(t),Tr(e));case"Array":return ia(t,e)}}catch{}return NaN}function ia(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,o=0;o<i;++o){var a=G(t[o],e[o]);if(a!==0)return a}return n===r?0:n<r?-1:1}function oa(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,o=0;o<i;++o)if(t[o]!==e[o])return t[o]<e[o]?-1:1;return n===r?0:n<r?-1:1}function Dr(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var n=bn(t);return n==="ArrayBuffer"?"binary":n}function Tr(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var aa=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,j.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,j.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Pe(n.algorithm,e)},t.prototype._iterate=function(e,n){return Dt(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Q(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return Dt(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var i=n._ctx,o=i.table.core;if(Ne(i,!0))return o.count({trans:r,query:{index:zt(i,o.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var a=0;return Dt(i,function(){return++a,!1},r,o).then(function(){return a})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),i=r[0],o=r.length-1;function a(l,c){return c?a(l[r[c]],c-1):l[i]}var u=this._ctx.dir==="next"?1:-1;function s(l,c){var f=a(l,o),h=a(c,o);return f<h?-u:f>h?u:0}return this.toArray(function(l){return l.sort(s)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ne(i,!0)&&i.limit>0){var o=i.valueMapper,a=zt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:a,range:i.range}}).then(function(s){var l=s.result;return o?l.map(o):l})}else{var u=[];return Dt(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Ne(n)?ln(n,function(){var r=e;return function(i,o){return r===0?!0:r===1?(--r,!1):(o(function(){i.advance(r),r=0}),!1)}}):ln(n,function(){var r=e;return function(){return--r<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),ln(this._ctx,function(){var n=e;return function(r,i,o){return--n<=0&&i(o),n>=0}},!0),this},t.prototype.until=function(e,n){return sn(this._ctx,function(r,i,o){return e(r.value)?(i(o),n):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return sn(this._ctx,function(n){return e(n.value)}),ra(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&Ne(n,!0)&&n.limit>0)return this._read(function(i){var o=zt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:o,range:n.range}})}).then(function(i){var o=i.result;return o}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return sn(this._ctx,function(i){var o=i.primaryKey.toString(),a=te(r,o);return r[o]=!0,!a}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(i){var o;if(typeof e=="function")o=e;else{var a=N(e),u=a.length;o=function(g){for(var E=!1,b=0;b<u;++b){var w=a[b],m=e[w];ye(g,w)!==m&&(ae(g,w,m),E=!0)}return E}}var s=r.table.core,l=s.schema.primaryKey,c=l.outbound,f=l.extractKey,h=n.db._options.modifyChunkSize||200,v=[],p=0,d=[],y=function(g,E){var b=E.failures,w=E.numFailures;p+=g-w;for(var m=0,_=N(b);m<_.length;m++){var A=_[m];v.push(b[A])}};return n.clone().primaryKeys().then(function(g){var E=function(b){var w=Math.min(h,g.length-b);return s.getMany({trans:i,keys:g.slice(b,b+w),cache:"immutable"}).then(function(m){for(var _=[],A=[],k=c?[]:null,C=[],D=0;D<w;++D){var M=m[D],O={value:gt(M),primKey:g[b+D]};o.call(O,O.value,O)!==!1&&(O.value==null?C.push(g[b+D]):!c&&G(f(M),f(O.value))!==0?(C.push(g[b+D]),_.push(O.value)):(A.push(O.value),c&&k.push(g[b+D])))}var P=Ne(r)&&r.limit===1/0&&(typeof e!="function"||e===cn)&&{index:r.index,range:r.range};return Promise.resolve(_.length>0&&s.mutate({trans:i,type:"add",values:_}).then(function(V){for(var T in V.failures)C.splice(parseInt(T),1);y(_.length,V)})).then(function(){return(A.length>0||P&&typeof e=="object")&&s.mutate({trans:i,type:"put",keys:k,values:A,criteria:P,changeSpec:typeof e!="function"&&e}).then(function(V){return y(A.length,V)})}).then(function(){return(C.length>0||P&&e===cn)&&s.mutate({trans:i,type:"delete",keys:C,criteria:P}).then(function(V){return y(C.length,V)})}).then(function(){return g.length>b+w&&E(b+h)})})};return E(0).then(function(){if(v.length>0)throw new jt("Error modifying one or more objects",v,p,d);return g.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return Ne(e)&&(e.isPrimKey&&!ea||n.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,o=n;return e.table.core.count({trans:r,query:{index:i,range:o}}).then(function(a){return e.table.core.mutate({trans:r,type:"deleteRange",range:o}).then(function(u){var s=u.failures;u.lastResult,u.results;var l=u.numFailures;if(l)throw new jt("Could not delete some values",Object.keys(s).map(function(c){return s[c]}),a-l);return a-l})})}):this.modify(cn)},t}(),cn=function(t,e){return e.value=null};function ua(t){return kt(aa.prototype,function(n,r){this.db=t;var i=wi,o=null;if(r)try{i=r()}catch(l){o=l}var a=n._ctx,u=a.table,s=u.hook.reading.fire;this._ctx={table:u,index:a.index,isPrimKey:!a.index||u.schema.primKey.keyPath&&a.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:a.or,valueMapper:s!==_t?s:null}})}function sa(t,e){return t<e?-1:t===e?0:1}function la(t,e){return t>e?-1:t===e?0:1}function X(t,e,n){var r=t instanceof ki?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function je(t){return new t.Collection(t,function(){return Ei("")}).limit(0)}function ca(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function fa(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function ha(t,e,n,r,i,o){for(var a=Math.min(t.length,r.length),u=-1,s=0;s<a;++s){var l=e[s];if(l!==r[s])return i(t[s],n[s])<0?t.substr(0,s)+n[s]+n.substr(s+1):i(t[s],r[s])<0?t.substr(0,s)+r[s]+n.substr(s+1):u>=0?t.substr(0,u)+e[u]+n.substr(u+1):null;i(t[s],l)<0&&(u=s)}return a<r.length&&o==="next"?t+n.substr(t.length):a<t.length&&o==="prev"?t.substr(0,n.length):u<0?null:t.substr(0,u)+r[u]+n.substr(u+1)}function Tt(t,e,n,r){var i,o,a,u,s,l,c,f=n.length;if(!n.every(function(d){return typeof d=="string"}))return X(t,_i);function h(d){i=ca(d),o=fa(d),a=d==="next"?sa:la;var y=n.map(function(g){return{lower:o(g),upper:i(g)}}).sort(function(g,E){return a(g.lower,E.lower)});u=y.map(function(g){return g.upper}),s=y.map(function(g){return g.lower}),l=d,c=d==="next"?"":r}h("next");var v=new t.Collection(t,function(){return we(u[0],s[f-1]+r)});v._ondirectionchange=function(d){h(d)};var p=0;return v._addAlgorithm(function(d,y,g){var E=d.key;if(typeof E!="string")return!1;var b=o(E);if(e(b,s,p))return!0;for(var w=null,m=p;m<f;++m){var _=ha(E,b,u[m],s[m],a,l);_===null&&w===null?p=m+1:(w===null||a(w,_)>0)&&(w=_)}return y(w!==null?function(){d.continue(w+c)}:g),!1}),v}function we(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Ei(t){return{type:1,lower:t,upper:t}}var ki=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||i)&&!(r&&i)?je(this):new this.Collection(this,function(){return we(e,n,!r,!i)})}catch{return X(this,fe)}},t.prototype.equals=function(e){return e==null?X(this,fe):new this.Collection(this,function(){return Ei(e)})},t.prototype.above=function(e){return e==null?X(this,fe):new this.Collection(this,function(){return we(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?X(this,fe):new this.Collection(this,function(){return we(e,void 0,!1)})},t.prototype.below=function(e){return e==null?X(this,fe):new this.Collection(this,function(){return we(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?X(this,fe):new this.Collection(this,function(){return we(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?X(this,_i):this.between(e,e+De,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Tt(this,function(n,r){return n.indexOf(r[0])===0},[e],De)},t.prototype.equalsIgnoreCase=function(e){return Tt(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=de.apply(Ue,arguments);return e.length===0?je(this):Tt(this,function(n,r){return r.indexOf(n)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=de.apply(Ue,arguments);return e.length===0?je(this):Tt(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},e,De)},t.prototype.anyOf=function(){var e=this,n=de.apply(Ue,arguments),r=this._cmp;try{n.sort(r)}catch{return X(this,fe)}if(n.length===0)return je(this);var i=new this.Collection(this,function(){return we(n[0],n[n.length-1])});i._ondirectionchange=function(a){r=a==="next"?e._ascending:e._descending,n.sort(r)};var o=0;return i._addAlgorithm(function(a,u,s){for(var l=a.key;r(l,n[o])>0;)if(++o,o===n.length)return u(s),!1;return r(l,n[o])===0?!0:(u(function(){a.continue(n[o])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[Rn,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=de.apply(Ue,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return X(this,fe)}var n=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[Rn,i]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,i=this._cmp,o=this._ascending,a=this._descending,u=this._min,s=this._max;if(e.length===0)return je(this);if(!e.every(function(m){return m[0]!==void 0&&m[1]!==void 0&&o(m[0],m[1])<=0}))return X(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",K.InvalidArgument);var l=!n||n.includeLowers!==!1,c=n&&n.includeUppers===!0;function f(m,_){for(var A=0,k=m.length;A<k;++A){var C=m[A];if(i(_[0],C[1])<0&&i(_[1],C[0])>0){C[0]=u(C[0],_[0]),C[1]=s(C[1],_[1]);break}}return A===k&&m.push(_),m}var h=o;function v(m,_){return h(m[0],_[0])}var p;try{p=e.reduce(f,[]),p.sort(v)}catch{return X(this,fe)}var d=0,y=c?function(m){return o(m,p[d][1])>0}:function(m){return o(m,p[d][1])>=0},g=l?function(m){return a(m,p[d][0])>0}:function(m){return a(m,p[d][0])>=0};function E(m){return!y(m)&&!g(m)}var b=y,w=new this.Collection(this,function(){return we(p[0][0],p[p.length-1][1],!l,!c)});return w._ondirectionchange=function(m){m==="next"?(b=y,h=o):(b=g,h=a),p.sort(v)},w._addAlgorithm(function(m,_,A){for(var k=m.key;b(k);)if(++d,d===p.length)return _(A),!1;return E(k)?!0:(r._cmp(k,p[d][1])===0||r._cmp(k,p[d][0])===0||_(function(){h===o?m.continue(p[d][0]):m.continue(p[d][1])}),!1)}),w},t.prototype.startsWithAnyOf=function(){var e=de.apply(Ue,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?je(this):this.inAnyRange(e.map(function(n){return[n,n+De]})):X(this,"startsWithAnyOf() only works with strings")},t}();function da(t){return kt(ki.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:i};var o=t._deps.indexedDB;if(!o)throw new K.MissingAPI;this._cmp=this._ascending=o.cmp.bind(o),this._descending=function(a,u){return o.cmp(u,a)},this._max=function(a,u){return o.cmp(a,u)>0?a:u},this._min=function(a,u){return o.cmp(a,u)<0?a:u},this._IDBKeyRange=t._deps.IDBKeyRange})}function le(t){return L(function(e){return pt(e),t(e.target.error),!1})}function pt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var vt="storagemutated",ke="x-storagemutated-1",Se=Et(null,vt),pa=function(){function t(){}return t.prototype._lock=function(){return rt(!S.global),++this._reculock,this._reculock===1&&!S.global&&(S.lockOwnerFor=this),this},t.prototype._unlock=function(){if(rt(!S.global),--this._reculock===0)for(S.global||(S.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Ze(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&S.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(rt(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new K.DatabaseClosed(i);case"MissingAPIError":throw new K.MissingAPI(i.message,i);default:throw new K.OpenFailed(i)}if(!this.active)throw new K.TransactionInactive;return rt(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=L(function(o){pt(o),n._reject(e.error)}),e.onabort=L(function(o){pt(o),n.active&&n._reject(new K.Abort(e.error)),n.active=!1,n.on("abort").fire(o)}),e.oncomplete=L(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&Se.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return j(new K.ReadOnly("Transaction is readonly"));if(!this.active)return j(new K.TransactionInactive);if(this._locked())return new x(function(a,u){i._blockedFuncs.push([function(){i._promise(e,n,r).then(a,u)},S])});if(r)return Ae(function(){var a=new x(function(u,s){i._lock();var l=n(u,s,i);l&&l.then&&l.then(u,s)});return a.finally(function(){return i._unlock()}),a._lib=!0,a});var o=new x(function(a,u){var s=n(a,u,i);s&&s.then&&s.then(a,u)});return o._lib=!0,o},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=x.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=a)})()}var o=n._waitingFor;return new x(function(a,u){r.then(function(s){return n._waitingQueue.push(L(a.bind(null,s)))},function(s){return n._waitingQueue.push(L(u.bind(null,s)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new K.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(te(n,e))return n[e];var r=this.schema[e];if(!r)throw new K.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i},t}();function va(t){return kt(pa.prototype,function(n,r,i,o,a){var u=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=Et(this,"complete","error","abort"),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new x(function(s,l){u._resolve=s,u._reject=l}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var l=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):l&&u.idbtrans&&u.idbtrans.abort(),j(s)})})}function Pn(t,e,n,r,i,o,a){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+xi(e)}}function xi(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Ai(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:ni(n,function(r){return[r.name,r]})}}function ya(t){return t.length===1?t[0]:t}var yt=function(t){try{return t.only([[]]),yt=function(){return[[]]},[[]]}catch{return yt=function(){return De},De}};function Mn(t){return t==null?function(){}:typeof t=="string"?ma(t):function(e){return ye(e,t)}}function ma(t){var e=t.split(".");return e.length===1?function(n){return n[t]}:function(n){return ye(n,t)}}function Ir(t){return[].slice.call(t)}var ga=0;function st(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function _a(t,e,n){function r(f,h){var v=Ir(f.objectStoreNames);return{schema:{name:f.name,tables:v.map(function(p){return h.objectStore(p)}).map(function(p){var d=p.keyPath,y=p.autoIncrement,g=H(d),E=d==null,b={},w={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E,compound:g,keyPath:d,autoIncrement:y,unique:!0,extractKey:Mn(d)},indexes:Ir(p.indexNames).map(function(m){return p.index(m)}).map(function(m){var _=m.name,A=m.unique,k=m.multiEntry,C=m.keyPath,D=H(C),M={name:_,compound:D,keyPath:C,unique:A,multiEntry:k,extractKey:Mn(C)};return b[st(C)]=M,M}),getIndexByKeyPath:function(m){return b[st(m)]}};return b[":id"]=w.primaryKey,d!=null&&(b[st(d)]=w.primaryKey),w})},hasGetAll:v.length>0&&"getAll"in h.objectStore(v[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(f){if(f.type===3)return null;if(f.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var h=f.lower,v=f.upper,p=f.lowerOpen,d=f.upperOpen,y=h===void 0?v===void 0?null:e.upperBound(v,!!d):v===void 0?e.lowerBound(h,!!p):e.bound(h,v,!!p,!!d);return y}function o(f){var h=f.name;function v(y){var g=y.trans,E=y.type,b=y.keys,w=y.values,m=y.range;return new Promise(function(_,A){_=L(_);var k=g.objectStore(h),C=k.keyPath==null,D=E==="put"||E==="add";if(!D&&E!=="delete"&&E!=="deleteRange")throw new Error("Invalid operation type: "+E);var M=(b||w||{length:1}).length;if(b&&w&&b.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(M===0)return _({numFailures:0,failures:{},results:[],lastResult:void 0});var O,P=[],V=[],T=0,ne=function(se){++T,pt(se)};if(E==="deleteRange"){if(m.type===4)return _({numFailures:T,failures:V,results:[],lastResult:void 0});m.type===3?P.push(O=k.clear()):P.push(O=k.delete(i(m)))}else{var ie=D?C?[w,b]:[w,null]:[b,null],_e=ie[0],ue=ie[1];if(D)for(var re=0;re<M;++re)P.push(O=ue&&ue[re]!==void 0?k[E](_e[re],ue[re]):k[E](_e[re])),O.onerror=ne;else for(var re=0;re<M;++re)P.push(O=k[E](_e[re])),O.onerror=ne}var be=function(se){var et=se.target.result;P.forEach(function(oe,xt){return oe.error!=null&&(V[xt]=oe.error)}),_({numFailures:T,failures:V,results:E==="delete"?b:P.map(function(oe){return oe.result}),lastResult:et})};O.onerror=function(se){ne(se),be(se)},O.onsuccess=be})}function p(y){var g=y.trans,E=y.values,b=y.query,w=y.reverse,m=y.unique;return new Promise(function(_,A){_=L(_);var k=b.index,C=b.range,D=g.objectStore(h),M=k.isPrimaryKey?D:D.index(k.name),O=w?m?"prevunique":"prev":m?"nextunique":"next",P=E||!("openKeyCursor"in M)?M.openCursor(i(C),O):M.openKeyCursor(i(C),O);P.onerror=le(A),P.onsuccess=L(function(V){var T=P.result;if(!T){_(null);return}T.___id=++ga,T.done=!1;var ne=T.continue.bind(T),ie=T.continuePrimaryKey;ie&&(ie=ie.bind(T));var _e=T.advance.bind(T),ue=function(){throw new Error("Cursor not started")},re=function(){throw new Error("Cursor not stopped")};T.trans=g,T.stop=T.continue=T.continuePrimaryKey=T.advance=ue,T.fail=L(A),T.next=function(){var be=this,se=1;return this.start(function(){return se--?be.continue():be.stop()}).then(function(){return be})},T.start=function(be){var se=new Promise(function(oe,xt){oe=L(oe),P.onerror=le(xt),T.fail=xt,T.stop=function(Ri){T.stop=T.continue=T.continuePrimaryKey=T.advance=re,oe(Ri)}}),et=function(){if(P.result)try{be()}catch(oe){T.fail(oe)}else T.done=!0,T.start=function(){throw new Error("Cursor behind last entry")},T.stop()};return P.onsuccess=L(function(oe){P.onsuccess=et,et()}),T.continue=ne,T.continuePrimaryKey=ie,T.advance=_e,et(),se},_(T)},A)})}function d(y){return function(g){return new Promise(function(E,b){E=L(E);var w=g.trans,m=g.values,_=g.limit,A=g.query,k=_===1/0?void 0:_,C=A.index,D=A.range,M=w.objectStore(h),O=C.isPrimaryKey?M:M.index(C.name),P=i(D);if(_===0)return E({result:[]});if(y){var V=m?O.getAll(P,k):O.getAllKeys(P,k);V.onsuccess=function(_e){return E({result:_e.target.result})},V.onerror=le(b)}else{var T=0,ne=m||!("openKeyCursor"in O)?O.openCursor(P):O.openKeyCursor(P),ie=[];ne.onsuccess=function(_e){var ue=ne.result;if(!ue)return E({result:ie});if(ie.push(m?ue.value:ue.primaryKey),++T===_)return E({result:ie});ue.continue()},ne.onerror=le(b)}})}}return{name:h,schema:f,mutate:v,getMany:function(y){var g=y.trans,E=y.keys;return new Promise(function(b,w){b=L(b);for(var m=g.objectStore(h),_=E.length,A=new Array(_),k=0,C=0,D,M=function(T){var ne=T.target;(A[ne._pos]=ne.result)!=null,++C===k&&b(A)},O=le(w),P=0;P<_;++P){var V=E[P];V!=null&&(D=m.get(E[P]),D._pos=P,D.onsuccess=M,D.onerror=O,++k)}k===0&&b(A)})},get:function(y){var g=y.trans,E=y.key;return new Promise(function(b,w){b=L(b);var m=g.objectStore(h),_=m.get(E);_.onsuccess=function(A){return b(A.target.result)},_.onerror=le(w)})},query:d(s),openCursor:p,count:function(y){var g=y.query,E=y.trans,b=g.index,w=g.range;return new Promise(function(m,_){var A=E.objectStore(h),k=b.isPrimaryKey?A:A.index(b.name),C=i(w),D=C?k.count(C):k.count();D.onsuccess=L(function(M){return m(M.target.result)}),D.onerror=le(_)})}}}var a=r(t,n),u=a.schema,s=a.hasGetAll,l=u.tables.map(function(f){return o(f)}),c={};return l.forEach(function(f){return c[f.name]=f}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(f){var h=c[f];if(!h)throw new Error("Table '"+f+"' not found");return c[f]},MIN_KEY:-1/0,MAX_KEY:yt(e),schema:u}}function ba(t,e){return e.reduce(function(n,r){var i=r.create;return I(I({},n),i(n))},t)}function wa(t,e,n,r){var i=n.IDBKeyRange;n.indexedDB;var o=ba(_a(e,i,r),t.dbcore);return{dbcore:o}}function tr(t,e){var n=t._novip,r=e.db,i=wa(n._middlewares,r,n._deps,e);n.core=i.dbcore,n.tables.forEach(function(o){var a=o.name;n.core.schema.tables.some(function(u){return u.name===a})&&(o.core=n.core.table(a),n[a]instanceof n.Table&&(n[a].core=o.core))})}function Gt(t,e,n,r){var i=t._novip;n.forEach(function(o){var a=r[o];e.forEach(function(u){var s=Hn(u,o);(!s||"value"in s&&s.value===void 0)&&(u===i.Transaction.prototype||u instanceof i.Transaction?me(u,o,{get:function(){return this.table(o)},set:function(l){Zr(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):u[o]=new i.Table(o,a))})})}function On(t,e){var n=t._novip;e.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Ea(t,e){return t._cfg.version-e._cfg.version}function ka(t,e,n,r){var i=t._dbSchema,o=t._createTransaction("readwrite",t._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),u=S.transless||S;Ae(function(){S.trans=o,S.transless=u,e===0?(N(i).forEach(function(s){nr(n,s,i[s].primKey,i[s].indexes)}),tr(t,n),x.follow(function(){return t.on.populate.fire(o)}).catch(a)):xa(t,e,o,n).catch(a)})}function xa(t,e,n,r){var i=t._novip,o=[],a=i._versions,u=i._dbSchema=rr(i,i.idbdb,r),s=!1,l=a.filter(function(f){return f._cfg.version>=e});l.forEach(function(f){o.push(function(){var h=u,v=f._cfg.dbschema;Fn(i,h,r),Fn(i,v,r),u=i._dbSchema=v;var p=Ci(h,v);p.add.forEach(function(w){nr(r,w[0],w[1].primKey,w[1].indexes)}),p.change.forEach(function(w){if(w.recreate)throw new K.Upgrade("Not yet support for changing primary key");var m=r.objectStore(w.name);w.add.forEach(function(_){return Bn(m,_)}),w.change.forEach(function(_){m.deleteIndex(_.name),Bn(m,_)}),w.del.forEach(function(_){return m.deleteIndex(_)})});var d=f._cfg.contentUpgrade;if(d&&f._cfg.version>e){tr(i,r),n._memoizedTables={},s=!0;var y=ri(v);p.del.forEach(function(w){y[w]=h[w]}),On(i,[i.Transaction.prototype]),Gt(i,[i.Transaction.prototype],N(y),y),n.schema=y;var g=Yn(d);g&&Je();var E,b=x.follow(function(){if(E=d(n),E&&g){var w=ge.bind(null,null);E.then(w,w)}});return E&&typeof E.then=="function"?x.resolve(E):b.then(function(){return E})}}),o.push(function(h){if(!s||!Zo){var v=f._cfg.dbschema;Ca(v,h)}On(i,[i.Transaction.prototype]),Gt(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function c(){return o.length?x.resolve(o.shift()(n.idbtrans)).then(c):x.resolve()}return c().then(function(){Aa(u,r)})}function Ci(t,e){var n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],o=e[r];if(!i)n.add.push([r,o]);else{var a={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!Zt)a.recreate=!0,n.change.push(a);else{var u=i.idxByName,s=o.idxByName,l=void 0;for(l in u)s[l]||a.del.push(l);for(l in s){var c=u[l],f=s[l];c?c.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}}return n}function nr(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return Bn(i,o)}),i}function Aa(t,e){N(t).forEach(function(n){e.db.objectStoreNames.contains(n)||nr(e,n,t[n].primKey,t[n].indexes)})}function Ca(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return t[n]==null&&e.db.deleteObjectStore(n)})}function Bn(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function rr(t,e,n){var r={},i=Xt(e.objectStoreNames,0);return i.forEach(function(o){for(var a=n.objectStore(o),u=a.keyPath,s=Pn(xi(u),u||"",!1,!1,!!a.autoIncrement,u&&typeof u!="string",!0),l=[],c=0;c<a.indexNames.length;++c){var f=a.index(a.indexNames[c]);u=f.keyPath;var h=Pn(f.name,u,!!f.unique,!!f.multiEntry,!1,u&&typeof u!="string",!1);l.push(h)}r[o]=Ai(o,s,l)}),r}function Sa(t,e,n){var r=t._novip;r.verno=e.version/10;var i=r._dbSchema=rr(r,e,n);r._storeNames=Xt(e.objectStoreNames,0),Gt(r,[r._allTables],N(i),i)}function Ka(t,e){var n=rr(t,t.idbdb,e),r=Ci(n,t._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function Fn(t,e,n){for(var r=t._novip,i=n.db.objectStoreNames,o=0;o<i.length;++o){var a=i[o],u=n.objectStore(a);r._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var l=u.indexNames[s],c=u.index(l).keyPath,f=typeof c=="string"?c:"["+Xt(c).join("+")+"]";if(e[a]){var h=e[a].idxByName[f];h&&(h.name=l,delete e[a].idxByName[f],e[a].idxByName[l]=h)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&z.WorkerGlobalScope&&z instanceof z.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Da(t){return t.split(",").map(function(e,n){e=e.trim();var r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Pn(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),H(i),n===0)})}var Ta=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){N(e).forEach(function(r){if(e[r]!==null){var i=Da(e[r]),o=i.shift();if(o.multi)throw new K.Schema("Primary key cannot be multi-valued");i.forEach(function(a){if(a.auto)throw new K.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new K.Schema("Index must have a name and cannot be an empty string")}),n[r]=Ai(r,o,i)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?Q(this._cfg.storesSource,e):e;var r=n._versions,i={},o={};return r.forEach(function(a){Q(i,a._cfg.storesSource),o=a._cfg.dbschema={},a._parseStoresSpec(i,o)}),n._dbSchema=o,On(n,[n._allTables,n,n.Transaction.prototype]),Gt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],N(o),o),n._storeNames=N(o),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Qn(this._cfg.contentUpgrade||F,e),this},t}();function Ia(t){return kt(Ta.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function ir(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new sr(en,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function or(t){return t&&typeof t.databases=="function"}function Ra(t){var e=t.indexedDB,n=t.IDBKeyRange;return or(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==en})}):ir(e,n).toCollection().primaryKeys()}function Pa(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!or(n)&&e!==en&&ir(n,r).put({name:e}).catch(F)}function Ma(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!or(n)&&e!==en&&ir(n,r).delete(e).catch(F)}function $n(t){return Ae(function(){return S.letThrough=!0,t()})}function Oa(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function Ba(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?j(e.dbOpenError):t});ce&&(e.openCanceller._stackHolder=Le()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new K.DatabaseClosed("db.open() was cancelled")}var o=e.dbReadyResolve,a=null,u=!1;return x.race([r,(typeof navigator=="undefined"?x.resolve():Oa()).then(function(){return new x(function(s,l){if(i(),!n)throw new K.MissingAPI;var c=t.name,f=e.autoSchema?n.open(c):n.open(c,Math.round(t.verno*10));if(!f)throw new K.MissingAPI;f.onerror=le(l),f.onblocked=L(t._fireOnBlocked),f.onupgradeneeded=L(function(h){if(a=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=pt,a.abort(),f.result.close();var v=n.deleteDatabase(c);v.onsuccess=v.onerror=L(function(){l(new K.NoSuchDatabase("Database "+c+" doesnt exist"))})}else{a.onerror=le(l);var p=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;u=p<1,t._novip.idbdb=f.result,ka(t,p/10,a,l)}},l),f.onsuccess=L(function(){a=null;var h=t._novip.idbdb=f.result,v=Xt(h.objectStoreNames);if(v.length>0)try{var p=h.transaction(ya(v),"readonly");e.autoSchema?Sa(t,h,p):(Fn(t,t._dbSchema,p),Ka(t,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),tr(t,p)}catch{}ut.push(t),h.onversionchange=L(function(d){e.vcFired=!0,t.on("versionchange").fire(d)}),h.onclose=L(function(d){t.on("close").fire(d)}),u&&Pa(t._deps,c),s()},l)})})]).then(function(){return i(),e.onReadyBeingFired=[],x.resolve($n(function(){return t.on.ready.fire(t.vip)})).then(function s(){if(e.onReadyBeingFired.length>0){var l=e.onReadyBeingFired.reduce(Qn,F);return e.onReadyBeingFired=[],x.resolve($n(function(){return l(t.vip)})).then(s)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(s){e.dbOpenError=s;try{a&&a.abort()}catch{}return r===e.openCanceller&&t._close(),j(s)}).finally(function(){e.openComplete=!0,o()})}function zn(t){var e=function(a){return t.next(a)},n=function(a){return t.throw(a)},r=o(e),i=o(n);function o(a){return function(u){var s=a(u),l=s.value;return s.done?l:!l||typeof l.then!="function"?H(l)?Promise.all(l).then(r,i):r(l):l.then(r,i)}}return o(e)()}function Fa(t,e,n){var r=arguments.length;if(r<2)throw new K.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=ii(i);return[t,o,n]}function Si(t,e,n,r,i){return x.resolve().then(function(){var o=S.transless||S,a=t._createTransaction(e,n,t._dbSchema,r),u={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(f){return f.name===qn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Si(t,e,n,null,i)})):j(f)}var s=Yn(i);s&&Je();var l,c=x.follow(function(){if(l=i.call(a,a),l)if(s){var f=ge.bind(null,null);l.then(f,f)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=zn(l))},u);return(l&&typeof l.then=="function"?x.resolve(l).then(function(f){return a.active?f:j(new K.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):c.then(function(){return l})).then(function(f){return r&&a._resolve(),a._completion.then(function(){return f})}).catch(function(f){return a._reject(f),j(f)})})}function It(t,e,n){for(var r=H(t)?t.slice():[t],i=0;i<n;++i)r.push(e);return r}function $a(t){return I(I({},t),{table:function(e){var n=t.table(e),r=n.schema,i={},o=[];function a(d,y,g){var E=st(d),b=i[E]=i[E]||[],w=d==null?0:typeof d=="string"?1:d.length,m=y>0,_=I(I({},g),{isVirtual:m,keyTail:y,keyLength:w,extractKey:Mn(d),unique:!m&&g.unique});if(b.push(_),_.isPrimaryKey||o.push(_),w>1){var A=w===2?d[0]:d.slice(0,w-1);a(A,y+1,g)}return b.sort(function(k,C){return k.keyTail-C.keyTail}),_}var u=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,l=r.indexes;s<l.length;s++){var c=l[s];a(c.keyPath,0,c)}function f(d){var y=i[st(d)];return y&&y[0]}function h(d,y){return{type:d.type===1?2:d.type,lower:It(d.lower,d.lowerOpen?t.MAX_KEY:t.MIN_KEY,y),lowerOpen:!0,upper:It(d.upper,d.upperOpen?t.MIN_KEY:t.MAX_KEY,y),upperOpen:!0}}function v(d){var y=d.query.index;return y.isVirtual?I(I({},d),{query:{index:y,range:h(d.query.range,y.keyTail)}}):d}var p=I(I({},n),{schema:I(I({},r),{primaryKey:u,indexes:o,getIndexByKeyPath:f}),count:function(d){return n.count(v(d))},query:function(d){return n.query(v(d))},openCursor:function(d){var y=d.query.index,g=y.keyTail,E=y.isVirtual,b=y.keyLength;if(!E)return n.openCursor(d);function w(m){function _(k){k!=null?m.continue(It(k,d.reverse?t.MAX_KEY:t.MIN_KEY,g)):d.unique?m.continue(m.key.slice(0,b).concat(d.reverse?t.MIN_KEY:t.MAX_KEY,g)):m.continue()}var A=Object.create(m,{continue:{value:_},continuePrimaryKey:{value:function(k,C){m.continuePrimaryKey(It(k,t.MAX_KEY,g),C)}},primaryKey:{get:function(){return m.primaryKey}},key:{get:function(){var k=m.key;return b===1?k[0]:k.slice(0,b)}},value:{get:function(){return m.value}}});return A}return n.openCursor(v(d)).then(function(m){return m&&w(m)})}});return p}})}var za={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:$a};function ar(t,e,n,r){return n=n||{},r=r||"",N(t).forEach(function(i){if(!te(e,i))n[r+i]=void 0;else{var o=t[i],a=e[i];if(typeof o=="object"&&typeof a=="object"&&o&&a){var u=bn(o),s=bn(a);u!==s?n[r+i]=e[i]:u==="Object"?ar(o,a,n,r+i+"."):o!==a&&(n[r+i]=e[i])}else o!==a&&(n[r+i]=e[i])}}),N(e).forEach(function(i){te(t,i)||(n[r+i]=e[i])}),n}function La(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var Na={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return I(I({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,i=I(I({},n),{mutate:function(o){var a=S.trans,u=a.table(e).hook,s=u.deleting,l=u.creating,c=u.updating;switch(o.type){case"add":if(l.fire===F)break;return a._promise("readwrite",function(){return f(o)},!0);case"put":if(l.fire===F&&c.fire===F)break;return a._promise("readwrite",function(){return f(o)},!0);case"delete":if(s.fire===F)break;return a._promise("readwrite",function(){return f(o)},!0);case"deleteRange":if(s.fire===F)break;return a._promise("readwrite",function(){return h(o)},!0)}return n.mutate(o);function f(p){var d=S.trans,y=p.keys||La(r,p);if(!y)throw new Error("Keys missing");return p=p.type==="add"||p.type==="put"?I(I({},p),{keys:y}):I({},p),p.type!=="delete"&&(p.values=gn([],p.values,!0)),p.keys&&(p.keys=gn([],p.keys,!0)),ja(n,p,y).then(function(g){var E=y.map(function(b,w){var m=g[w],_={onerror:null,onsuccess:null};if(p.type==="delete")s.fire.call(_,b,m,d);else if(p.type==="add"||m===void 0){var A=l.fire.call(_,b,p.values[w],d);b==null&&A!=null&&(b=A,p.keys[w]=b,r.outbound||ae(p.values[w],r.keyPath,b))}else{var k=ar(m,p.values[w]),C=c.fire.call(_,k,b,m,d);if(C){var D=p.values[w];Object.keys(C).forEach(function(M){te(D,M)?D[M]=C[M]:ae(D,M,C[M])})}}return _});return n.mutate(p).then(function(b){for(var w=b.failures,m=b.results,_=b.numFailures,A=b.lastResult,k=0;k<y.length;++k){var C=m?m[k]:y[k],D=E[k];C==null?D.onerror&&D.onerror(w[k]):D.onsuccess&&D.onsuccess(p.type==="put"&&g[k]?p.values[k]:C)}return{failures:w,results:m,numFailures:_,lastResult:A}}).catch(function(b){return E.forEach(function(w){return w.onerror&&w.onerror(b)}),Promise.reject(b)})})}function h(p){return v(p.trans,p.range,1e4)}function v(p,d,y){return n.query({trans:p,values:!1,query:{index:r,range:d},limit:y}).then(function(g){var E=g.result;return f({type:"delete",keys:E,trans:p}).then(function(b){return b.numFailures>0?Promise.reject(b.failures[0]):E.length<y?{failures:[],numFailures:0,lastResult:void 0}:v(p,I(I({},d),{lower:E[E.length-1],lowerOpen:!0}),y)})})}}});return i}})}};function ja(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function Ki(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],i=0,o=0;i<e.keys.length&&o<t.length;++i)G(e.keys[i],t[o])===0&&(r.push(n?gt(e.values[i]):e.values[i]),++o);return r.length===t.length?r:null}catch{return null}}var Ua={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return I(I({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Ki(r.keys,r.trans._cache,r.cache==="clone");return i?x.resolve(i):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?gt(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},fn;function ur(t){return!("from"in t)}var he=function(t,e){if(this)Q(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var n=new he;return t&&"d"in t&&Q(n,t),n}};Ge(he.prototype,(fn={add:function(t){return qt(this,t),this},addKey:function(t){return mt(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return mt(e,n,n)}),this}},fn[wn]=function(){return Ln(this)},fn));function mt(t,e,n){var r=G(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(ur(t))return Q(t,{from:e,to:n,d:1});var i=t.l,o=t.r;if(G(n,t.from)<0)return i?mt(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Rr(t);if(G(e,t.to)>0)return o?mt(o,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Rr(t);G(e,t.from)<0&&(t.from=e,t.l=null,t.d=o?o.d+1:1),G(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var a=!t.r;i&&!t.l&&qt(t,i),o&&a&&qt(t,o)}}function qt(t,e){function n(r,i){var o=i.from,a=i.to,u=i.l,s=i.r;mt(r,o,a),u&&n(r,u),s&&n(r,s)}ur(e)||n(t,e)}function Va(t,e){var n=Ln(e),r=n.next();if(r.done)return!1;for(var i=r.value,o=Ln(t),a=o.next(i.from),u=a.value;!r.done&&!a.done;){if(G(u.from,i.to)<=0&&G(u.to,i.from)>=0)return!0;G(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(a=o.next(i.from)).value}return!1}function Ln(t){var e=ur(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&G(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||G(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Rr(t){var e,n,r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var o=i==="r"?"l":"r",a=I({},t),u=t[i];t.from=u.from,t.to=u.to,t[i]=u[i],a[i]=u[o],t[o]=a,a.d=Pr(a)}t.d=Pr(t)}function Pr(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}var Wa={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new he(t.MIN_KEY,t.MAX_KEY);return I(I({},t),{table:function(r){var i=t.table(r),o=i.schema,a=o.primaryKey,u=a.extractKey,s=a.outbound,l=I(I({},i),{mutate:function(h){var v=h.trans,p=v.mutatedParts||(v.mutatedParts={}),d=function(A){var k="idb://"+e+"/"+r+"/"+A;return p[k]||(p[k]=new he)},y=d(""),g=d(":dels"),E=h.type,b=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[],w=b[0],m=b[1],_=h.trans._cache;return i.mutate(h).then(function(A){if(H(w)){E!=="delete"&&(w=A.results),y.addKeys(w);var k=Ki(w,_);!k&&E!=="add"&&g.addKeys(w),(k||m)&&Ha(d,o,k,m)}else if(w){var C={from:w.lower,to:w.upper};g.add(C),y.add(C)}else y.add(n),g.add(n),o.indexes.forEach(function(D){return d(D.name).add(n)});return A})}}),c=function(h){var v,p,d=h.query,y=d.index,g=d.range;return[y,new he((v=g.lower)!==null&&v!==void 0?v:t.MIN_KEY,(p=g.upper)!==null&&p!==void 0?p:t.MAX_KEY)]},f={get:function(h){return[a,new he(h.key)]},getMany:function(h){return[a,new he().addKeys(h.keys)]},count:c,query:c,openCursor:c};return N(f).forEach(function(h){l[h]=function(v){var p=S.subscr;if(p){var d=function(_){var A="idb://"+e+"/"+r+"/"+_;return p[A]||(p[A]=new he)},y=d(""),g=d(":dels"),E=f[h](v),b=E[0],w=E[1];if(d(b.name||"").add(w),!b.isPrimaryKey)if(h==="count")g.add(n);else{var m=h==="query"&&s&&v.values&&i.query(I(I({},v),{values:!1}));return i[h].apply(this,arguments).then(function(_){if(h==="query"){if(s&&v.values)return m.then(function(D){var M=D.result;return y.addKeys(M),_});var A=v.values?_.result.map(u):_.result;v.values?y.addKeys(A):g.addKeys(A)}else if(h==="openCursor"){var k=_,C=v.values;return k&&Object.create(k,{key:{get:function(){return g.addKey(k.primaryKey),k.key}},primaryKey:{get:function(){var D=k.primaryKey;return g.addKey(D),D}},value:{get:function(){return C&&y.addKey(k.primaryKey),k.value}}})}return _})}}return i[h].apply(this,arguments)}}),l}})}};function Ha(t,e,n,r){function i(o){var a=t(o.name||"");function u(l){return l!=null?o.extractKey(l):null}var s=function(l){return o.multiEntry&&H(l)?l.forEach(function(c){return a.addKey(c)}):a.addKey(l)};(n||r).forEach(function(l,c){var f=n&&u(n[c]),h=r&&u(r[c]);G(f,h)!==0&&(f!=null&&s(f),h!=null&&s(h))})}e.indexes.forEach(i)}var sr=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=n=I({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var o=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:F,dbReadyPromise:null,cancelOpen:F,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};a.dbReadyPromise=new x(function(u){a.dbReadyResolve=u}),a.openCanceller=new x(function(u,s){a.cancelOpen=s}),this._state=a,this.name=e,this.on=Et(this,"populate","blocked","versionchange","close",{ready:[Qn,F]}),this.on.ready.subscribe=ei(this.on.ready.subscribe,function(u){return function(s,l){t.vip(function(){var c=r._state;if(c.openComplete)c.dbOpenError||x.resolve().then(s),l&&u(s);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(s),l&&u(s);else{u(s);var f=r;l||u(function h(){f.on.ready.unsubscribe(s),f.on.ready.unsubscribe(h)})}})}}),this.Collection=ua(this),this.Table=na(this),this.Transaction=va(this),this.Version=Ia(this),this.WhereClause=da(this),this.on("versionchange",function(u){u.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+u.oldVersion/10)}),this._maxKey=yt(n.IDBKeyRange),this._createTransaction=function(u,s,l,c){return new r.Transaction(u,s,l,r._options.chromeTransactionDurability,c)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),ut.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(u)})},this.use(za),this.use(Na),this.use(Wa),this.use(Ua),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(function(u){return u(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new K.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new K.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(Ea),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||S.letThrough||this._vip)?e():new x(function(r,i){if(n._state.openComplete)return i(new K.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new K.DatabaseClosed);return}n.open().catch(F)}n._state.dbReadyPromise.then(r,i)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,i=e.level,o=e.name;o&&this.unuse({stack:n,name:o});var a=this._middlewares[n]||(this._middlewares[n]=[]);return a.push({stack:n,create:r,level:i==null?10:i,name:o}),a.sort(function(u,s){return u.level-s.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,i=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(o){return i?o.create!==i:r?o.name!==r:!1})),this},t.prototype.open=function(){return Ba(this)},t.prototype._close=function(){var e=this._state,n=ut.indexOf(this);if(n>=0&&ut.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new x(function(r){e.dbReadyResolve=r}),e.openCanceller=new x(function(r,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new K.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new x(function(i,o){var a=function(){e.close();var u=e._deps.indexedDB.deleteDatabase(e.name);u.onsuccess=L(function(){Ma(e._deps,e.name),i()}),u.onerror=le(o),u.onblocked=e._fireOnBlocked};if(n)throw new K.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return N(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=Fa.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var i=this,o=S.trans;(!o||o.db!==this||e.indexOf("!")!==-1)&&(o=null);var a=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var u,s;try{if(s=n.map(function(c){var f=c instanceof i.Table?c.name:c;if(typeof f!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return f}),e=="r"||e===an)u=an;else if(e=="rw"||e==un)u=un;else throw new K.InvalidArgument("Invalid transaction mode: "+e);if(o){if(o.mode===an&&u===un)if(a)o=null;else throw new K.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o&&s.forEach(function(c){if(o&&o.storeNames.indexOf(c)===-1)if(a)o=null;else throw new K.SubTransaction("Table "+c+" not included in parent transaction.")}),a&&o&&!o.active&&(o=null)}}catch(c){return o?o._promise(null,function(f,h){h(c)}):j(c)}var l=Si.bind(null,this,u,s,o,r);return o?o._promise(u,l,"lock"):S.trans?Ze(S.transless,function(){return i._whenReady(l)}):this._whenReady(l)},t.prototype.table=function(e){if(!te(this._allTables,e))throw new K.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),Ya=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",Ga=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)},t.prototype[Ya]=function(){return this},t}();function Di(t,e){return N(e).forEach(function(n){var r=t[n]||(t[n]=new he);qt(r,e[n])}),t}function Ti(t){return new Ga(function(e){var n=Yn(t);function r(v){n&&Je();var p=function(){return Ae(t,{subscr:v,trans:null})},d=S.trans?Ze(S.transless,p):p();return n&&d.then(ge,ge),d}var i=!1,o={},a={},u={get closed(){return i},unsubscribe:function(){i=!0,Se.storagemutated.unsubscribe(f)}};e.start&&e.start(u);var s=!1,l=!1;function c(){return N(a).some(function(v){return o[v]&&Va(o[v],a[v])})}var f=function(v){Di(o,v),c()&&h()},h=function(){if(!(s||i)){o={};var v={},p=r(v);l||(Se(vt,f),l=!0),s=!0,Promise.resolve(p).then(function(d){s=!1,!i&&(c()?h():(o={},a=v,e.next&&e.next(d)))},function(d){s=!1,e.error&&e.error(d),u.unsubscribe()})}};return h(),u})}var Nn;try{Nn={indexedDB:z.indexedDB||z.mozIndexedDB||z.webkitIndexedDB||z.msIndexedDB,IDBKeyRange:z.IDBKeyRange||z.webkitIDBKeyRange}}catch{Nn={indexedDB:null,IDBKeyRange:null}}var Ke=sr;Ge(Ke,I(I({},Jt),{delete:function(t){var e=new Ke(t,{addons:[]});return e.delete()},exists:function(t){return new Ke(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return Ra(Ke.dependencies).then(t)}catch{return j(new K.MissingAPI)}},defineClass:function(){function t(e){Q(this,e)}return t},ignoreTransaction:function(t){return S.trans?Ze(S.transless,t):t()},vip:$n,async:function(t){return function(){try{var e=zn(t.apply(this,arguments));return!e||typeof e.then!="function"?x.resolve(e):e}catch(n){return j(n)}}},spawn:function(t,e,n){try{var r=zn(t.apply(n,e||[]));return!r||typeof r.then!="function"?x.resolve(r):r}catch(i){return j(i)}},currentTransaction:{get:function(){return S.trans||null}},waitFor:function(t,e){var n=x.resolve(typeof t=="function"?Ke.ignoreTransaction(t):t).timeout(e||6e4);return S.trans?S.trans.waitFor(n):n},Promise:x,debug:{get:function(){return ce},set:function(t){ai(t,t==="dexie"?function(){return!0}:bi)}},derive:Qe,extend:Q,props:Ge,override:ei,Events:Et,on:Se,liveQuery:Ti,extendObservabilitySet:Di,getByKeyPath:ye,setByKeyPath:ae,delByKeyPath:So,shallowClone:ri,deepClone:gt,getObjectDiff:ar,cmp:G,asap:ti,minKey:Rn,addons:[],connections:ut,errnames:qn,dependencies:Nn,semVer:Cr,version:Cr.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,n*2)})}));Ke.maxKey=yt(Ke.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(Se(vt,function(t){if(!ve){var e;Zt?(e=document.createEvent("CustomEvent"),e.initCustomEvent(ke,!0,!0,t)):e=new CustomEvent(ke,{detail:t}),ve=!0,dispatchEvent(e),ve=!1}}),addEventListener(ke,function(t){var e=t.detail;ve||Qt(e)}));function Qt(t){var e=ve;try{ve=!0,Se.storagemutated.fire(t)}finally{ve=e}}var ve=!1;if(typeof BroadcastChannel!="undefined"){var Mr=new BroadcastChannel(ke);Se(vt,function(t){ve||Mr.postMessage(t)}),Mr.onmessage=function(t){t.data&&Qt(t.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){Se(vt,function(t){try{ve||(typeof localStorage!="undefined"&&localStorage.setItem(ke,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&gn([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:ke,changedParts:t})}))}catch{}}),typeof addEventListener!="undefined"&&addEventListener("storage",function(t){if(t.key===ke){var e=JSON.parse(t.newValue);e&&Qt(e.changedParts)}});var Or=self.document&&navigator.serviceWorker;Or&&Or.addEventListener("message",qa)}function qa(t){var e=t.data;e&&e.type===ke&&Qt(e.changedParts)}x.rejectionMapper=Bo;ai(ce,bi);class Qa extends sr{constructor(){super("MemoryGame");lr(this,"completedGames");this.version(1).stores({completedGames:"++id, itemCount, moveCount"})}}const Ii=new Qa;function Br(t,e,n){const r=t.slice();return r[5]=e[n],r[7]=n,r}function Xa(t){let e=[],n=new Map,r,i=Object.keys(t[1]).sort(t[2]);const o=a=>a[7];for(let a=0;a<i.length;a+=1){let u=Br(t,i,a),s=o(u);n.set(s,e[a]=Fr(s,u))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=Vn()},m(a,u){for(let s=0;s<e.length;s+=1)e[s].m(a,u);Y(a,r,u)},p(a,u){u&14&&(i=Object.keys(a[1]).sort(a[2]),e=Jr(e,u,o,1,a,i,n,r.parentNode,no,Fr,r,Br))},d(a){for(let u=0;u<e.length;u+=1)e[u].d(a);a&&U(r)}}}function Ja(t){let e;return{c(){e=$("tr"),e.innerHTML='<td colspan="3" class="muted centered svelte-19w152h">No games played</td>'},m(n,r){Y(n,e,r)},p:ee,d(n){n&&U(e)}}}function Fr(t,e){let n,r,i=e[5]+"",o,a,u,s=e[1][e[5]].length+"",l,c,f,h=e[3](Math.max(...e[1][e[5]].map($r)))+"",v,p;return{key:t,first:null,c(){n=$("tr"),r=$("td"),o=xe(i),a=J(),u=$("td"),l=xe(s),c=J(),f=$("td"),v=xe(h),p=J(),B(r,"class","svelte-19w152h"),B(u,"class","svelte-19w152h"),B(f,"class","svelte-19w152h"),this.first=n},m(d,y){Y(d,n,y),R(n,r),R(r,o),R(n,a),R(n,u),R(u,l),R(n,c),R(n,f),R(f,v),R(n,p)},p(d,y){e=d,y&2&&i!==(i=e[5]+"")&&We(o,i),y&2&&s!==(s=e[1][e[5]].length+"")&&We(l,s),y&2&&h!==(h=e[3](Math.max(...e[1][e[5]].map($r)))+"")&&We(v,h)},d(d){d&&U(n)}}}function Za(t){let e,n,r,i;function o(s,l){return s[0]&&s[0].length===0?Ja:Xa}let a=o(t),u=a(t);return{c(){e=$("table"),n=$("thead"),n.innerHTML=`<tr><th class="svelte-19w152h">Moves</th> 
      <th class="svelte-19w152h">Games</th> 
      <th class="svelte-19w152h">Last Played</th></tr>`,r=J(),i=$("tbody"),u.c(),B(n,"class","svelte-19w152h"),B(i,"class","svelte-19w152h"),B(e,"class","svelte-19w152h")},m(s,l){Y(s,e,l),R(e,n),R(e,r),R(e,i),u.m(i,null)},p(s,[l]){a===(a=o(s))&&u?u.p(s,l):(u.d(1),u=a(s),u&&(u.c(),u.m(i,null)))},i:ee,o:ee,d(s){s&&U(e),u.d()}}}const $r=t=>t.timestamp;function eu(t,e,n){let r,i;const o=(s,l)=>parseInt(s)-parseInt(l),a=s=>{const l={year:"numeric",month:"short",day:"numeric"};return new Date(s).toLocaleDateString(navigator.language,l)};let u=Ti(()=>Ii.completedGames.toArray());return zi(t,u,s=>n(0,i=s)),t.$$.update=()=>{t.$$.dirty&1&&n(1,r=Eo(i||[],"moveCount"))},[i,r,o,a,u]}class tu extends ze{constructor(e){super(),$e(this,e,eu,Za,Oe,{})}}function nu(t){let e,n,r,i;return{c(){e=$("div"),n=$("button"),n.textContent="Close",n.autofocus=!0,B(n,"class","button modal-close-button svelte-lh4ff1"),B(e,"slot","header"),B(e,"class","modal-header svelte-lh4ff1")},m(o,a){Y(o,e,a),R(e,n),n.focus(),r||(i=lt(n,"click",t[0]),r=!0)},p:ee,d(o){o&&U(e),r=!1,i()}}}function ru(t){let e,n,r,i,o;return i=new tu({}),{c(){e=$("div"),n=$("p"),n.textContent="Your objective is to solve puzzles in the fewest moves possible.",r=J(),qe(i.$$.fragment),B(n,"class","text-muted"),B(e,"slot","content"),B(e,"class","records-list svelte-lh4ff1")},m(a,u){Y(a,e,u),R(e,n),R(e,r),Be(i,e,null),o=!0},p:ee,i(a){o||(q(i.$$.fragment,a),o=!0)},o(a){Z(i.$$.fragment,a),o=!1},d(a){a&&U(e),Fe(i)}}}function iu(t){let e,n;return e=new wo({props:{$$slots:{content:[ru],header:[nu]},$$scope:{ctx:t}}}),e.$on("close",t[1]),{c(){qe(e.$$.fragment)},m(r,i){Be(e,r,i),n=!0},p(r,[i]){const o={};i&8&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Z(e.$$.fragment,r),n=!1},d(r){Fe(e,r)}}}function ou(t){const e=Wn(),n=()=>e("close");function r(i){Qi.call(this,t,i)}return[n,r]}class au extends ze{constructor(e){super(),$e(this,e,ou,iu,Oe,{})}}function zr(t){let e,n;return e=new au({}),e.$on("close",t[4]),{c(){qe(e.$$.fragment)},m(r,i){Be(e,r,i),n=!0},p:ee,i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Z(e.$$.fragment,r),n=!1},d(r){Fe(e,r)}}}function uu(t){let e,n,r,i,o,a;r=new vo({props:{puzzle:t[0].puzzle,onCompleted:t[2],showRecords:t[3]}});let u=t[1]&&zr(t);return{c(){e=$("div"),n=$("div"),qe(r.$$.fragment),i=J(),u&&u.c(),o=Vn(),B(n,"class","app-container svelte-15ktk62"),B(e,"class","app-root svelte-15ktk62")},m(s,l){Y(s,e,l),R(e,n),Be(r,n,null),Y(s,i,l),u&&u.m(s,l),Y(s,o,l),a=!0},p(s,[l]){const c={};l&1&&(c.puzzle=s[0].puzzle),r.$set(c),s[1]?u?(u.p(s,l),l&2&&q(u,1)):(u=zr(s),u.c(),q(u,1),u.m(o.parentNode,o)):u&&(Qr(),Z(u,1,1,()=>{u=null}),Xr())},i(s){a||(q(r.$$.fragment,s),q(u),a=!0)},o(s){Z(r.$$.fragment,s),Z(u),a=!1},d(s){s&&U(e),Fe(r),s&&U(i),u&&u.d(s),s&&U(o)}}}function Lr(){const t=Math.random,e=[[4,4]],[n,r]=e[Math.floor(t()*e.length)],i=n*r/2;let o=new Array(i).fill().map((l,c)=>c+1);o.push(...o);const a=Array.from({length:o.length},(l,c)=>{const f=Math.floor(t()*o.length);return{index:c,type:o.splice(f,1)[0],backfaceIsUp:!1}});console.log("new puzzle!");const u=a.map(l=>l.type);for(var s=0;s<r;s++)console.log(u.splice(0,n));return{puzzle:a}}function su(t,e,n){let r=Lr();const i=async l=>{await Ii.completedGames.add({itemCount:r.puzzle.length,moveCount:l,timestamp:Date.now()})};function o(l){alert(`You won in ${l} moves!`),i(l),n(0,r=Lr())}let a=!1;function u(){n(1,a=!0)}return[r,a,o,u,()=>n(1,a=!1)]}class lu extends ze{constructor(e){super(),$e(this,e,su,uu,Oe,{})}}new lu({target:document.body,props:{}});
