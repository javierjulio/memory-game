var gs=Object.defineProperty;var vs=(t,e,n)=>e in t?gs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Jn=(t,e,n)=>(vs(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function N(){}const Or=t=>t;function _s(t,e){for(const n in e)t[n]=e[n];return t}function Kr(t){return t()}function Zn(){return Object.create(null)}function we(t){t.forEach(Kr)}function In(t){return typeof t=="function"}function de(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function bs(t){return Object.keys(t).length===0}function ws(t,...e){if(t==null)return N;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Tn(t,e,n){t.$$.on_destroy.push(ws(e,n))}function rn(t,e,n,r){if(t){const s=Sr(t,e,n,r);return t[0](s)}}function Sr(t,e,n,r){return t[1]&&r?_s(n.ctx.slice(),t[1](r(e))):n.ctx}function sn(t,e,n,r){if(t[2]&&r){const s=t[2](r(n));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],i=Math.max(e.dirty.length,s.length);for(let a=0;a<i;a+=1)o[a]=e.dirty[a]|s[a];return o}return e.dirty|s}return e.dirty}function on(t,e,n,r,s,o){if(s){const i=Sr(e,n,r,o);t.p(i,s)}}function an(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function Ar(t,e,n){return t.set(n),e}const $r=typeof window<"u";let ks=$r?()=>window.performance.now():()=>Date.now(),Bn=$r?t=>requestAnimationFrame(t):N;const ze=new Set;function jr(t){ze.forEach(e=>{e.c(t)||(ze.delete(e),e.f())}),ze.size!==0&&Bn(jr)}function xs(t){let e;return ze.size===0&&Bn(jr),{promise:new Promise(n=>{ze.add(e={c:t,f:n})}),abort(){ze.delete(e)}}}function A(t,e){t.appendChild(e)}function Dr(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Es(t){const e=I("style");return Ps(Dr(t),e),e.sheet}function Ps(t,e){return A(t.head||t,e),e.sheet}function z(t,e,n){t.insertBefore(e,n||null)}function R(t){t.parentNode&&t.parentNode.removeChild(t)}function I(t){return document.createElement(t)}function re(t){return document.createTextNode(t)}function Z(){return re(" ")}function Mn(){return re("")}function Ye(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function S(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Cs(t){return Array.from(t.childNodes)}function Le(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function er(t,e,n){t.classList[n?"add":"remove"](e)}function Ir(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}const Bt=new Map;let Mt=0;function Os(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Ks(t,e){const n={stylesheet:Es(e),rules:{}};return Bt.set(t,n),n}function tr(t,e,n,r,s,o,i,a=0){const l=16.666/r;let c=`{
`;for(let v=0;v<=1;v+=l){const g=e+(n-e)*o(v);c+=v*100+`%{${i(g,1-g)}}
`}const h=c+`100% {${i(n,1-n)}}
}`,f=`__svelte_${Os(h)}_${a}`,u=Dr(t),{stylesheet:d,rules:m}=Bt.get(u)||Ks(u,t);m[f]||(m[f]=!0,d.insertRule(`@keyframes ${f} ${h}`,d.cssRules.length));const p=t.style.animation||"";return t.style.animation=`${p?`${p}, `:""}${f} ${r}ms linear ${s}ms 1 both`,Mt+=1,f}function Ss(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),s=n.length-r.length;s&&(t.style.animation=r.join(", "),Mt-=s,Mt||As())}function As(){Bn(()=>{Mt||(Bt.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&R(e)}),Bt.clear())})}let ut;function rt(t){ut=t}function Rn(){if(!ut)throw new Error("Function called outside component initialization");return ut}function $s(t){Rn().$$.on_mount.push(t)}function js(t){Rn().$$.on_destroy.push(t)}function Fn(){const t=Rn();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const o=Ir(e,n,{cancelable:r});return s.slice().forEach(i=>{i.call(t,o)}),!o.defaultPrevented}return!0}}function Tr(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const Ne=[],ln=[],Ot=[],nr=[],Ds=Promise.resolve();let un=!1;function Is(){un||(un=!0,Ds.then(Br))}function Ge(t){Ot.push(t)}const Ht=new Set;let Be=0;function Br(){if(Be!==0)return;const t=ut;do{try{for(;Be<Ne.length;){const e=Ne[Be];Be++,rt(e),Ts(e.$$)}}catch(e){throw Ne.length=0,Be=0,e}for(rt(null),Ne.length=0,Be=0;ln.length;)ln.pop()();for(let e=0;e<Ot.length;e+=1){const n=Ot[e];Ht.has(n)||(Ht.add(n),n())}Ot.length=0}while(Ne.length);for(;nr.length;)nr.pop()();un=!1,Ht.clear(),rt(t)}function Ts(t){if(t.fragment!==null){t.update(),we(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ge)}}let Ze;function Bs(){return Ze||(Ze=Promise.resolve(),Ze.then(()=>{Ze=null})),Ze}function Qt(t,e,n){t.dispatchEvent(Ir(`${e?"intro":"outro"}${n}`))}const Kt=new Set;let le;function Mr(){le={r:0,c:[],p:le}}function Rr(){le.r||we(le.c),le=le.p}function U(t,e){t&&t.i&&(Kt.delete(t),t.i(e))}function X(t,e,n,r){if(t&&t.o){if(Kt.has(t))return;Kt.add(t),le.c.push(()=>{Kt.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const Ms={duration:0};function _t(t,e,n,r){const s={direction:"both"};let o=e(t,n,s),i=r?0:1,a=null,l=null,c=null;function h(){c&&Ss(t,c)}function f(d,m){const p=d.b-i;return m*=Math.abs(p),{a:i,b:d.b,d:p,duration:m,start:d.start,end:d.start+m,group:d.group}}function u(d){const{delay:m=0,duration:p=300,easing:v=Or,tick:g=N,css:y}=o||Ms,b={start:ks()+m,b:d};d||(b.group=le,le.r+=1),a||l?l=b:(y&&(h(),c=tr(t,i,d,p,m,v,y)),d&&g(0,1),a=f(b,p),Ge(()=>Qt(t,d,"start")),xs(E=>{if(l&&E>l.start&&(a=f(l,p),l=null,Qt(t,a.b,"start"),y&&(h(),c=tr(t,i,a.b,a.duration,0,v,o.css))),a){if(E>=a.end)g(i=a.b,1-i),Qt(t,a.b,"end"),l||(a.b?h():--a.group.r||we(a.group.c)),a=null;else if(E>=a.start){const k=E-a.start;i=a.a+a.d*v(k/a.duration),g(i,1-i)}}return!!(a||l)}))}return{run(d){In(o)?Bs().then(()=>{o=o(s),u(d)}):u(d)},end(){h(),a=l=null}}}function Rs(t,e){t.d(1),e.delete(t.key)}function Fs(t,e){X(t,1,1,()=>{e.delete(t.key)})}function Fr(t,e,n,r,s,o,i,a,l,c,h,f){let u=t.length,d=o.length,m=u;const p={};for(;m--;)p[t[m].key]=m;const v=[],g=new Map,y=new Map;for(m=d;m--;){const _=f(s,o,m),w=n(_);let C=i.get(w);C?r&&C.p(_,e):(C=c(w,_),C.c()),g.set(w,v[m]=C),w in p&&y.set(w,Math.abs(m-p[w]))}const b=new Set,E=new Set;function k(_){U(_,1),_.m(a,h),i.set(_.key,_),h=_.first,d--}for(;u&&d;){const _=v[d-1],w=t[u-1],C=_.key,P=w.key;_===w?(h=_.first,u--,d--):g.has(P)?!i.has(C)||b.has(C)?k(_):E.has(P)?u--:y.get(C)>y.get(P)?(E.add(C),k(_)):(b.add(P),u--):(l(w,i),u--)}for(;u--;){const _=t[u];g.has(_.key)||l(_,i)}for(;d;)k(v[d-1]);return v}function Oe(t){t&&t.c()}function ye(t,e,n,r){const{fragment:s,after_update:o}=t.$$;s&&s.m(e,n),r||Ge(()=>{const i=t.$$.on_mount.map(Kr).filter(In);t.$$.on_destroy?t.$$.on_destroy.push(...i):we(i),t.$$.on_mount=[]}),o.forEach(Ge)}function ge(t,e){const n=t.$$;n.fragment!==null&&(we(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ns(t,e){t.$$.dirty[0]===-1&&(Ne.push(t),Is(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ke(t,e,n,r,s,o,i,a=[-1]){const l=ut;rt(t);const c=t.$$={fragment:null,ctx:[],props:o,update:N,not_equal:s,bound:Zn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Zn(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};i&&i(c.root);let h=!1;if(c.ctx=n?n(t,e.props||{},(f,u,...d)=>{const m=d.length?d[0]:u;return c.ctx&&s(c.ctx[f],c.ctx[f]=m)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](m),h&&Ns(t,f)),u}):[],c.update(),h=!0,we(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const f=Cs(e.target);c.fragment&&c.fragment.l(f),f.forEach(R)}else c.fragment&&c.fragment.c();e.intro&&U(t.$$.fragment),ye(t,e.target,e.anchor,e.customElement),Br()}rt(l)}class xe{$destroy(){ge(this,1),this.$destroy=N}$on(e,n){if(!In(n))return N;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!bs(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function qs(t){let e,n,r,s,o,i,a,l;const c=t[5].default,h=rn(c,t,t[4],null);return{c(){e=I("div"),n=I("div"),r=Z(),s=I("div"),h&&h.c(),S(n,"class","card-front svelte-1enngss"),S(s,"class","card-back svelte-1enngss"),S(e,"data-testid",o="card-"+t[0].type),S(e,"class","card svelte-1enngss"),er(e,"toggled",t[1])},m(f,u){z(f,e,u),A(e,n),A(e,r),A(e,s),h&&h.m(s,null),i=!0,a||(l=[Ye(e,"click",t[2]),Ye(e,"keyup",t[2])],a=!0)},p(f,[u]){h&&h.p&&(!i||u&16)&&on(h,c,f,f[4],i?sn(c,f[4],u,null):an(f[4]),null),(!i||u&1&&o!==(o="card-"+f[0].type))&&S(e,"data-testid",o),(!i||u&2)&&er(e,"toggled",f[1])},i(f){i||(U(h,f),i=!0)},o(f){X(h,f),i=!1},d(f){f&&R(e),h&&h.d(f),a=!1,we(l)}}}function zs(t,e,n){let{$$slots:r={},$$scope:s}=e;const o=Fn();let{item:i={index:0,type:0,backfaceIsUp:!1}}=e,{flippable:a=!0}=e,{flipped:l=!1}=e;function c(){a&&!l&&o("flip",i)}return t.$$set=h=>{"item"in h&&n(0,i=h.item),"flippable"in h&&n(3,a=h.flippable),"flipped"in h&&n(1,l=h.flipped),"$$scope"in h&&n(4,s=h.$$scope)},[i,l,c,a,s,r]}class Ls extends xe{constructor(e){super(),ke(this,e,zs,qs,de,{item:0,flippable:3,flipped:1})}}const Me=[];function Us(t,e=N){let n;const r=new Set;function s(a){if(de(t,a)&&(t=a,n)){const l=!Me.length;for(const c of r)c[1](),Me.push(c,t);if(l){for(let c=0;c<Me.length;c+=2)Me[c][0](Me[c+1]);Me.length=0}}}function o(a){s(a(t))}function i(a,l=N){const c=[a,l];return r.add(c),r.size===1&&(n=e(s)||N),a(t),()=>{r.delete(c),r.size===0&&(n(),n=null)}}return{set:s,update:o,subscribe:i}}const Rt=Us(0);function rr(t,e,n){const r=t.slice();return r[9]=e[n],r[11]=n,r}function Vs(t){let e=t[9].type.toString()+"",n,r;return{c(){n=re(e),r=Z()},m(s,o){z(s,n,o),z(s,r,o)},p(s,o){o&1&&e!==(e=s[9].type.toString()+"")&&Le(n,e)},d(s){s&&R(n),s&&R(r)}}}function sr(t,e){let n,r,s;return r=new Ls({props:{item:e[9],flipped:e[9].backfaceIsUp,flippable:e[1].length<2,$$slots:{default:[Vs]},$$scope:{ctx:e}}}),r.$on("flip",e[2]),{key:t,first:null,c(){n=Mn(),Oe(r.$$.fragment),this.first=n},m(o,i){z(o,n,i),ye(r,o,i),s=!0},p(o,i){e=o;const a={};i&1&&(a.item=e[9]),i&1&&(a.flipped=e[9].backfaceIsUp),i&2&&(a.flippable=e[1].length<2),i&4097&&(a.$$scope={dirty:i,ctx:e}),r.$set(a)},i(o){s||(U(r.$$.fragment,o),s=!0)},o(o){X(r.$$.fragment,o),s=!1},d(o){o&&R(n),ge(r,o)}}}function Ws(t){let e,n=[],r=new Map,s,o=t[0];const i=a=>a[11];for(let a=0;a<o.length;a+=1){let l=rr(t,o,a),c=i(l);r.set(c,n[a]=sr(c,l))}return{c(){e=I("div");for(let a=0;a<n.length;a+=1)n[a].c();S(e,"class","full-grid disable-text-selection svelte-1mw4cvk")},m(a,l){z(a,e,l);for(let c=0;c<n.length;c+=1)n[c].m(e,null);s=!0},p(a,[l]){l&7&&(o=a[0],Mr(),n=Fr(n,l,i,1,a,o,r,e,Fs,sr,null,rr),Rr())},i(a){if(!s){for(let l=0;l<o.length;l+=1)U(n[l]);s=!0}},o(a){for(let l=0;l<n.length;l+=1)X(n[l]);s=!1},d(a){a&&R(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function Xt(t,...e){return new Promise(n=>setTimeout(n,t,...e))}function Ys(t,e,n){let r;Tn(t,Rt,u=>n(4,r=u));let{puzzle:s=[]}=e,{onCompleted:o}=e,i=[];function a(u){u.backfaceIsUp=!1,n(0,s)}function l(){s.length===s.filter(d=>d.backfaceIsUp).length&&Xt(300).then(()=>{o()})}function c(){const u=[Xt(600,i[1]).then(a),Xt(800,i[0]).then(a)];Promise.all(u).then(()=>n(1,i=[]))}function h(){return i[0].type===i[1].type}function f(u){const d=u.detail;n(0,s[d.index].backfaceIsUp=!s[d.index].backfaceIsUp,s),n(1,i=[...i,d]),i.length>=2&&(Ar(Rt,r++,r),h()?(n(1,i=[]),l()):c())}return t.$$set=u=>{"puzzle"in u&&n(0,s=u.puzzle),"onCompleted"in u&&n(3,o=u.onCompleted)},[s,i,f,o]}class Gs extends xe{constructor(e){super(),ke(this,e,Ys,Ws,de,{puzzle:0,onCompleted:3})}}function Hs(t){let e,n,r;return{c(){e=I("button"),e.innerHTML=`<span class="icon svelte-glkhk4"><svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline></svg></span>
  Records`,S(e,"class","button")},m(s,o){z(s,e,o),n||(r=Ye(e,"click",t[0]),n=!0)},p:N,i:N,o:N,d(s){s&&R(e),n=!1,r()}}}function Qs(t){function e(n){Tr.call(this,t,n)}return[e]}class Xs extends xe{constructor(e){super(),ke(this,e,Qs,Hs,de,{})}}function Js(t){const e=t-1;return e*e*e+1}function or(t){return--t*t*t*t*t+1}function ir(t){return-.5*(Math.cos(Math.PI*t)-1)}function ar(t,{delay:e=0,duration:n=400,easing:r=Or}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:o=>`opacity: ${o*s}`}}function lr(t,{delay:e=0,duration:n=400,easing:r=Js}={}){const s=getComputedStyle(t),o=+s.opacity,i=parseFloat(s.height),a=parseFloat(s.paddingTop),l=parseFloat(s.paddingBottom),c=parseFloat(s.marginTop),h=parseFloat(s.marginBottom),f=parseFloat(s.borderTopWidth),u=parseFloat(s.borderBottomWidth);return{delay:e,duration:n,easing:r,css:d=>`overflow: hidden;opacity: ${Math.min(d*20,1)*o};height: ${d*i}px;padding-top: ${d*a}px;padding-bottom: ${d*l}px;margin-top: ${d*c}px;margin-bottom: ${d*h}px;border-top-width: ${d*f}px;border-bottom-width: ${d*u}px;`}}const Zs=t=>({}),ur=t=>({}),eo=t=>({}),cr=t=>({});function to(t){let e,n,r,s,o,i,a,l,c,h;const f=t[4].header,u=rn(f,t,t[3],cr),d=t[4].content,m=rn(d,t,t[3],ur);return{c(){e=I("div"),n=I("div"),s=Z(),o=I("div"),u&&u.c(),i=Z(),m&&m.c(),S(n,"class","modal-backdrop svelte-1hm6iu8"),S(o,"class","modal svelte-1hm6iu8"),S(o,"role","dialog"),S(o,"aria-modal","true"),S(e,"class","modal-overlay svelte-1hm6iu8")},m(p,v){z(p,e,v),A(e,n),A(e,s),A(e,o),u&&u.m(o,null),A(o,i),m&&m.m(o,null),t[5](o),l=!0,c||(h=[Ye(window,"keydown",t[2]),Ye(n,"pointerdown",t[1])],c=!0)},p(p,[v]){t=p,u&&u.p&&(!l||v&8)&&on(u,f,t,t[3],l?sn(f,t[3],v,eo):an(t[3]),cr),m&&m.p&&(!l||v&8)&&on(m,d,t,t[3],l?sn(d,t[3],v,Zs):an(t[3]),ur)},i(p){l||(Ge(()=>{r||(r=_t(n,ar,{duration:600,easing:ir},!0)),r.run(1)}),U(u,p),U(m,p),Ge(()=>{a||(a=_t(o,lr,{duration:600,easing:or},!0)),a.run(1)}),l=!0)},o(p){r||(r=_t(n,ar,{duration:600,easing:ir},!1)),r.run(0),X(u,p),X(m,p),a||(a=_t(o,lr,{duration:600,easing:or},!1)),a.run(0),l=!1},d(p){p&&R(e),p&&r&&r.end(),u&&u.d(p),m&&m.d(p),t[5](null),p&&a&&a.end(),c=!1,we(h)}}}function no(t,e,n){let{$$slots:r={},$$scope:s}=e;const o=Fn(),i=()=>o("close");let a;const l=f=>{if(f.key==="Escape"){i();return}if(f.key==="Tab"){const u=a.querySelectorAll("*"),d=Array.from(u).filter(p=>p.tabIndex>=0);let m=d.indexOf(document.activeElement);m===-1&&f.shiftKey&&(m=0),m+=d.length+(f.shiftKey?-1:1),m%=d.length,d[m].focus(),f.preventDefault()}},c=typeof document<"u"&&document.activeElement;c&&js(()=>{c.focus()});function h(f){ln[f?"unshift":"push"](()=>{a=f,n(0,a)})}return t.$$set=f=>{"$$scope"in f&&n(3,s=f.$$scope)},[a,i,l,s,r,h]}class ro extends xe{constructor(e){super(),ke(this,e,no,to,de,{})}}const so=(t,e)=>t.reduce((n,r,s,o,i=r[e])=>((n[i]||(n[i]=[])).push(r),n),{}),D=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,F=Object.keys,W=Array.isArray;function H(t,e){return typeof e!="object"||F(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||D.Promise||(D.Promise=Promise);const ct=Object.getPrototypeOf,oo={}.hasOwnProperty;function ee(t,e){return oo.call(t,e)}function He(t,e){typeof e=="function"&&(e=e(ct(t))),(typeof Reflect>"u"?F:Reflect.ownKeys)(e).forEach(n=>{ce(t,n,e[n])})}const Nr=Object.defineProperty;function ce(t,e,n,r){Nr(t,e,H(n&&ee(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Ue(t){return{from:function(e){return t.prototype=Object.create(e.prototype),ce(t.prototype,"constructor",t),{extend:He.bind(null,t.prototype)}}}}const io=Object.getOwnPropertyDescriptor;function Nn(t,e){let n;return io(t,e)||(n=ct(t))&&Nn(n,e)}const ao=[].slice;function Ft(t,e,n){return ao.call(t,e,n)}function qr(t,e){return e(t)}function tt(t){if(!t)throw new Error("Assertion Failed")}function zr(t){D.setImmediate?setImmediate(t):setTimeout(t,0)}function Lr(t,e){return t.reduce((n,r,s)=>{var o=e(r,s);return o&&(n[o[0]]=o[1]),n},{})}function he(t,e){if(ee(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,s=e.length;r<s;++r){var o=he(t,e[r]);n.push(o)}return n}var i=e.indexOf(".");if(i!==-1){var a=t[e.substr(0,i)];return a===void 0?void 0:he(a,e.substr(i+1))}}function te(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){tt(typeof n!="string"&&"length"in n);for(var r=0,s=e.length;r<s;++r)te(t,e[r],n[r])}else{var o=e.indexOf(".");if(o!==-1){var i=e.substr(0,o),a=e.substr(o+1);if(a==="")n===void 0?W(t)&&!isNaN(parseInt(i))?t.splice(i,1):delete t[i]:t[i]=n;else{var l=t[i];l&&ee(t,i)||(l=t[i]={}),te(l,a,n)}}else n===void 0?W(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Ur(t){var e={};for(var n in t)ee(t,n)&&(e[n]=t[n]);return e}const lo=[].concat;function Vr(t){return lo.apply([],t)}const Wr="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Vr([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>D[t]),uo=Wr.map(t=>D[t]);Lr(Wr,t=>[t,!0]);let me=null;function yt(t){me=typeof WeakMap<"u"&&new WeakMap;const e=cn(t);return me=null,e}function cn(t){if(!t||typeof t!="object")return t;let e=me&&me.get(t);if(e)return e;if(W(t)){e=[],me&&me.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(cn(t[n]))}else if(uo.indexOf(t.constructor)>=0)e=t;else{const o=ct(t);for(var s in e=o===Object.prototype?{}:Object.create(o),me&&me.set(t,e),t)ee(t,s)&&(e[s]=cn(t[s]))}return e}const{toString:co}={};function hn(t){return co.call(t).slice(8,-1)}const fn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ho=typeof fn=="symbol"?function(t){var e;return t!=null&&(e=t[fn])&&e.apply(t)}:function(){return null},qe={};function ae(t){var e,n,r,s;if(arguments.length===1){if(W(t))return t.slice();if(this===qe&&typeof t=="string")return[t];if(s=ho(t)){for(n=[];!(r=s.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const qn=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var se=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Yr(t,e){se=t,Gr=e}var Gr=()=>!0;const fo=!new Error("").stack;function De(){if(fo)try{throw De.arguments,new Error}catch(t){return t}return new Error}function dn(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Gr).map(r=>`
`+r).join("")):""}var Hr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],zn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Hr),po={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ve(t,e){this._e=De(),this.name=t,this.message=e}function Qr(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,s)=>s.indexOf(n)===r).join(`
`)}function Nt(t,e,n,r){this._e=De(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Qr(t,e)}function st(t,e){this._e=De(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Qr(t,e)}Ue(Ve).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+dn(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Ue(Nt).from(Ve),Ue(st).from(Ve);var Ln=zn.reduce((t,e)=>(t[e]=e+"Error",t),{});const mo=Ve;var K=zn.reduce((t,e)=>{var n=e+"Error";function r(s,o){this._e=De(),this.name=n,s?typeof s=="string"?(this.message=`${s}${o?`
 `+o:""}`,this.inner=o||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=po[e]||n,this.inner=null)}return Ue(r).from(mo),t[e]=r,t},{});K.Syntax=SyntaxError,K.Type=TypeError,K.Range=RangeError;var hr=Hr.reduce((t,e)=>(t[e+"Error"]=K[e],t),{}),St=zn.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=K[e]),t),{});function $(){}function ht(t){return t}function yo(t,e){return t==null||t===ht?e:function(n){return e(t(n))}}function $e(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function go(t,e){return t===$?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?$e(r,this.onsuccess):r),s&&(this.onerror=this.onerror?$e(s,this.onerror):s),o!==void 0?o:n}}function vo(t,e){return t===$?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?$e(n,this.onsuccess):n),r&&(this.onerror=this.onerror?$e(r,this.onerror):r)}}function _o(t,e){return t===$?e:function(n){var r=t.apply(this,arguments);H(n,r);var s=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?$e(s,this.onsuccess):s),o&&(this.onerror=this.onerror?$e(o,this.onerror):o),r===void 0?i===void 0?void 0:i:H(r,i)}}function bo(t,e){return t===$?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function Un(t,e){return t===$?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,s=arguments.length,o=new Array(s);s--;)o[s]=arguments[s];return n.then(function(){return e.apply(r,o)})}return e.apply(this,arguments)}}St.ModifyError=Nt,St.DexieError=Ve,St.BulkError=st;var ft={};const[pn,qt,mn]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,ct(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,ct(e),t]})(),Xr=qt&&qt.then,At=pn&&pn.constructor,Vn=!!mn;var yn=!1,wo=mn?()=>{mn.then(bt)}:D.setImmediate?setImmediate.bind(null,bt):D.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{bt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(bt,0)},ot=function(t,e){nt.push([t,e]),zt&&(wo(),zt=!1)},gn=!0,zt=!0,Ke=[],$t=[],vn=null,_n=ht,We={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:dr,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{dr(t[0],t[1])}catch{}})}},O=We,nt=[],Se=0,jt=[];function x(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=$,this._lib=!1;var e=this._PSD=O;if(se&&(this._stackHolder=De(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==ft)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&wn(this,this._value))}this._state=null,this._value=null,++e.ref,Zr(this,t)}const bn={get:function(){var t=O,e=Lt;function n(r,s){var o=!t.global&&(t!==O||e!==Lt);const i=o&&!fe();var a=new x((l,c)=>{Wn(this,new Jr(Ut(r,t,o,i),Ut(s,t,o,i),l,c,t))});return se&&ns(a,this),a}return n.prototype=ft,n},set:function(t){ce(this,"then",t&&t.prototype===ft?bn:{get:function(){return t},set:bn.set})}};function Jr(t,e,n,r,s){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=s}function Zr(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&gt();n&&typeof n.then=="function"?Zr(t,(s,o)=>{n instanceof x?n._then(s,o):n.then(s,o)}):(t._state=!0,t._value=n,es(t)),r&&vt()}},wn.bind(null,t))}catch(n){wn(t,n)}}function wn(t,e){if($t.push(e),t._state===null){var n=t._lib&&gt();e=_n(e),t._state=!1,t._value=e,se&&e!==null&&typeof e=="object"&&!e._promise&&function(r,s,o){try{r.apply(null,o)}catch(i){s&&s(i)}}(()=>{var r=Nn(e,"stack");e._promise=t,ce(e,"stack",{get:()=>yn?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){Ke.some(s=>s._value===r._value)||Ke.push(r)}(t),es(t),n&&vt()}}function es(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Wn(t,e[n]);var s=t._PSD;--s.ref||s.finalize(),Se===0&&(++Se,ot(()=>{--Se==0&&Yn()},[]))}function Wn(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Se,ot(ko,[n,t,e])}else t._listeners.push(e)}function ko(t,e,n){try{vn=e;var r,s=e._value;e._state?r=t(s):($t.length&&($t=[]),r=t(s),$t.indexOf(s)===-1&&function(o){for(var i=Ke.length;i;)if(Ke[--i]._value===o._value)return void Ke.splice(i,1)}(e)),n.resolve(r)}catch(o){n.reject(o)}finally{vn=null,--Se==0&&Yn(),--n.psd.ref||n.psd.finalize()}}function ts(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var s,o,i=t._value;i!=null?(s=i.name||"Error",o=i.message||i,r=dn(i,0)):(s=i,o=""),e.push(s+(o?": "+o:"")+r)}return se&&((r=dn(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&ts(t._prev,e,n)),e}function ns(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function bt(){gt()&&vt()}function gt(){var t=gn;return gn=!1,zt=!1,t}function vt(){var t,e,n;do for(;nt.length>0;)for(t=nt,nt=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(nt.length>0);gn=!0,zt=!0}function Yn(){var t=Ke;Ke=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=jt.slice(0),n=e.length;n;)e[--n]()}function wt(t){return new x(ft,!1,t)}function T(t,e){var n=O;return function(){var r=gt(),s=O;try{return _e(n,!0),t.apply(this,arguments)}catch(o){e&&e(o)}finally{_e(s,!1),r&&vt()}}}He(x.prototype,{then:bn,_then:function(t,e){Wn(this,new Jr(null,null,t,e,O))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):wt(r)):this.then(null,r=>r&&r.name===e?n(r):wt(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),wt(e)))},stack:{get:function(){if(this._stack)return this._stack;try{yn=!0;var t=ts(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{yn=!1}}},timeout:function(t,e){return t<1/0?new x((n,r)=>{var s=setTimeout(()=>r(new K.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&ce(x.prototype,Symbol.toStringTag,"Dexie.Promise"),We.env=rs(),He(x,{all:function(){var t=ae.apply(null,arguments).map(kt);return new x(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((s,o)=>x.resolve(s).then(i=>{t[o]=i,--r||e(t)},n))})},resolve:t=>{if(t instanceof x)return t;if(t&&typeof t.then=="function")return new x((n,r)=>{t.then(n,r)});var e=new x(ft,!0,t);return ns(e,vn),e},reject:wt,race:function(){var t=ae.apply(null,arguments).map(kt);return new x((e,n)=>{t.map(r=>x.resolve(r).then(e,n))})},PSD:{get:()=>O,set:t=>O=t},totalEchoes:{get:()=>Lt},newPSD:ve,usePSD:Xe,scheduler:{get:()=>ot,set:t=>{ot=t}},rejectionMapper:{get:()=>_n,set:t=>{_n=t}},follow:(t,e)=>new x((n,r)=>ve((s,o)=>{var i=O;i.unhandleds=[],i.onunhandled=o,i.finalize=$e(function(){(function(a){function l(){a(),jt.splice(jt.indexOf(l),1)}jt.push(l),++Se,ot(()=>{--Se==0&&Yn()},[])})(()=>{this.unhandleds.length===0?s():o(this.unhandleds[0])})},i.finalize),t()},e,n,r))}),At&&(At.allSettled&&ce(x,"allSettled",function(){const t=ae.apply(null,arguments).map(kt);return new x(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((s,o)=>x.resolve(s).then(i=>r[o]={status:"fulfilled",value:i},i=>r[o]={status:"rejected",reason:i}).then(()=>--n||e(r)))})}),At.any&&typeof AggregateError<"u"&&ce(x,"any",function(){const t=ae.apply(null,arguments).map(kt);return new x((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const s=new Array(r);t.forEach((o,i)=>x.resolve(o).then(a=>e(a),a=>{s[i]=a,--r||n(new AggregateError(s))}))})}));const V={awaits:0,echoes:0,id:0};var xo=0,Dt=[],Jt=0,Lt=0,Eo=0;function ve(t,e,n,r){var s=O,o=Object.create(s);o.parent=s,o.ref=0,o.global=!1,o.id=++Eo;var i=We.env;o.env=Vn?{Promise:x,PromiseProp:{value:x,configurable:!0,writable:!0},all:x.all,race:x.race,allSettled:x.allSettled,any:x.any,resolve:x.resolve,reject:x.reject,nthen:fr(i.nthen,o),gthen:fr(i.gthen,o)}:{},e&&H(o,e),++s.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Xe(o,t,n,r);return o.ref===0&&o.finalize(),a}function Qe(){return V.id||(V.id=++xo),++V.awaits,V.echoes+=100,V.id}function fe(){return!!V.awaits&&(--V.awaits==0&&(V.id=0),V.echoes=100*V.awaits,!0)}function kt(t){return V.echoes&&t&&t.constructor===At?(Qe(),t.then(e=>(fe(),e),e=>(fe(),q(e)))):t}function Po(t){++Lt,V.echoes&&--V.echoes!=0||(V.echoes=V.id=0),Dt.push(O),_e(t,!0)}function Co(){var t=Dt[Dt.length-1];Dt.pop(),_e(t,!1)}function _e(t,e){var n=O;if((e?!V.echoes||Jt++&&t===O:!Jt||--Jt&&t===O)||ss(e?Po.bind(null,t):Co),t!==O&&(O=t,n===We&&(We.env=rs()),Vn)){var r=We.env.Promise,s=t.env;qt.then=s.nthen,r.prototype.then=s.gthen,(n.global||t.global)&&(Object.defineProperty(D,"Promise",s.PromiseProp),r.all=s.all,r.race=s.race,r.resolve=s.resolve,r.reject=s.reject,s.allSettled&&(r.allSettled=s.allSettled),s.any&&(r.any=s.any))}}function rs(){var t=D.Promise;return Vn?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(D,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:qt.then,gthen:t.prototype.then}:{}}function Xe(t,e,n,r,s){var o=O;try{return _e(t,!0),e(n,r,s)}finally{_e(o,!1)}}function ss(t){Xr.call(pn,t)}function Ut(t,e,n,r){return typeof t!="function"?t:function(){var s=O;n&&Qe(),_e(e,!0);try{return t.apply(this,arguments)}finally{_e(s,!1),r&&ss(fe)}}}function fr(t,e){return function(n,r){return t.call(this,Ut(n,e),Ut(r,e))}}(""+Xr).indexOf("[native code]")===-1&&(Qe=fe=$);function dr(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,s={promise:e,reason:t};if(D.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),H(r,s)):D.CustomEvent&&H(r=new CustomEvent("unhandledrejection",{detail:s}),s),r&&D.dispatchEvent&&(dispatchEvent(r),!D.PromiseRejectionEvent&&D.onunhandledrejection))try{D.onunhandledrejection(r)}catch{}se&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var q=x.reject;function kn(t,e,n,r){if(t.idbdb&&(t._state.openComplete||O.letThrough||t._vip)){var s=t._createTransaction(e,n,t._dbSchema);try{s.create(),t._state.PR1398_maxLoop=3}catch(o){return o.name===Ln.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>kn(t,e,n,r))):q(o)}return s._promise(e,(o,i)=>ve(()=>(O.trans=s,r(o,i,s)))).then(o=>s._completion.then(()=>o))}if(t._state.openComplete)return q(new K.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return q(new K.DatabaseClosed);t.open().catch($)}return t._state.dbReadyPromise.then(()=>kn(t,e,n,r))}const Ce=String.fromCharCode(65535),oe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",it=[],Yt=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Oo=Yt,Ko=Yt,os=t=>!/(dexie\.js|dexie\.min\.js)/.test(t);function je(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const is={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function xt(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=yt(e))[t],e)}class So{_trans(e,n,r){const s=this._tx||O.trans,o=this.name;function i(l,c,h){if(!h.schema[o])throw new K.NotFound("Table "+o+" not part of transaction");return n(h.idbtrans,h)}const a=gt();try{return s&&s.db===this.db?s===O.trans?s._promise(e,i,r):ve(()=>s._promise(e,i,r),{trans:s,transless:O.transless||O}):kn(this.db,e,[this.name],i)}finally{a&&vt()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(s=>this.hook.reading.fire(s))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(W(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=F(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(c=>c.compound&&n.every(h=>c.keyPath.indexOf(h)>=0)&&c.keyPath.every(h=>n.indexOf(h)>=0))[0];if(r&&this.db._maxKey!==Ce)return this.where(r.name).equals(r.keyPath.map(c=>e[c]));!r&&se&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:s}=this.schema,o=this.db._deps.indexedDB;function i(c,h){try{return o.cmp(c,h)===0}catch{return!1}}const[a,l]=n.reduce(([c,h],f)=>{const u=s[f],d=e[f];return[c||u,c||!u?je(h,u&&u.multi?m=>{const p=he(m,f);return W(p)&&p.some(v=>i(d,v))}:m=>i(d,he(m,f))):h]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,W(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const s=Object.create(e.prototype);for(var o in r)if(ee(r,o))try{s[o]=r[o]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){H(this,e)})}add(e,n){const{auto:r,keyPath:s}=this.schema.primKey;let o=e;return s&&r&&(o=xt(s)(e)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"add",keys:n!=null?[n]:null,values:[o]})).then(i=>i.numFailures?x.reject(i.failures[0]):i.lastResult).then(i=>{if(s)try{te(e,s,i)}catch{}return i})}update(e,n){if(typeof e!="object"||W(e))return this.where(":id").equals(e).modify(n);{const r=he(e,this.schema.primKey.keyPath);if(r===void 0)return q(new K.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?F(n).forEach(s=>{te(e,s,n[s])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:s}=this.schema.primKey;let o=e;return s&&r&&(o=xt(s)(e)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"put",values:[o],keys:n!=null?[n]:null})).then(i=>i.numFailures?x.reject(i.failures[0]):i.lastResult).then(i=>{if(s)try{te(e,s,i)}catch{}return i})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?x.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:is})).then(e=>e.numFailures?x.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(s=>this.hook.reading.fire(s))))}bulkAdd(e,n,r){const s=Array.isArray(n)?n:void 0,o=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&s)throw new K.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let h=l&&a?e.map(xt(l)):e;return this.core.mutate({trans:i,type:"add",keys:s,values:h,wantResults:o}).then(({numFailures:f,results:u,lastResult:d,failures:m})=>{if(f===0)return o?u:d;throw new st(`${this.name}.bulkAdd(): ${f} of ${c} operations failed`,m)})})}bulkPut(e,n,r){const s=Array.isArray(n)?n:void 0,o=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&s)throw new K.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let h=l&&a?e.map(xt(l)):e;return this.core.mutate({trans:i,type:"put",keys:s,values:h,wantResults:o}).then(({numFailures:f,results:u,lastResult:d,failures:m})=>{if(f===0)return o?u:d;throw new st(`${this.name}.bulkPut(): ${f} of ${c} operations failed`,m)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:s,failures:o})=>{if(r===0)return s;throw new st(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,o)})}}function at(t){var e={},n=function(a,l){if(l){for(var c=arguments.length,h=new Array(c-1);--c;)h[c-1]=arguments[c];return e[a].subscribe.apply(null,h),t}if(typeof a=="string")return e[a]};n.addEventType=o;for(var r=1,s=arguments.length;r<s;++r)o(arguments[r]);return n;function o(a,l,c){if(typeof a=="object")return i(a);l||(l=bo),c||(c=$);var h={subscribers:[],fire:c,subscribe:function(f){h.subscribers.indexOf(f)===-1&&(h.subscribers.push(f),h.fire=l(h.fire,f))},unsubscribe:function(f){h.subscribers=h.subscribers.filter(function(u){return u!==f}),h.fire=h.subscribers.reduce(l,c)}};return e[a]=n[a]=h,h}function i(a){F(a).forEach(function(l){var c=a[l];if(W(c))o(l,a[l][0],a[l][1]);else{if(c!=="asap")throw new K.InvalidArgument("Invalid event config");var h=o(l,ht,function(){for(var f=arguments.length,u=new Array(f);f--;)u[f]=arguments[f];h.subscribers.forEach(function(d){zr(function(){d.apply(null,u)})})})}})}}function et(t,e){return Ue(e).from({prototype:t}),e}function Re(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Zt(t,e){t.filter=je(t.filter,e)}function en(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>je(r(),e()):e,t.justLimit=n&&!r}function It(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new K.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function pr(t,e,n){const r=It(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Et(t,e,n,r){const s=t.replayFilter?je(t.filter,t.replayFilter()):t.filter;if(t.or){const o={},i=(a,l,c)=>{if(!s||s(l,c,u=>l.stop(u),u=>l.fail(u))){var h=l.primaryKey,f=""+h;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(h)),ee(o,f)||(o[f]=!0,e(a,l,c))}};return Promise.all([t.or._iterate(i,n),mr(pr(t,r,n),t.algorithm,i,!t.keysOnly&&t.valueMapper)])}return mr(pr(t,r,n),je(t.algorithm,s),e,!t.keysOnly&&t.valueMapper)}function mr(t,e,n,r){var s=T(r?(o,i,a)=>n(r(o),i,a):n);return t.then(o=>{if(o)return o.start(()=>{var i=()=>o.continue();e&&!e(o,a=>i=a,a=>{o.stop(a),i=$},a=>{o.fail(a),i=$})||s(o.value,o,a=>i=a),i()})})}function G(t,e){try{const n=yr(t),r=yr(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(s,o){const i=s.length,a=o.length,l=i<a?i:a;for(let c=0;c<l;++c)if(s[c]!==o[c])return s[c]<o[c]?-1:1;return i===a?0:i<a?-1:1}(gr(t),gr(e));case"Array":return function(s,o){const i=s.length,a=o.length,l=i<a?i:a;for(let c=0;c<l;++c){const h=G(s[c],o[c]);if(h!==0)return h}return i===a?0:i<a?-1:1}(t,e)}}catch{}return NaN}function yr(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=hn(t);return n==="ArrayBuffer"?"binary":n}function gr(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class Ao{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,q.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,q.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=je(n.algorithm,e)}_iterate(e,n){return Et(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&H(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>Et(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,s=r.table.core;if(Re(r,!0))return s.count({trans:n,query:{index:It(r,s.schema),range:r.range}}).then(i=>Math.min(i,r.limit));var o=0;return Et(r,()=>(++o,!1),n,s).then(()=>o)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),s=r[0],o=r.length-1;function i(c,h){return h?i(c[r[h]],h-1):c[s]}var a=this._ctx.dir==="next"?1:-1;function l(c,h){var f=i(c,o),u=i(h,o);return f<u?-a:f>u?a:0}return this.toArray(function(c){return c.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&Re(r,!0)&&r.limit>0){const{valueMapper:s}=r,o=It(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:o,range:r.range}}).then(({result:i})=>s?i.map(s):i)}{const s=[];return Et(r,o=>s.push(o),n,r.table.core).then(()=>s)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,Re(n)?en(n,()=>{var r=e;return(s,o)=>r===0||(r===1?(--r,!1):(o(()=>{s.advance(r),r=0}),!1))}):en(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),en(this._ctx,()=>{var n=e;return function(r,s,o){return--n<=0&&s(o),n>=0}},!0),this}until(e,n){return Zt(this._ctx,function(r,s,o){return!e(r.value)||(s(o),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return Zt(this._ctx,function(s){return e(s.value)}),n=this._ctx,r=e,n.isMatch=je(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){e(s.key,s)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){e(s.primaryKey,s)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,o){r.push(o.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&Re(n,!0)&&n.limit>0)return this._read(s=>{var o=It(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:o,range:n.range}})}).then(({result:s})=>s).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,o){r.push(o.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return Zt(this._ctx,function(s){var o=s.primaryKey.toString(),i=ee(r,o);return r[o]=!0,!i}),this}modify(e){var n=this._ctx;return this._write(r=>{var s;if(typeof e=="function")s=e;else{var o=F(e),i=o.length;s=function(p){for(var v=!1,g=0;g<i;++g){var y=o[g],b=e[y];he(p,y)!==b&&(te(p,y,b),v=!0)}return v}}const a=n.table.core,{outbound:l,extractKey:c}=a.schema.primaryKey,h=this.db._options.modifyChunkSize||200,f=[];let u=0;const d=[],m=(p,v)=>{const{failures:g,numFailures:y}=v;u+=p-y;for(let b of F(g))f.push(g[b])};return this.clone().primaryKeys().then(p=>{const v=g=>{const y=Math.min(h,p.length-g);return a.getMany({trans:r,keys:p.slice(g,g+y),cache:"immutable"}).then(b=>{const E=[],k=[],_=l?[]:null,w=[];for(let P=0;P<y;++P){const j=b[P],B={value:yt(j),primKey:p[g+P]};s.call(B,B.value,B)!==!1&&(B.value==null?w.push(p[g+P]):l||G(c(j),c(B.value))===0?(k.push(B.value),l&&_.push(p[g+P])):(w.push(p[g+P]),E.push(B.value)))}const C=Re(n)&&n.limit===1/0&&(typeof e!="function"||e===tn)&&{index:n.index,range:n.range};return Promise.resolve(E.length>0&&a.mutate({trans:r,type:"add",values:E}).then(P=>{for(let j in P.failures)w.splice(parseInt(j),1);m(E.length,P)})).then(()=>(k.length>0||C&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:_,values:k,criteria:C,changeSpec:typeof e!="function"&&e}).then(P=>m(k.length,P))).then(()=>(w.length>0||C&&e===tn)&&a.mutate({trans:r,type:"delete",keys:w,criteria:C}).then(P=>m(w.length,P))).then(()=>p.length>g+y&&v(g+h))})};return v(0).then(()=>{if(f.length>0)throw new Nt("Error modifying one or more objects",f,u,d);return p.length})})})}delete(){var e=this._ctx,n=e.range;return Re(e)&&(e.isPrimKey&&!Ko||n.type===3)?this._write(r=>{const{primaryKey:s}=e.table.core.schema,o=n;return e.table.core.count({trans:r,query:{index:s,range:o}}).then(i=>e.table.core.mutate({trans:r,type:"deleteRange",range:o}).then(({failures:a,lastResult:l,results:c,numFailures:h})=>{if(h)throw new Nt("Could not delete some values",Object.keys(a).map(f=>a[f]),i-h);return i-h}))}):this.modify(tn)}}const tn=(t,e)=>e.value=null;function $o(t,e){return t<e?-1:t===e?0:1}function jo(t,e){return t>e?-1:t===e?0:1}function J(t,e,n){var r=t instanceof ls?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Fe(t){return new t.Collection(t,()=>as("")).limit(0)}function Do(t,e,n,r,s,o){for(var i=Math.min(t.length,r.length),a=-1,l=0;l<i;++l){var c=e[l];if(c!==r[l])return s(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):s(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;s(t[l],c)<0&&(a=l)}return i<r.length&&o==="next"?t+n.substr(t.length):i<t.length&&o==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function Pt(t,e,n,r){var s,o,i,a,l,c,h,f=n.length;if(!n.every(p=>typeof p=="string"))return J(t,"String expected.");function u(p){s=function(g){return g==="next"?y=>y.toUpperCase():y=>y.toLowerCase()}(p),o=function(g){return g==="next"?y=>y.toLowerCase():y=>y.toUpperCase()}(p),i=p==="next"?$o:jo;var v=n.map(function(g){return{lower:o(g),upper:s(g)}}).sort(function(g,y){return i(g.lower,y.lower)});a=v.map(function(g){return g.upper}),l=v.map(function(g){return g.lower}),c=p,h=p==="next"?"":r}u("next");var d=new t.Collection(t,()=>pe(a[0],l[f-1]+r));d._ondirectionchange=function(p){u(p)};var m=0;return d._addAlgorithm(function(p,v,g){var y=p.key;if(typeof y!="string")return!1;var b=o(y);if(e(b,l,m))return!0;for(var E=null,k=m;k<f;++k){var _=Do(y,b,a[k],l[k],i,c);_===null&&E===null?m=k+1:(E===null||i(E,_)>0)&&(E=_)}return v(E!==null?function(){p.continue(E+h)}:g),!1}),d}function pe(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function as(t){return{type:1,lower:t,upper:t}}class ls{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,s){r=r!==!1,s=s===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||s)&&(!r||!s)?Fe(this):new this.Collection(this,()=>pe(e,n,!r,!s))}catch{return J(this,oe)}}equals(e){return e==null?J(this,oe):new this.Collection(this,()=>as(e))}above(e){return e==null?J(this,oe):new this.Collection(this,()=>pe(e,void 0,!0))}aboveOrEqual(e){return e==null?J(this,oe):new this.Collection(this,()=>pe(e,void 0,!1))}below(e){return e==null?J(this,oe):new this.Collection(this,()=>pe(void 0,e,!1,!0))}belowOrEqual(e){return e==null?J(this,oe):new this.Collection(this,()=>pe(void 0,e))}startsWith(e){return typeof e!="string"?J(this,"String expected."):this.between(e,e+Ce,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):Pt(this,(n,r)=>n.indexOf(r[0])===0,[e],Ce)}equalsIgnoreCase(e){return Pt(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=ae.apply(qe,arguments);return e.length===0?Fe(this):Pt(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=ae.apply(qe,arguments);return e.length===0?Fe(this):Pt(this,(n,r)=>r.some(s=>n.indexOf(s)===0),e,Ce)}anyOf(){const e=ae.apply(qe,arguments);let n=this._cmp;try{e.sort(n)}catch{return J(this,oe)}if(e.length===0)return Fe(this);const r=new this.Collection(this,()=>pe(e[0],e[e.length-1]));r._ondirectionchange=o=>{n=o==="next"?this._ascending:this._descending,e.sort(n)};let s=0;return r._addAlgorithm((o,i,a)=>{const l=o.key;for(;n(l,e[s])>0;)if(++s,s===e.length)return i(a),!1;return n(l,e[s])===0||(i(()=>{o.continue(e[s])}),!1)}),r}notEqual(e){return this.inAnyRange([[-(1/0),e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=ae.apply(qe,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return J(this,oe)}const n=e.reduce((r,s)=>r?r.concat([[r[r.length-1][1],s]]):[[-(1/0),s]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,s=this._ascending,o=this._descending,i=this._min,a=this._max;if(e.length===0)return Fe(this);if(!e.every(y=>y[0]!==void 0&&y[1]!==void 0&&s(y[0],y[1])<=0))return J(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",K.InvalidArgument);const l=!n||n.includeLowers!==!1,c=n&&n.includeUppers===!0;let h,f=s;function u(y,b){return f(y[0],b[0])}try{h=e.reduce(function(y,b){let E=0,k=y.length;for(;E<k;++E){const _=y[E];if(r(b[0],_[1])<0&&r(b[1],_[0])>0){_[0]=i(_[0],b[0]),_[1]=a(_[1],b[1]);break}}return E===k&&y.push(b),y},[]),h.sort(u)}catch{return J(this,oe)}let d=0;const m=c?y=>s(y,h[d][1])>0:y=>s(y,h[d][1])>=0,p=l?y=>o(y,h[d][0])>0:y=>o(y,h[d][0])>=0;let v=m;const g=new this.Collection(this,()=>pe(h[0][0],h[h.length-1][1],!l,!c));return g._ondirectionchange=y=>{y==="next"?(v=m,f=s):(v=p,f=o),h.sort(u)},g._addAlgorithm((y,b,E)=>{for(var k=y.key;v(k);)if(++d,d===h.length)return b(E),!1;return!!function(_){return!m(_)&&!p(_)}(k)||(this._cmp(k,h[d][1])===0||this._cmp(k,h[d][0])===0||b(()=>{f===s?y.continue(h[d][0]):y.continue(h[d][1])}),!1)}),g}startsWithAnyOf(){const e=ae.apply(qe,arguments);return e.every(n=>typeof n=="string")?e.length===0?Fe(this):this.inAnyRange(e.map(n=>[n,n+Ce])):J(this,"startsWithAnyOf() only works with strings")}}function ne(t){return T(function(e){return dt(e),t(e.target.error),!1})}function dt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const be=at(null,"storagemutated");class Io{_lock(){return tt(!O.global),++this._reculock,this._reculock!==1||O.global||(O.lockOwnerFor=this),this}_unlock(){if(tt(!O.global),--this._reculock==0)for(O.global||(O.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Xe(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&O.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(tt(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new K.DatabaseClosed(r);case"MissingAPIError":throw new K.MissingAPI(r.message,r);default:throw new K.OpenFailed(r)}if(!this.active)throw new K.TransactionInactive;return tt(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=T(s=>{dt(s),this._reject(e.error)}),e.onabort=T(s=>{dt(s),this.active&&this._reject(new K.Abort(e.error)),this.active=!1,this.on("abort").fire(s)}),e.oncomplete=T(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&be.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return q(new K.ReadOnly("Transaction is readonly"));if(!this.active)return q(new K.TransactionInactive);if(this._locked())return new x((o,i)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(o,i)},O])});if(r)return ve(()=>{var o=new x((i,a)=>{this._lock();const l=n(i,a,this);l&&l.then&&l.then(i,a)});return o.finally(()=>this._unlock()),o._lib=!0,o});var s=new x((o,i)=>{var a=n(o,i,this);a&&a.then&&a.then(o,i)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=x.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var s=n.idbtrans.objectStore(n.storeNames[0]);(function i(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(s.get(-1/0).onsuccess=i)})()}var o=n._waitingFor;return new x((i,a)=>{r.then(l=>n._waitingQueue.push(T(i.bind(null,l))),l=>n._waitingQueue.push(T(a.bind(null,l)))).finally(()=>{n._waitingFor===o&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new K.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(ee(n,e))return n[e];const r=this.schema[e];if(!r)throw new K.NotFound("Table "+e+" not part of transaction");const s=new this.db.Table(e,r,this);return s.core=this.db.core.table(e),n[e]=s,s}}function xn(t,e,n,r,s,o,i){return{name:t,keyPath:e,unique:n,multi:r,auto:s,compound:o,src:(n&&!i?"&":"")+(r?"*":"")+(s?"++":"")+us(e)}}function us(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function cs(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Lr(n,r=>[r.name,r])}}let pt=t=>{try{return t.only([[]]),pt=()=>[[]],[[]]}catch{return pt=()=>Ce,Ce}};function En(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?n=>n[e]:n=>he(n,e)}(t):e=>he(e,t)}function vr(t){return[].slice.call(t)}let To=0;function lt(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function Bo(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:c,upper:h,lowerOpen:f,upperOpen:u}=l;return c===void 0?h===void 0?null:e.upperBound(h,!!u):h===void 0?e.lowerBound(c,!!f):e.bound(c,h,!!f,!!u)}const{schema:s,hasGetAll:o}=function(l,c){const h=vr(l.objectStoreNames);return{schema:{name:l.name,tables:h.map(f=>c.objectStore(f)).map(f=>{const{keyPath:u,autoIncrement:d}=f,m=W(u),p=u==null,v={},g={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:p,compound:m,keyPath:u,autoIncrement:d,unique:!0,extractKey:En(u)},indexes:vr(f.indexNames).map(y=>f.index(y)).map(y=>{const{name:b,unique:E,multiEntry:k,keyPath:_}=y,w={name:b,compound:W(_),keyPath:_,unique:E,multiEntry:k,extractKey:En(_)};return v[lt(_)]=w,w}),getIndexByKeyPath:y=>v[lt(y)]};return v[":id"]=g.primaryKey,u!=null&&(v[lt(u)]=g.primaryKey),g})},hasGetAll:h.length>0&&"getAll"in c.objectStore(h[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),i=s.tables.map(l=>function(c){const h=c.name;return{name:h,schema:c,mutate:function({trans:f,type:u,keys:d,values:m,range:p}){return new Promise((v,g)=>{v=T(v);const y=f.objectStore(h),b=y.keyPath==null,E=u==="put"||u==="add";if(!E&&u!=="delete"&&u!=="deleteRange")throw new Error("Invalid operation type: "+u);const{length:k}=d||m||{length:1};if(d&&m&&d.length!==m.length)throw new Error("Given keys array must have same length as given values array.");if(k===0)return v({numFailures:0,failures:{},results:[],lastResult:void 0});let _;const w=[],C=[];let P=0;const j=Y=>{++P,dt(Y)};if(u==="deleteRange"){if(p.type===4)return v({numFailures:P,failures:C,results:[],lastResult:void 0});p.type===3?w.push(_=y.clear()):w.push(_=y.delete(r(p)))}else{const[Y,L]=E?b?[m,d]:[m,null]:[d,null];if(E)for(let M=0;M<k;++M)w.push(_=L&&L[M]!==void 0?y[u](Y[M],L[M]):y[u](Y[M])),_.onerror=j;else for(let M=0;M<k;++M)w.push(_=y[u](Y[M])),_.onerror=j}const B=Y=>{const L=Y.target.result;w.forEach((M,Ie)=>M.error!=null&&(C[Ie]=M.error)),v({numFailures:P,failures:C,results:u==="delete"?d:w.map(M=>M.result),lastResult:L})};_.onerror=Y=>{j(Y),B(Y)},_.onsuccess=B})},getMany:({trans:f,keys:u})=>new Promise((d,m)=>{d=T(d);const p=f.objectStore(h),v=u.length,g=new Array(v);let y,b=0,E=0;const k=w=>{const C=w.target;g[C._pos]=C.result,++E===b&&d(g)},_=ne(m);for(let w=0;w<v;++w)u[w]!=null&&(y=p.get(u[w]),y._pos=w,y.onsuccess=k,y.onerror=_,++b);b===0&&d(g)}),get:({trans:f,key:u})=>new Promise((d,m)=>{d=T(d);const p=f.objectStore(h).get(u);p.onsuccess=v=>d(v.target.result),p.onerror=ne(m)}),query:function(f){return u=>new Promise((d,m)=>{d=T(d);const{trans:p,values:v,limit:g,query:y}=u,b=g===1/0?void 0:g,{index:E,range:k}=y,_=p.objectStore(h),w=E.isPrimaryKey?_:_.index(E.name),C=r(k);if(g===0)return d({result:[]});if(f){const P=v?w.getAll(C,b):w.getAllKeys(C,b);P.onsuccess=j=>d({result:j.target.result}),P.onerror=ne(m)}else{let P=0;const j=v||!("openKeyCursor"in w)?w.openCursor(C):w.openKeyCursor(C),B=[];j.onsuccess=Y=>{const L=j.result;return L?(B.push(v?L.value:L.primaryKey),++P===g?d({result:B}):void L.continue()):d({result:B})},j.onerror=ne(m)}})}(o),openCursor:function({trans:f,values:u,query:d,reverse:m,unique:p}){return new Promise((v,g)=>{v=T(v);const{index:y,range:b}=d,E=f.objectStore(h),k=y.isPrimaryKey?E:E.index(y.name),_=m?p?"prevunique":"prev":p?"nextunique":"next",w=u||!("openKeyCursor"in k)?k.openCursor(r(b),_):k.openKeyCursor(r(b),_);w.onerror=ne(g),w.onsuccess=T(C=>{const P=w.result;if(!P)return void v(null);P.___id=++To,P.done=!1;const j=P.continue.bind(P);let B=P.continuePrimaryKey;B&&(B=B.bind(P));const Y=P.advance.bind(P),L=()=>{throw new Error("Cursor not stopped")};P.trans=f,P.stop=P.continue=P.continuePrimaryKey=P.advance=()=>{throw new Error("Cursor not started")},P.fail=T(g),P.next=function(){let M=1;return this.start(()=>M--?this.continue():this.stop()).then(()=>this)},P.start=M=>{const Ie=new Promise((Q,Ee)=>{Q=T(Q),w.onerror=ne(Ee),P.fail=Ee,P.stop=Je=>{P.stop=P.continue=P.continuePrimaryKey=P.advance=L,Q(Je)}}),Te=()=>{if(w.result)try{M()}catch(Q){P.fail(Q)}else P.done=!0,P.start=()=>{throw new Error("Cursor behind last entry")},P.stop()};return w.onsuccess=T(Q=>{w.onsuccess=Te,Te()}),P.continue=j,P.continuePrimaryKey=B,P.advance=Y,Te(),Ie},v(P)},g)})},count({query:f,trans:u}){const{index:d,range:m}=f;return new Promise((p,v)=>{const g=u.objectStore(h),y=d.isPrimaryKey?g:g.index(d.name),b=r(m),E=b?y.count(b):y.count();E.onsuccess=T(k=>p(k.target.result)),E.onerror=ne(v)})}}}(l)),a={};return i.forEach(l=>a[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!a[l])throw new Error(`Table '${l}' not found`);return a[l]},MIN_KEY:-1/0,MAX_KEY:pt(e),schema:s}}function Pn({_novip:t},e){const n=e.db,r=function(s,o,{IDBKeyRange:i,indexedDB:a},l){return{dbcore:function(h,f){return f.reduce((u,{create:d})=>({...u,...d(u)}),h)}(Bo(o,i,l),s.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(s=>{const o=s.name;t.core.schema.tables.some(i=>i.name===o)&&(s.core=t.core.table(o),t[o]instanceof t.Table&&(t[o].core=s.core))})}function Vt({_novip:t},e,n,r){n.forEach(s=>{const o=r[s];e.forEach(i=>{const a=Nn(i,s);(!a||"value"in a&&a.value===void 0)&&(i===t.Transaction.prototype||i instanceof t.Transaction?ce(i,s,{get(){return this.table(s)},set(l){Nr(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):i[s]=new t.Table(s,o))})})}function Cn({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function Mo(t,e){return t._cfg.version-e._cfg.version}function Ro(t,e,n,r){const s=t._dbSchema,o=t._createTransaction("readwrite",t._storeNames,s);o.create(n),o._completion.catch(r);const i=o._reject.bind(o),a=O.transless||O;ve(()=>{O.trans=o,O.transless=a,e===0?(F(s).forEach(l=>{nn(n,l,s[l].primKey,s[l].indexes)}),Pn(t,n),x.follow(()=>t.on.populate.fire(o)).catch(i)):function({_novip:l},c,h,f){const u=[],d=l._versions;let m=l._dbSchema=Kn(l,l.idbdb,f),p=!1;function v(){return u.length?x.resolve(u.shift()(h.idbtrans)).then(v):x.resolve()}return d.filter(g=>g._cfg.version>=c).forEach(g=>{u.push(()=>{const y=m,b=g._cfg.dbschema;Sn(l,y,f),Sn(l,b,f),m=l._dbSchema=b;const E=hs(y,b);E.add.forEach(_=>{nn(f,_[0],_[1].primKey,_[1].indexes)}),E.change.forEach(_=>{if(_.recreate)throw new K.Upgrade("Not yet support for changing primary key");{const w=f.objectStore(_.name);_.add.forEach(C=>On(w,C)),_.change.forEach(C=>{w.deleteIndex(C.name),On(w,C)}),_.del.forEach(C=>w.deleteIndex(C))}});const k=g._cfg.contentUpgrade;if(k&&g._cfg.version>c){Pn(l,f),h._memoizedTables={},p=!0;let _=Ur(b);E.del.forEach(j=>{_[j]=y[j]}),Cn(l,[l.Transaction.prototype]),Vt(l,[l.Transaction.prototype],F(_),_),h.schema=_;const w=qn(k);let C;w&&Qe();const P=x.follow(()=>{if(C=k(h),C&&w){var j=fe.bind(null,null);C.then(j,j)}});return C&&typeof C.then=="function"?x.resolve(C):P.then(()=>C)}}),u.push(y=>{(!p||!Oo)&&function(b,E){[].slice.call(E.db.objectStoreNames).forEach(k=>b[k]==null&&E.db.deleteObjectStore(k))}(g._cfg.dbschema,y),Cn(l,[l.Transaction.prototype]),Vt(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),h.schema=l._dbSchema})}),v().then(()=>{var g,y;y=f,F(g=m).forEach(b=>{y.db.objectStoreNames.contains(b)||nn(y,b,g[b].primKey,g[b].indexes)})})}(t,e,o,n).catch(i)})}function hs(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const s=t[r],o=e[r];if(s){const i={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||s.primKey.auto!==o.primKey.auto&&!Yt)i.recreate=!0,n.change.push(i);else{const a=s.idxByName,l=o.idxByName;let c;for(c in a)l[c]||i.del.push(c);for(c in l){const h=a[c],f=l[c];h?h.src!==f.src&&i.change.push(f):i.add.push(f)}(i.del.length>0||i.add.length>0||i.change.length>0)&&n.change.push(i)}}else n.add.push([r,o])}return n}function nn(t,e,n,r){const s=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(o=>On(s,o)),s}function On(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Kn(t,e,n){const r={};return Ft(e.objectStoreNames,0).forEach(s=>{const o=n.objectStore(s);let i=o.keyPath;const a=xn(us(i),i||"",!1,!1,!!o.autoIncrement,i&&typeof i!="string",!0),l=[];for(let h=0;h<o.indexNames.length;++h){const f=o.index(o.indexNames[h]);i=f.keyPath;var c=xn(f.name,i,!!f.unique,!!f.multiEntry,!1,i&&typeof i!="string",!1);l.push(c)}r[s]=cs(s,a,l)}),r}function Sn({_novip:t},e,n){const r=n.db.objectStoreNames;for(let s=0;s<r.length;++s){const o=r[s],i=n.objectStore(o);t._hasGetAll="getAll"in i;for(let a=0;a<i.indexNames.length;++a){const l=i.indexNames[a],c=i.index(l).keyPath,h=typeof c=="string"?c:"["+Ft(c).join("+")+"]";if(e[o]){const f=e[o].idxByName[h];f&&(f.name=l,delete e[o].idxByName[h],e[o].idxByName[l]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&D.WorkerGlobalScope&&D instanceof D.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Fo{_parseStoresSpec(e,n){F(e).forEach(r=>{if(e[r]!==null){var s=e[r].split(",").map((i,a)=>{const l=(i=i.trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return xn(l,c||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),W(c),a===0)}),o=s.shift();if(o.multi)throw new K.Schema("Primary key cannot be multi-valued");s.forEach(i=>{if(i.auto)throw new K.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new K.Schema("Index must have a name and cannot be an empty string")}),n[r]=cs(r,o,s)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?H(this._cfg.storesSource,e):e;const r=n._versions,s={};let o={};return r.forEach(i=>{H(s,i._cfg.storesSource),o=i._cfg.dbschema={},i._parseStoresSpec(s,o)}),n._dbSchema=o,Cn(n,[n._allTables,n,n.Transaction.prototype]),Vt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],F(o),o),n._storeNames=F(o),this}upgrade(e){return this._cfg.contentUpgrade=Un(this._cfg.contentUpgrade||$,e),this}}function Gn(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Ae("__dbnames",{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Hn(t){return t&&typeof t.databases=="function"}function An(t){return ve(function(){return O.letThrough=!0,t()})}function No(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function qo(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?q(e.dbOpenError):t);se&&(e.openCanceller._stackHolder=De()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function s(){if(e.openCanceller!==r)throw new K.DatabaseClosed("db.open() was cancelled")}let o=e.dbReadyResolve,i=null,a=!1;return x.race([r,(typeof navigator>"u"?x.resolve():No()).then(()=>new x((l,c)=>{if(s(),!n)throw new K.MissingAPI;const h=t.name,f=e.autoSchema?n.open(h):n.open(h,Math.round(10*t.verno));if(!f)throw new K.MissingAPI;f.onerror=ne(c),f.onblocked=T(t._fireOnBlocked),f.onupgradeneeded=T(u=>{if(i=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=dt,i.abort(),f.result.close();const m=n.deleteDatabase(h);m.onsuccess=m.onerror=T(()=>{c(new K.NoSuchDatabase(`Database ${h} doesnt exist`))})}else{i.onerror=ne(c);var d=u.oldVersion>Math.pow(2,62)?0:u.oldVersion;a=d<1,t._novip.idbdb=f.result,Ro(t,d/10,i,c)}},c),f.onsuccess=T(()=>{i=null;const u=t._novip.idbdb=f.result,d=Ft(u.objectStoreNames);if(d.length>0)try{const p=u.transaction((m=d).length===1?m[0]:m,"readonly");e.autoSchema?function({_novip:v},g,y){v.verno=g.version/10;const b=v._dbSchema=Kn(0,g,y);v._storeNames=Ft(g.objectStoreNames,0),Vt(v,[v._allTables],F(b),b)}(t,u,p):(Sn(t,t._dbSchema,p),function(v,g){const y=hs(Kn(0,v.idbdb,g),v._dbSchema);return!(y.add.length||y.change.some(b=>b.add.length||b.change.length))}(t,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Pn(t,p)}catch{}var m;it.push(t),u.onversionchange=T(p=>{e.vcFired=!0,t.on("versionchange").fire(p)}),u.onclose=T(p=>{t.on("close").fire(p)}),a&&function({indexedDB:p,IDBKeyRange:v},g){!Hn(p)&&g!=="__dbnames"&&Gn(p,v).put({name:g}).catch($)}(t._deps,h),l()},c)}))]).then(()=>(s(),e.onReadyBeingFired=[],x.resolve(An(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let c=e.onReadyBeingFired.reduce(Un,$);return e.onReadyBeingFired=[],x.resolve(An(()=>c(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{i&&i.abort()}catch{}return r===e.openCanceller&&t._close(),q(l)}).finally(()=>{e.openComplete=!0,o()})}function $n(t){var e=o=>t.next(o),n=s(e),r=s(o=>t.throw(o));function s(o){return i=>{var a=o(i),l=a.value;return a.done?l:l&&typeof l.then=="function"?l.then(n,r):W(l)?Promise.all(l).then(n,r):n(l)}}return s(e)()}function zo(t,e,n){var r=arguments.length;if(r<2)throw new K.InvalidArgument("Too few arguments");for(var s=new Array(r-1);--r;)s[r-1]=arguments[r];n=s.pop();var o=Vr(s);return[t,o,n]}function fs(t,e,n,r,s){return x.resolve().then(()=>{const o=O.transless||O,i=t._createTransaction(e,n,t._dbSchema,r),a={trans:i,transless:o};if(r)i.idbtrans=r.idbtrans;else try{i.create(),t._state.PR1398_maxLoop=3}catch(f){return f.name===Ln.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>fs(t,e,n,null,s))):q(f)}const l=qn(s);let c;l&&Qe();const h=x.follow(()=>{if(c=s.call(i,i),c)if(l){var f=fe.bind(null,null);c.then(f,f)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=$n(c))},a);return(c&&typeof c.then=="function"?x.resolve(c).then(f=>i.active?f:q(new K.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):h.then(()=>c)).then(f=>(r&&i._resolve(),i._completion.then(()=>f))).catch(f=>(i._reject(f),q(f)))})}function Ct(t,e,n){const r=W(t)?t.slice():[t];for(let s=0;s<n;++s)r.push(e);return r}const Lo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,s={},o=[];function i(h,f,u){const d=lt(h),m=s[d]=s[d]||[],p=h==null?0:typeof h=="string"?1:h.length,v=f>0,g={...u,isVirtual:v,keyTail:f,keyLength:p,extractKey:En(h),unique:!v&&u.unique};return m.push(g),g.isPrimaryKey||o.push(g),p>1&&i(p===2?h[0]:h.slice(0,p-1),f+1,u),m.sort((y,b)=>y.keyTail-b.keyTail),g}const a=i(r.primaryKey.keyPath,0,r.primaryKey);s[":id"]=[a];for(const h of r.indexes)i(h.keyPath,0,h);function l(h){const f=h.query.index;return f.isVirtual?{...h,query:{index:f,range:(u=h.query.range,d=f.keyTail,{type:u.type===1?2:u.type,lower:Ct(u.lower,u.lowerOpen?t.MAX_KEY:t.MIN_KEY,d),lowerOpen:!0,upper:Ct(u.upper,u.upperOpen?t.MIN_KEY:t.MAX_KEY,d),upperOpen:!0})}}:h;var u,d}return{...n,schema:{...r,primaryKey:a,indexes:o,getIndexByKeyPath:function(h){const f=s[lt(h)];return f&&f[0]}},count:h=>n.count(l(h)),query:h=>n.query(l(h)),openCursor(h){const{keyTail:f,isVirtual:u,keyLength:d}=h.query.index;return u?n.openCursor(l(h)).then(m=>m&&function(p){return Object.create(p,{continue:{value:function(g){g!=null?p.continue(Ct(g,h.reverse?t.MAX_KEY:t.MIN_KEY,f)):h.unique?p.continue(p.key.slice(0,d).concat(h.reverse?t.MIN_KEY:t.MAX_KEY,f)):p.continue()}},continuePrimaryKey:{value(g,y){p.continuePrimaryKey(Ct(g,t.MAX_KEY,f),y)}},primaryKey:{get:()=>p.primaryKey},key:{get(){const g=p.key;return d===1?g[0]:g.slice(0,d)}},value:{get:()=>p.value}})}(m)):n.openCursor(h)}}}}}};function Qn(t,e,n,r){return n=n||{},r=r||"",F(t).forEach(s=>{if(ee(e,s)){var o=t[s],i=e[s];if(typeof o=="object"&&typeof i=="object"&&o&&i){const a=hn(o);a!==hn(i)?n[r+s]=e[s]:a==="Object"?Qn(o,i,n,r+s+"."):o!==i&&(n[r+s]=e[s])}else o!==i&&(n[r+s]=e[s])}else n[r+s]=void 0}),F(e).forEach(s=>{ee(t,s)||(n[r+s]=e[s])}),n}const Uo={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(o){const i=O.trans,{deleting:a,creating:l,updating:c}=i.table(e).hook;switch(o.type){case"add":if(l.fire===$)break;return i._promise("readwrite",()=>h(o),!0);case"put":if(l.fire===$&&c.fire===$)break;return i._promise("readwrite",()=>h(o),!0);case"delete":if(a.fire===$)break;return i._promise("readwrite",()=>h(o),!0);case"deleteRange":if(a.fire===$)break;return i._promise("readwrite",()=>function(u){return f(u.trans,u.range,1e4)}(o),!0)}return n.mutate(o);function h(u){const d=O.trans,m=u.keys||function(p,v){return v.type==="delete"?v.keys:v.keys||v.values.map(p.extractKey)}(r,u);if(!m)throw new Error("Keys missing");return(u=u.type==="add"||u.type==="put"?{...u,keys:m}:{...u}).type!=="delete"&&(u.values=[...u.values]),u.keys&&(u.keys=[...u.keys]),function(p,v,g){return v.type==="add"?Promise.resolve([]):p.getMany({trans:v.trans,keys:g,cache:"immutable"})}(n,u,m).then(p=>{const v=m.map((g,y)=>{const b=p[y],E={onerror:null,onsuccess:null};if(u.type==="delete")a.fire.call(E,g,b,d);else if(u.type==="add"||b===void 0){const k=l.fire.call(E,g,u.values[y],d);g==null&&k!=null&&(g=k,u.keys[y]=g,r.outbound||te(u.values[y],r.keyPath,g))}else{const k=Qn(b,u.values[y]),_=c.fire.call(E,k,g,b,d);if(_){const w=u.values[y];Object.keys(_).forEach(C=>{ee(w,C)?w[C]=_[C]:te(w,C,_[C])})}}return E});return n.mutate(u).then(({failures:g,results:y,numFailures:b,lastResult:E})=>{for(let k=0;k<m.length;++k){const _=y?y[k]:m[k],w=v[k];_==null?w.onerror&&w.onerror(g[k]):w.onsuccess&&w.onsuccess(u.type==="put"&&p[k]?u.values[k]:_)}return{failures:g,results:y,numFailures:b,lastResult:E}}).catch(g=>(v.forEach(y=>y.onerror&&y.onerror(g)),Promise.reject(g)))})}function f(u,d,m){return n.query({trans:u,values:!1,query:{index:r,range:d},limit:m}).then(({result:p})=>h({type:"delete",keys:p,trans:u}).then(v=>v.numFailures>0?Promise.reject(v.failures[0]):p.length<m?{failures:[],numFailures:0,lastResult:void 0}:f(u,{...d,lower:p[p.length-1],lowerOpen:!0},m)))}}}}})};function ds(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let s=0,o=0;s<e.keys.length&&o<t.length;++s)G(e.keys[s],t[o])===0&&(r.push(n?yt(e.values[s]):e.values[s]),++o);return r.length===t.length?r:null}catch{return null}}const Vo={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const s=ds(r.keys,r.trans._cache,r.cache==="clone");return s?x.resolve(s):n.getMany(r).then(o=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?yt(o):o},o))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function Xn(t){return!("from"in t)}const ie=function(t,e){if(!this){const n=new ie;return t&&"d"in t&&H(n,t),n}H(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function mt(t,e,n){const r=G(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(Xn(t))return H(t,{from:e,to:n,d:1});const s=t.l,o=t.r;if(G(n,t.from)<0)return s?mt(s,e,n):t.l={from:e,to:n,d:1,l:null,r:null},_r(t);if(G(e,t.to)>0)return o?mt(o,e,n):t.r={from:e,to:n,d:1,l:null,r:null},_r(t);G(e,t.from)<0&&(t.from=e,t.l=null,t.d=o?o.d+1:1),G(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const i=!t.r;s&&!t.l&&Wt(t,s),o&&i&&Wt(t,o)}function Wt(t,e){Xn(e)||function n(r,{from:s,to:o,l:i,r:a}){mt(r,s,o),i&&n(r,i),a&&n(r,a)}(t,e)}function Wo(t,e){const n=jn(e);let r=n.next();if(r.done)return!1;let s=r.value;const o=jn(t);let i=o.next(s.from),a=i.value;for(;!r.done&&!i.done;){if(G(a.from,s.to)<=0&&G(a.to,s.from)>=0)return!0;G(s.from,a.from)<0?s=(r=n.next(a.from)).value:a=(i=o.next(s.from)).value}return!1}function jn(t){let e=Xn(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&G(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||G(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function _r(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),s=r>1?"r":r<-1?"l":"";if(s){const o=s==="r"?"l":"r",i={...t},a=t[s];t.from=a.from,t.to=a.to,t[s]=a[s],i[s]=a[o],t[o]=i,i.d=br(i)}t.d=br(t)}function br({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}He(ie.prototype,{add(t){return Wt(this,t),this},addKey(t){return mt(this,t,t),this},addKeys(t){return t.forEach(e=>mt(this,e,e)),this},[fn](){return jn(this)}});const Yo={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new ie(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const s=t.table(r),{schema:o}=s,{primaryKey:i}=o,{extractKey:a,outbound:l}=i,c={...s,mutate:u=>{const d=u.trans,m=d.mutatedParts||(d.mutatedParts={}),p=_=>{const w=`idb://${e}/${r}/${_}`;return m[w]||(m[w]=new ie)},v=p(""),g=p(":dels"),{type:y}=u;let[b,E]=u.type==="deleteRange"?[u.range]:u.type==="delete"?[u.keys]:u.values.length<50?[[],u.values]:[];const k=u.trans._cache;return s.mutate(u).then(_=>{if(W(b)){y!=="delete"&&(b=_.results),v.addKeys(b);const w=ds(b,k);w||y==="add"||g.addKeys(b),(w||E)&&function(C,P,j,B){function Y(L){const M=C(L.name||"");function Ie(Q){return Q!=null?L.extractKey(Q):null}const Te=Q=>L.multiEntry&&W(Q)?Q.forEach(Ee=>M.addKey(Ee)):M.addKey(Q);(j||B).forEach((Q,Ee)=>{const Je=j&&Ie(j[Ee]),Gt=B&&Ie(B[Ee]);G(Je,Gt)!==0&&(Je!=null&&Te(Je),Gt!=null&&Te(Gt))})}P.indexes.forEach(Y)}(p,o,w,E)}else if(b){const w={from:b.lower,to:b.upper};g.add(w),v.add(w)}else v.add(n),g.add(n),o.indexes.forEach(w=>p(w.name).add(n));return _})}},h=({query:{index:u,range:d}})=>{var m,p;return[u,new ie((m=d.lower)!==null&&m!==void 0?m:t.MIN_KEY,(p=d.upper)!==null&&p!==void 0?p:t.MAX_KEY)]},f={get:u=>[i,new ie(u.key)],getMany:u=>[i,new ie().addKeys(u.keys)],count:h,query:h,openCursor:h};return F(f).forEach(u=>{c[u]=function(d){const{subscr:m}=O;if(m){const p=E=>{const k=`idb://${e}/${r}/${E}`;return m[k]||(m[k]=new ie)},v=p(""),g=p(":dels"),[y,b]=f[u](d);if(p(y.name||"").add(b),!y.isPrimaryKey){if(u!=="count"){const E=u==="query"&&l&&d.values&&s.query({...d,values:!1});return s[u].apply(this,arguments).then(k=>{if(u==="query"){if(l&&d.values)return E.then(({result:w})=>(v.addKeys(w),k));const _=d.values?k.result.map(a):k.result;d.values?v.addKeys(_):g.addKeys(_)}else if(u==="openCursor"){const _=k,w=d.values;return _&&Object.create(_,{key:{get:()=>(g.addKey(_.primaryKey),_.key)},primaryKey:{get(){const C=_.primaryKey;return g.addKey(C),C}},value:{get:()=>(w&&v.addKey(_.primaryKey),_.value)}})}return k})}g.add(n)}}return s[u].apply(this,arguments)}}),c}}}};class Ae{constructor(e,n){this._middlewares={},this.verno=0;const r=Ae.dependencies;this._options=n={addons:Ae.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:s}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:$,dbReadyPromise:null,cancelOpen:$,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var i;o.dbReadyPromise=new x(a=>{o.dbReadyResolve=a}),o.openCanceller=new x((a,l)=>{o.cancelOpen=l}),this._state=o,this.name=e,this.on=at(this,"populate","blocked","versionchange","close",{ready:[Un,$]}),this.on.ready.subscribe=qr(this.on.ready.subscribe,a=>(l,c)=>{Ae.vip(()=>{const h=this._state;if(h.openComplete)h.dbOpenError||x.resolve().then(l),c&&a(l);else if(h.onReadyBeingFired)h.onReadyBeingFired.push(l),c&&a(l);else{a(l);const f=this;c||a(function u(){f.on.ready.unsubscribe(l),f.on.ready.unsubscribe(u)})}})}),this.Collection=(i=this,et(Ao.prototype,function(a,l){this.db=i;let c=is,h=null;if(l)try{c=l()}catch(m){h=m}const f=a._ctx,u=f.table,d=u.hook.reading.fire;this._ctx={table:u,index:f.index,isPrimKey:!f.index||u.schema.primKey.keyPath&&f.index===u.schema.primKey.name,range:c,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:h,or:f.or,valueMapper:d!==ht?d:null}})),this.Table=function(a){return et(So.prototype,function(l,c,h){this.db=a,this._tx=h,this.name=l,this.schema=c,this.hook=a._allTables[l]?a._allTables[l].hook:at(null,{creating:[go,$],reading:[yo,ht],updating:[_o,$],deleting:[vo,$]})})}(this),this.Transaction=function(a){return et(Io.prototype,function(l,c,h,f,u){this.db=a,this.mode=l,this.storeNames=c,this.schema=h,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=at(this,"complete","error","abort"),this.parent=u||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new x((d,m)=>{this._resolve=d,this._reject=m}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},d=>{var m=this.active;return this.active=!1,this.on.error.fire(d),this.parent?this.parent._reject(d):m&&this.idbtrans&&this.idbtrans.abort(),q(d)})})}(this),this.Version=function(a){return et(Fo.prototype,function(l){this.db=a,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(a){return et(ls.prototype,function(l,c,h){this.db=a,this._ctx={table:l,index:c===":id"?null:c,or:h};const f=a._deps.indexedDB;if(!f)throw new K.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(u,d)=>f.cmp(d,u),this._max=(u,d)=>f.cmp(u,d)>0?u:d,this._min=(u,d)=>f.cmp(u,d)<0?u:d,this._IDBKeyRange=a._deps.IDBKeyRange})}(this),this.on("versionchange",a=>{a.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",a=>{!a.newVersion||a.newVersion<a.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${a.oldVersion/10}`)}),this._maxKey=pt(n.IDBKeyRange),this._createTransaction=(a,l,c,h)=>new this.Transaction(a,l,c,this._options.chromeTransactionDurability,h),this._fireOnBlocked=a=>{this.on("blocked").fire(a),it.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(a))},this.use(Lo),this.use(Uo),this.use(Yo),this.use(Vo),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(a=>a(this))}version(e){if(isNaN(e)||e<.1)throw new K.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new K.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(s=>s._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(Mo),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||O.letThrough||this._vip)?e():new x((n,r)=>{if(this._state.openComplete)return r(new K.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new K.DatabaseClosed);this.open().catch($)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:s}){s&&this.unuse({stack:e,name:s});const o=this._middlewares[e]||(this._middlewares[e]=[]);return o.push({stack:e,create:n,level:r??10,name:s}),o.sort((i,a)=>i.level-a.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(s=>r?s.create!==r:!!n&&s.name!==n)),this}open(){return qo(this)}_close(){const e=this._state,n=it.indexOf(this);if(n>=0&&it.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new x(r=>{e.dbReadyResolve=r}),e.openCanceller=new x((r,s)=>{e.cancelOpen=s})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new K.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new x((r,s)=>{const o=()=>{this.close();var i=this._deps.indexedDB.deleteDatabase(this.name);i.onsuccess=T(()=>{(function({indexedDB:a,IDBKeyRange:l},c){!Hn(a)&&c!=="__dbnames"&&Gn(a,l).delete(c).catch($)})(this._deps,this.name),r()}),i.onerror=ne(s),i.onblocked=this._fireOnBlocked};if(e)throw new K.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return F(this._allTables).map(e=>this._allTables[e])}transaction(){const e=zo.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let s=O.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);const o=e.indexOf("?")!==-1;let i,a;e=e.replace("!","").replace("?","");try{if(a=n.map(c=>{var h=c instanceof this.Table?c.name:c;if(typeof h!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return h}),e=="r"||e==="readonly")i="readonly";else{if(e!="rw"&&e!="readwrite")throw new K.InvalidArgument("Invalid transaction mode: "+e);i="readwrite"}if(s){if(s.mode==="readonly"&&i==="readwrite"){if(!o)throw new K.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&a.forEach(c=>{if(s&&s.storeNames.indexOf(c)===-1){if(!o)throw new K.SubTransaction("Table "+c+" not included in parent transaction.");s=null}}),o&&s&&!s.active&&(s=null)}}catch(c){return s?s._promise(null,(h,f)=>{f(c)}):q(c)}const l=fs.bind(null,this,i,a,s,r);return s?s._promise(i,l,"lock"):O.trans?Xe(O.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!ee(this._allTables,e))throw new K.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Go=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Ho{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[Go](){return this}}function ps(t,e){return F(e).forEach(n=>{Wt(t[n]||(t[n]=new ie),e[n])}),t}function ms(t){return new Ho(e=>{const n=qn(t);let r=!1,s={},o={};const i={get closed(){return r},unsubscribe:()=>{r=!0,be.storagemutated.unsubscribe(h)}};e.start&&e.start(i);let a=!1,l=!1;function c(){return F(o).some(u=>s[u]&&Wo(s[u],o[u]))}const h=u=>{ps(s,u),c()&&f()},f=()=>{if(a||r)return;s={};const u={},d=function(m){n&&Qe();const p=()=>ve(t,{subscr:m,trans:null}),v=O.trans?Xe(O.transless,p):p();return n&&v.then(fe,fe),v}(u);l||(be("storagemutated",h),l=!0),a=!0,Promise.resolve(d).then(m=>{a=!1,r||(c()?f():(s={},o=u,e.next&&e.next(m)))},m=>{a=!1,e.error&&e.error(m),i.unsubscribe()})};return f(),i})}let Dn;try{Dn={indexedDB:D.indexedDB||D.mozIndexedDB||D.webkitIndexedDB||D.msIndexedDB,IDBKeyRange:D.IDBKeyRange||D.webkitIDBKeyRange}}catch{Dn={indexedDB:null,IDBKeyRange:null}}const Pe=Ae;function Tt(t){let e=ue;try{ue=!0,be.storagemutated.fire(t)}finally{ue=e}}He(Pe,{...St,delete:t=>new Pe(t,{addons:[]}).delete(),exists:t=>new Pe(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return Hn(e)?Promise.resolve(e.databases()).then(r=>r.map(s=>s.name).filter(s=>s!=="__dbnames")):Gn(e,n).toCollection().primaryKeys()}(Pe.dependencies).then(t)}catch{return q(new K.MissingAPI)}},defineClass:()=>function(t){H(this,t)},ignoreTransaction:t=>O.trans?Xe(O.transless,t):t(),vip:An,async:function(t){return function(){try{var e=$n(t.apply(this,arguments));return e&&typeof e.then=="function"?e:x.resolve(e)}catch(n){return q(n)}}},spawn:function(t,e,n){try{var r=$n(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:x.resolve(r)}catch(s){return q(s)}},currentTransaction:{get:()=>O.trans||null},waitFor:function(t,e){const n=x.resolve(typeof t=="function"?Pe.ignoreTransaction(t):t).timeout(e||6e4);return O.trans?O.trans.waitFor(n):n},Promise:x,debug:{get:()=>se,set:t=>{Yr(t,t==="dexie"?()=>!0:os)}},derive:Ue,extend:H,props:He,override:qr,Events:at,on:be,liveQuery:ms,extendObservabilitySet:ps,getByKeyPath:he,setByKeyPath:te,delByKeyPath:function(t,e){typeof e=="string"?te(t,e,void 0):"length"in e&&[].map.call(e,function(n){te(t,n,void 0)})},shallowClone:Ur,deepClone:yt,getObjectDiff:Qn,cmp:G,asap:zr,minKey:-(1/0),addons:[],connections:it,errnames:Ln,dependencies:Dn,semVer:"3.2.3",version:"3.2.3".split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),Pe.maxKey=pt(Pe.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(be("storagemutated",t=>{if(!ue){let e;Yt?(e=document.createEvent("CustomEvent"),e.initCustomEvent("x-storagemutated-1",!0,!0,t)):e=new CustomEvent("x-storagemutated-1",{detail:t}),ue=!0,dispatchEvent(e),ue=!1}}),addEventListener("x-storagemutated-1",({detail:t})=>{ue||Tt(t)}));let ue=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel("x-storagemutated-1");typeof t.unref=="function"&&t.unref(),be("storagemutated",e=>{ue||t.postMessage(e)}),t.onmessage=e=>{e.data&&Tt(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){be("storagemutated",e=>{try{ue||(typeof localStorage<"u"&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:"x-storagemutated-1",changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key==="x-storagemutated-1"){const n=JSON.parse(e.newValue);n&&Tt(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type==="x-storagemutated-1"&&Tt(e.changedParts)})}x.rejectionMapper=function(t,e){if(!t||t instanceof Ve||t instanceof TypeError||t instanceof SyntaxError||!t.name||!hr[t.name])return t;var n=new hr[t.name](e||t.message,t);return"stack"in t&&ce(n,"stack",{get:function(){return this.inner.stack}}),n},Yr(se,os);class Qo extends Ae{constructor(){super("MemoryGame");Jn(this,"completedGames");this.version(1).stores({completedGames:"++id, itemCount, moveCount"})}}const ys=new Qo;function wr(t,e,n){const r=t.slice();return r[5]=e[n],r[7]=n,r}function Xo(t){let e=[],n=new Map,r,s=Object.keys(t[1]).sort(t[2]);const o=i=>i[7];for(let i=0;i<s.length;i+=1){let a=wr(t,s,i),l=o(a);n.set(l,e[i]=kr(l,a))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();r=Mn()},m(i,a){for(let l=0;l<e.length;l+=1)e[l].m(i,a);z(i,r,a)},p(i,a){a&14&&(s=Object.keys(i[1]).sort(i[2]),e=Fr(e,a,o,1,i,s,n,r.parentNode,Rs,kr,r,wr))},d(i){for(let a=0;a<e.length;a+=1)e[a].d(i);i&&R(r)}}}function Jo(t){let e;return{c(){e=I("tr"),e.innerHTML='<td colspan="3" class="muted centered svelte-19w152h">No games played</td>'},m(n,r){z(n,e,r)},p:N,d(n){n&&R(e)}}}function kr(t,e){let n,r,s=e[5]+"",o,i,a,l,c=e[1][e[5]].length+"",h,f,u,d,m=e[3](Math.max(...e[1][e[5]].map(xr)))+"",p,v,g;return{key:t,first:null,c(){n=I("tr"),r=I("td"),o=re(s),a=Z(),l=I("td"),h=re(c),u=Z(),d=I("td"),p=re(m),g=Z(),S(r,"data-testid",i="records-row"+e[7]+"-col0"),S(r,"class","svelte-19w152h"),S(l,"data-testid",f="records-row"+e[7]+"-col1"),S(l,"class","svelte-19w152h"),S(d,"data-testid",v="records-row"+e[7]+"-col2"),S(d,"class","svelte-19w152h"),this.first=n},m(y,b){z(y,n,b),A(n,r),A(r,o),A(n,a),A(n,l),A(l,h),A(n,u),A(n,d),A(d,p),A(n,g)},p(y,b){e=y,b&2&&s!==(s=e[5]+"")&&Le(o,s),b&2&&i!==(i="records-row"+e[7]+"-col0")&&S(r,"data-testid",i),b&2&&c!==(c=e[1][e[5]].length+"")&&Le(h,c),b&2&&f!==(f="records-row"+e[7]+"-col1")&&S(l,"data-testid",f),b&2&&m!==(m=e[3](Math.max(...e[1][e[5]].map(xr)))+"")&&Le(p,m),b&2&&v!==(v="records-row"+e[7]+"-col2")&&S(d,"data-testid",v)},d(y){y&&R(n)}}}function Zo(t){let e,n,r,s;function o(l,c){return l[0]&&l[0].length===0?Jo:Xo}let i=o(t),a=i(t);return{c(){e=I("table"),n=I("thead"),n.innerHTML=`<tr><th scope="col" class="svelte-19w152h">Moves</th> 
      <th scope="col" class="svelte-19w152h">Games</th> 
      <th scope="col" class="svelte-19w152h">Last Played</th></tr>`,r=Z(),s=I("tbody"),a.c(),S(n,"class","svelte-19w152h"),S(s,"class","svelte-19w152h"),S(e,"class","svelte-19w152h")},m(l,c){z(l,e,c),A(e,n),A(e,r),A(e,s),a.m(s,null)},p(l,[c]){i===(i=o(l))&&a?a.p(l,c):(a.d(1),a=i(l),a&&(a.c(),a.m(s,null)))},i:N,o:N,d(l){l&&R(e),a.d()}}}const xr=t=>t.timestamp;function ei(t,e,n){let r,s;const o=(l,c)=>parseInt(l)-parseInt(c),i=l=>{const c={year:"numeric",month:"short",day:"numeric"};return new Date(l).toLocaleDateString(navigator.language,c)};let a=ms(()=>ys.completedGames.toArray());return Tn(t,a,l=>n(0,s=l)),t.$$.update=()=>{t.$$.dirty&1&&n(1,r=so(s||[],"moveCount"))},[s,r,o,i,a]}class ti extends xe{constructor(e){super(),ke(this,e,ei,Zo,de,{})}}function ni(t){let e,n,r,s;return{c(){e=I("div"),n=I("button"),n.textContent="Close",n.autofocus=!0,S(n,"class","button modal-close-button svelte-lh4ff1"),S(e,"slot","header"),S(e,"class","modal-header svelte-lh4ff1")},m(o,i){z(o,e,i),A(e,n),n.focus(),r||(s=Ye(n,"click",t[1]),r=!0)},p:N,d(o){o&&R(e),r=!1,s()}}}function Er(t){let e;return{c(){e=re("Your history is persisted on this device.")},m(n,r){z(n,e,r)},d(n){n&&R(e)}}}function ri(t){let e,n,r,s,o,i,a=t[0]&&Er();return o=new ti({}),{c(){e=I("div"),n=I("p"),r=re(`Your objective is to solve puzzles in the fewest moves possible.
      `),a&&a.c(),s=Z(),Oe(o.$$.fragment),S(n,"class","text-muted"),S(e,"slot","content"),S(e,"class","records-list svelte-lh4ff1")},m(l,c){z(l,e,c),A(e,n),A(n,r),a&&a.m(n,null),A(e,s),ye(o,e,null),i=!0},p(l,c){l[0]?a||(a=Er(),a.c(),a.m(n,null)):a&&(a.d(1),a=null)},i(l){i||(U(o.$$.fragment,l),i=!0)},o(l){X(o.$$.fragment,l),i=!1},d(l){l&&R(e),a&&a.d(),ge(o)}}}function si(t){let e,n;return e=new ro({props:{$$slots:{content:[ri],header:[ni]},$$scope:{ctx:t}}}),e.$on("close",t[2]),{c(){Oe(e.$$.fragment)},m(r,s){ye(e,r,s),n=!0},p(r,[s]){const o={};s&17&&(o.$$scope={dirty:s,ctx:r}),e.$set(o)},i(r){n||(U(e.$$.fragment,r),n=!0)},o(r){X(e.$$.fragment,r),n=!1},d(r){ge(e,r)}}}function oi(t,e,n){const r=Fn(),s=()=>r("close");let o=!1;$s(async()=>{navigator.storage&&navigator.storage.persist&&n(0,o=await navigator.storage.persist())});function i(a){Tr.call(this,t,a)}return[o,s,i]}class ii extends xe{constructor(e){super(),ke(this,e,oi,si,de,{})}}function ai(t){let e,n,r,s=t[0]===1?"move":"moves",o;return{c(){e=I("div"),n=re(t[0]),r=Z(),o=re(s),S(e,"class","svelte-al6881")},m(i,a){z(i,e,a),A(e,n),A(e,r),A(e,o)},p(i,[a]){a&1&&Le(n,i[0]),a&1&&s!==(s=i[0]===1?"move":"moves")&&Le(o,s)},i:N,o:N,d(i){i&&R(e)}}}function li(t,e,n){let{count:r=0}=e;return t.$$set=s=>{"count"in s&&n(0,r=s.count)},[r]}class ui extends xe{constructor(e){super(),ke(this,e,li,ai,de,{count:0})}}function Pr(t){let e,n;return e=new ii({}),e.$on("close",t[5]),{c(){Oe(e.$$.fragment)},m(r,s){ye(e,r,s),n=!0},p:N,i(r){n||(U(e.$$.fragment,r),n=!0)},o(r){X(e.$$.fragment,r),n=!1},d(r){ge(e,r)}}}function ci(t){let e,n,r,s,o,i,a,l,c,h,f;r=new Gs({props:{puzzle:t[0].puzzle,onCompleted:t[3]}}),i=new ui({props:{count:t[2]}}),l=new Xs({}),l.$on("click",t[4]);let u=t[1]&&Pr(t);return{c(){e=I("div"),n=I("div"),Oe(r.$$.fragment),s=Z(),o=I("div"),Oe(i.$$.fragment),a=Z(),Oe(l.$$.fragment),c=Z(),u&&u.c(),h=Mn(),S(o,"class","footer-bar svelte-11te9r0"),S(n,"class","app-container svelte-11te9r0"),S(e,"class","app-root svelte-11te9r0")},m(d,m){z(d,e,m),A(e,n),ye(r,n,null),A(n,s),A(n,o),ye(i,o,null),A(o,a),ye(l,o,null),z(d,c,m),u&&u.m(d,m),z(d,h,m),f=!0},p(d,[m]){const p={};m&1&&(p.puzzle=d[0].puzzle),r.$set(p);const v={};m&4&&(v.count=d[2]),i.$set(v),d[1]?u?(u.p(d,m),m&2&&U(u,1)):(u=Pr(d),u.c(),U(u,1),u.m(h.parentNode,h)):u&&(Mr(),X(u,1,1,()=>{u=null}),Rr())},i(d){f||(U(r.$$.fragment,d),U(i.$$.fragment,d),U(l.$$.fragment,d),U(u),f=!0)},o(d){X(r.$$.fragment,d),X(i.$$.fragment,d),X(l.$$.fragment,d),X(u),f=!1},d(d){d&&R(e),ge(r),ge(i),ge(l),d&&R(c),u&&u.d(d),d&&R(h)}}}function Cr(){const t=Math.random,e=[[4,4]],[n,r]=e[Math.floor(t()*e.length)],s=n*r/2;let o=new Array(s).fill().map((c,h)=>h+1);o.push(...o);const i=Array.from({length:o.length},(c,h)=>{const f=Math.floor(t()*o.length);return{index:h,type:o.splice(f,1)[0],backfaceIsUp:!1}});console.log("new puzzle!");const a=i.map(c=>c.type);for(var l=0;l<r;l++)console.log(a.splice(0,n));return{puzzle:i}}function hi(t,e,n){let r;Tn(t,Rt,h=>n(2,r=h));let s=Cr();const o=async h=>{await ys.completedGames.add({itemCount:s.puzzle.length,moveCount:h,timestamp:Date.now()})};function i(){alert(`You won in ${r} moves!`),o(r),n(0,s.puzzle=s.puzzle.map(h=>(h.backfaceIsUp=!1,h)),s),setTimeout(()=>{n(0,s=Cr()),Ar(Rt,r=0,r)},200)}let a=!1;return[s,a,r,i,()=>n(1,a=!0),()=>n(1,a=!1)]}class fi extends xe{constructor(e){super(),ke(this,e,hi,ci,de,{})}}new fi({target:document.body,props:{}});
